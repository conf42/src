<!doctype html>
<html lang="en">
  <head>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-77190356-3"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-77190356-3');
    </script>

    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    
    <link rel="stylesheet" href="https://api.mapbox.com/mapbox-gl-js/v0.53.0/mapbox-gl.css" />
    <link rel="stylesheet" href="./assets/css/libs.bundle.css" />
    <link rel="stylesheet" href="./assets/css/theme.bundle.css" />
    <link rel="stylesheet" href="./assets/css/various.css" />

    <title>Conf42: Optimising Apache Spark and SQL for improved performance</title>
    <meta name="description" content="Help build a dystopian, machine-ated future!">

    
    <meta name="image" property="og:image" content="https://www.conf42.com/assets/headshots/https://conf42.github.io/static/headshots/Marcin%20Szymaniuk_ml.png">
    <meta property="og:type" content="article"/>
    <meta property="og:title" content="Optimising Apache Spark and SQL for improved performance | Conf42"/>
    <meta property="og:description" content="Unlock the secrets of Apache Spark optimisation. Dive into manual aspects and technical know-how for enhancing performance. Our talk provides practical solutions to optimise Spark's functionality, empowering you with the skills to achieve peak performance in your data-driven projects."/>
    <meta property="og:url" content="https://conf42.com/Machine_Learning_2024_Marcin_Szymaniuk_apache_spark_sql"/>
    

    <link rel="shortcut icon" href="./assets/favicon/favicon.ico" type="image/x-icon" />
    <link rel="apple-touch-icon" sizes="180x180" href="./assets/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="./assets/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="./assets/favicon/favicon-16x16.png">
    <link rel="manifest" href="./assets/favicon/site.webmanifest">

    

  <!-- Reddit Pixel -->
  <script>
  !function(w,d){if(!w.rdt){var p=w.rdt=function(){p.sendEvent?p.sendEvent.apply(p,arguments):p.callQueue.push(arguments)};p.callQueue=[];var t=d.createElement("script");t.src="https://www.redditstatic.com/ads/pixel.js",t.async=!0;var s=d.getElementsByTagName("script")[0];s.parentNode.insertBefore(t,s)}}(window,document);rdt('init','a2_e019g7ndfhrm', {"optOut":false,"useDecimalCurrencyValues":true,"aaid":"<AAID-HERE>"});rdt('track', 'PageVisit');
  </script>
  <!-- DO NOT MODIFY UNLESS TO REPLACE A USER IDENTIFIER -->
  <!-- End Reddit Pixel -->

  </head>
  <body>

    <!-- NAVBAR -->
    
    <!-- <nav class="navbar navbar-expand-lg navbar-light bg-light"> -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    
      <div class="container">
    
        <!-- Brand -->
        <a class="navbar-brand" href="./">
          <img src="./assets/conf42/conf42_logo_black_small.png" class="navbar-brand-img" alt="...">
        </a>
    
        <!-- Toggler -->
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
    
        <!-- Collapse -->
        <div class="collapse navbar-collapse" id="navbarCollapse">
    
          <!-- Toggler -->
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
            <i class="fe fe-x"></i>
          </button>
    
          <!-- Navigation -->
          <ul class="navbar-nav ms-auto">

            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" id="navbarLandings" data-bs-toggle="dropdown" href="#" aria-haspopup="true" aria-expanded="false">
                Events
              </a>
              <div class="dropdown-menu dropdown-menu-xl p-0" aria-labelledby="navbarLandings">
                <div class="row gx-0">
                  <div class="col-12 col-lg-6">
                    <!-- <div class="dropdown-img-start" style="background-image: url(./assets/splash/SREday2023_Splash.png);"> -->
                    <div class="dropdown-img-start">
                      <!-- Heading -->
                      <h4 class="fw-bold text-white mb-0">
                        Featured event
                      </h4>
                      <!-- Text -->
                      <p class="fs-sm text-white">
                        SREday Amsterdam 2024
                      </p>
                      <p class="fs-sm text-white">
                        Premiere 2024-11-21
                      </p>
                      <!-- Button -->
                      <a href="https://sreday.com/2024-amsterdam/" class="btn btn-sm btn-white shadow-dark fonFt-size-sm">
                        Learn more
                      </a>
                    </div>
                  </div>
                  <div class="col-12 col-lg-6">
                    <div class="dropdown-body">
                      <div class="row gx-0">
                        <div class="col-12">
    
                        
                          <!-- Heading -->
                          <h6 class="dropdown-header mt-5">
                            2025
                          </h6>
                          <!-- List -->
                          
                          <a class="dropdown-item" href="https://www.conf42.com/devops2025">
                            DevOps
                          </a>
                          
                          <a class="dropdown-item" href="https://www.conf42.com/ce2025">
                            Chaos Engineering
                          </a>
                          
                          <a class="dropdown-item" href="https://www.conf42.com/python2025">
                            Python
                          </a>
                          
                          <a class="dropdown-item" href="https://www.conf42.com/cloud2025">
                            Cloud Native
                          </a>
                          
                          <a class="dropdown-item" href="https://www.conf42.com/llms2025">
                            Large Language Models (LLMs)
                          </a>
                          
                          <a class="dropdown-item" href="https://www.conf42.com/golang2025">
                            Golang
                          </a>
                          
                          <a class="dropdown-item" href="https://www.conf42.com/sre2025">
                            Site Reliability Engineering (SRE)
                          </a>
                          
                          <a class="dropdown-item" href="https://www.conf42.com/ml2025">
                            Machine Learning
                          </a>
                          
                          <a class="dropdown-item" href="https://www.conf42.com/obs2025">
                            Observability
                          </a>
                          
                          <a class="dropdown-item" href="https://www.conf42.com/quantum2025">
                            Quantum Computing
                          </a>
                          
                          <a class="dropdown-item" href="https://www.conf42.com/rustlang2025">
                            Rustlang
                          </a>
                          
                          <a class="dropdown-item" href="https://www.conf42.com/platform2025">
                            Platform Engineering
                          </a>
                          
                          <a class="dropdown-item" href="https://www.conf42.com/mlops2025">
                            MLOps
                          </a>
                          
                          <a class="dropdown-item" href="https://www.conf42.com/im2025">
                            Incident Management
                          </a>
                          
                          <a class="dropdown-item" href="https://www.conf42.com/kubenative2025">
                            Kube Native
                          </a>
                          
                          <a class="dropdown-item" href="https://www.conf42.com/js2024">
                            JavaScript
                          </a>
                          
                          <a class="dropdown-item" href="https://www.conf42.com/prompt2025">
                            Prompt Engineering
                          </a>
                          
                          <a class="dropdown-item" href="https://www.conf42.com/robotics2025">
                            Robotics
                          </a>
                          
                          <a class="dropdown-item" href="https://www.conf42.com/devsecops2025">
                            DevSecOps
                          </a>
                          
                          <a class="dropdown-item" href="https://www.conf42.com/iot2025">
                            Internet of Things (IoT)
                          </a>
                          
                        
                          <!-- Heading -->
                          <h6 class="dropdown-header mt-5">
                            2024
                          </h6>
                          <!-- List -->
                          
                          <a class="dropdown-item" href="https://www.conf42.com/devops2024">
                            DevOps
                          </a>
                          
                          <a class="dropdown-item" href="https://www.conf42.com/ce2024">
                            Chaos Engineering
                          </a>
                          
                          <a class="dropdown-item" href="https://www.conf42.com/python2024">
                            Python
                          </a>
                          
                          <a class="dropdown-item" href="https://www.conf42.com/cloud2024">
                            Cloud Native
                          </a>
                          
                          <a class="dropdown-item" href="https://www.conf42.com/llms2024">
                            Large Language Models (LLMs)
                          </a>
                          
                          <a class="dropdown-item" href="https://www.conf42.com/golang2024">
                            Golang
                          </a>
                          
                          <a class="dropdown-item" href="https://www.conf42.com/sre2024">
                            Site Reliability Engineering (SRE)
                          </a>
                          
                          <a class="dropdown-item" href="https://www.conf42.com/ml2024">
                            Machine Learning
                          </a>
                          
                          <a class="dropdown-item" href="https://www.conf42.com/obs2024">
                            Observability
                          </a>
                          
                          <a class="dropdown-item" href="https://www.conf42.com/quantum2024">
                            Quantum Computing
                          </a>
                          
                          <a class="dropdown-item" href="https://www.conf42.com/rustlang2024">
                            Rustlang
                          </a>
                          
                          <a class="dropdown-item" href="https://www.conf42.com/platform2024">
                            Platform Engineering
                          </a>
                          
                          <a class="dropdown-item" href="https://www.conf42.com/kubenative2024">
                            Kube Native
                          </a>
                          
                          <a class="dropdown-item" href="https://www.conf42.com/im2024">
                            Incident Management
                          </a>
                          
                          <a class="dropdown-item" href="https://www.conf42.com/js2024">
                            JavaScript
                          </a>
                          
                          <a class="dropdown-item" href="https://www.conf42.com/prompt2024">
                            Prompt Engineering
                          </a>
                          
                          <a class="dropdown-item" href="https://sreday.com/2024-amsterdam/">
                            SREday Amsterdam
                          </a>
                          
                          <a class="dropdown-item" href="https://www.conf42.com/devsecops2024">
                            DevSecOps
                          </a>
                          
                          <a class="dropdown-item" href="https://www.conf42.com/iot2024">
                            Internet of Things (IoT)
                          </a>
                          
                        

                          <!-- Heading -->
                          <h6 class="dropdown-header mt-5">
                            Info
                          </h6>
                          <a class="dropdown-item" href="./code-of-conduct">
                            Code of Conduct
                          </a>
    
                        </div>
                      </div> <!-- / .row -->
                    </div>
                  </div>
                </div> <!-- / .row -->
              </div>
            </li>

            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" id="navbarLandings" data-bs-toggle="dropdown" href="#" aria-haspopup="true" aria-expanded="false">
                Community
              </a>
              <div class="dropdown-menu dropdown-menu-l p-0" aria-labelledby="navbarLandings">
                <div class="row gx-0">
                  <div class="col-12 col-lg-3">
                    <div class="dropdown-body">
                      <div class="row gx-0">
                        <div class="col-12">
                          <a class="dropdown-item" href="./support">
                            Support us
                          </a>
                          <a class="dropdown-item" href="./hall-of-fame">
                            Hall of Fame
                          </a>
                          <a class="dropdown-item" href="./speakers">
                            Speakers
                          </a>
                          <a class="dropdown-item" href="https://www.papercall.io/events?cfps-scope=&keywords=conf42" target="_blank">
                            Become a speaker (CFPs)
                          </a>
                          <a class="dropdown-item" href="https://discord.gg/mvHyZzRGaQ" target="_blank">
                            Discord
                          </a>
                          <a class="dropdown-item" href="./testimonials">
                            Testimonials
                          </a>
                          <a class="dropdown-item" href="./about">
                            About the team
                          </a>
                        </div>
                      </div> <!-- / .row -->
                    </div>
                  </div>
                </div> <!-- / .row -->
              </div>
            </li>

            <li class="nav-item">
              <a class="nav-link" href="./podcast">
                Podcast
              </a>
            </li>

            <li class="nav-item">
              <a class="nav-link" href="./blog">
                Blog
              </a>
            </li>

            <li class="nav-item">
              <a class="nav-link" href="./sponsor">
                Sponsor
              </a>
            </li>
          </ul>
    
          <!-- Button -->
          <a class="navbar-btn btn btn-sm btn-primary lift ms-auto" href="#register">
            Subscribe for FREE
          </a>
    
        </div>
    
      </div>
    </nav>



<style>
.text-selected {
  background-color: #42ba96!important;
  color: white;
}
</style>
	

    <!-- WELCOME -->
    <section class="py-5 py-md-10" style="background-color: #198B91;">

      <!-- Shape -->
      <div class="shape shape-blur-3 svg-shim text-white">
        <svg viewBox="0 0 1738 487" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h1420.92s713.43 457.505 0 485.868C707.502 514.231 0 0 0 0z" fill="url(#paint0_linear)"/><defs><linearGradient id="paint0_linear" x1="0" y1="0" x2="1049.98" y2="912.68" gradientUnits="userSpaceOnUse"><stop stop-color="currentColor" stop-opacity=".075"/><stop offset="1" stop-color="currentColor" stop-opacity="0"/></linearGradient></defs></svg>
      </div>

      <div class="container">
        <div class="row justify-content-center">
          <div class="col-12 text-center" data-aos="fade-up">

            <!-- Heading -->
            <h1 class="display-2 fw-bold text-white">
              Conf42 Machine Learning 2024 - Online
            </h1>

            <h2 class="text-white">
              
              Content unlocked! Welcome to the community!
              
            </h2>

            <!-- Text -->
            <p class="lead mb-0 text-white-75">
              
              <!-- Help build a dystopian, machine-ated future!
 -->
              <script>
                const event_date = new Date("2024-05-30T17:00:00.000+00:00");
                const local_timezone = Intl.DateTimeFormat().resolvedOptions().timeZone;
                const local_date = new Date("2024-05-30T17:00:00.000+00:00");
                // const local_offset = new Date().getTimezoneOffset() / 60;
                // local_date.setHours(local_date.getHours() + local_offset);
                document.getElementById("localtime").innerHTML = local_date + " in " + local_timezone
              </script>
            </p>

            <!-- Buttons -->
            <div class="text-center mt-5">
              
              
              <a class="btn btn-danger lift mb-3" data-bigpicture='{"ytSrc": "z77vlwwk6dc"}' href="#">
                <i class="fe fe-youtube me-2"></i>
                Watch this talk
              </a>
              
              
              <a class="btn btn-info lift mb-3" data-bigpicture='{"ytSrc": "hB92yML_Ni8"}' href="#">
                <i class="fe fe-eye me-2"></i>
                Watch Premiere
              </a>
              
              <!-- 
              <a class="btn btn-danger lift mb-3" href="https://www.youtube.com/playlist?list=PLIuxSyKxlQrDQ9kU-TbooKutrP-8IVE0r" target="_blank">
                <i class="fe fe-youtube me-2"></i>
                Playlist
              </a>
               -->
            </div>

          </div>
        </div> <!-- / .row -->
      </div> <!-- / .container -->
    </section>

    <!-- SHAPE -->
    <div class="position-relative">
      <div class="shape shape-bottom shape-fluid-x svg-shim text-light">
        <svg viewBox="0 0 2880 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 48h2880V0h-720C1442.5 52 720 0 720 0H0v48z" fill="currentColor"/></svg>
      </div>
    </div>

    
    <!-- VIDEO -->
    <section class="pt-2 sticky">
      <div class="container">
        <div class="row justify-content-center">

          <div id="video-container" class="col-9 col-lg-12 mb-5">

          <!-- Video -->

            <!-- 1. The <iframe> (and video player) will replace this <div> tag. -->
            <div id="player" class="sticky"></div>

            <script>
              
              var transcript = [{"text": "Hi guys. Today we are going to discuss optimizing", "timestamp": "00:00:27,160", "timestamp_s": 27.0}, {"text": "of Apache Spark. Today we are going to discuss performance tuning", "timestamp": "00:00:30,482", "timestamp_s": 30.0}, {"text": "of Apache Spark. And you might ask, why would I", "timestamp": "00:00:34,674", "timestamp_s": 34.0}, {"text": "care? Spark three is quite good, is good enough.", "timestamp": "00:00:38,330", "timestamp_s": 38.0}, {"text": "I don\u0027t really need to pay attention to that.", "timestamp": "00:00:41,386", "timestamp_s": 41.0}, {"text": "But the reality is that problems are", "timestamp": "00:00:43,994", "timestamp_s": 43.0}, {"text": "still happening every now and then. So if you know how to debug them,", "timestamp": "00:00:47,802", "timestamp_s": 47.0}, {"text": "if you know how to tune the performance, then you", "timestamp": "00:00:51,770", "timestamp_s": 51.0}, {"text": "save time of yourself, you save time of", "timestamp": "00:00:55,150", "timestamp_s": 55.0}, {"text": "your team, but that also means saving money", "timestamp": "00:00:59,030", "timestamp_s": 59.0}, {"text": "you spend on the infrastructure, saving money", "timestamp": "00:01:02,526", "timestamp_s": 62.0}, {"text": "you spend on your cloud. Bill my name is Martin,", "timestamp": "00:01:05,878", "timestamp_s": 65.0}, {"text": "I\u0027m CEO of Tantus Data. At Tantusdata", "timestamp": "00:01:10,118", "timestamp_s": 70.0}, {"text": "we help our customers with everything data related,", "timestamp": "00:01:13,918", "timestamp_s": 73.0}, {"text": "from infrastructure through data engineering", "timestamp": "00:01:17,318", "timestamp_s": 77.0}, {"text": "up to machine learning in production. And we also help", "timestamp": "00:01:20,674", "timestamp_s": 80.0}, {"text": "with trainings. And today I\u0027ll share", "timestamp": "00:01:25,122", "timestamp_s": 85.0}, {"text": "our lessons learned from multiple projects we", "timestamp": "00:01:28,954", "timestamp_s": 88.0}, {"text": "have been helping with. And let me get started with", "timestamp": "00:01:32,866", "timestamp_s": 92.0}, {"text": "short history of Spark. Because depending of", "timestamp": "00:01:37,058", "timestamp_s": 97.0}, {"text": "which spark version you are working with,", "timestamp": "00:01:41,210", "timestamp_s": 101.0}, {"text": "which spark version you had experience with, it very much depends", "timestamp": "00:01:44,642", "timestamp_s": 104.0}, {"text": "on what impressions you\u0027ve had, what experience you\u0027ve had.", "timestamp": "00:01:48,690", "timestamp_s": 108.0}, {"text": "So Spark version one was very unstable construct and", "timestamp": "00:01:52,434", "timestamp_s": 112.0}, {"text": "you very often had to run to your admins, to your ops for some", "timestamp": "00:01:56,370", "timestamp_s": 116.0}, {"text": "help for restarting of some services.", "timestamp": "00:02:00,274", "timestamp_s": 120.0}, {"text": "Then Spark version two was much", "timestamp": "00:02:03,554", "timestamp_s": 123.0}, {"text": "more stable. But still there was quite a big chance that", "timestamp": "00:02:06,906", "timestamp_s": 126.0}, {"text": "you run a sequel, a sequel, which is", "timestamp": "00:02:10,682", "timestamp_s": 130.0}, {"text": "perfectly correct, but it doesn\u0027t work. It doesn\u0027t work", "timestamp": "00:02:14,450", "timestamp_s": 134.0}, {"text": "because of the data distribution, it doesn\u0027t work", "timestamp": "00:02:18,388", "timestamp_s": 138.0}, {"text": "because of size of the data.", "timestamp": "00:02:21,916", "timestamp_s": 141.0}, {"text": "If it doesn\u0027t work, if you don\u0027t know how to solve this", "timestamp": "00:02:24,844", "timestamp_s": 144.0}, {"text": "kind of problem, all you could do, you could go and", "timestamp": "00:02:28,060", "timestamp_s": 148.0}, {"text": "run asking for help or randomly selecting", "timestamp": "00:02:31,364", "timestamp_s": 151.0}, {"text": "some random parameters with some hope that it will help,", "timestamp": "00:02:35,148", "timestamp_s": 155.0}, {"text": "but usually it need not help. And then with Spark", "timestamp": "00:02:38,844", "timestamp_s": 158.0}, {"text": "version three, the situation improved significantly because", "timestamp": "00:02:42,966", "timestamp_s": 162.0}, {"text": "many of the common problems have been resolved.", "timestamp": "00:02:46,694", "timestamp_s": 166.0}, {"text": "You have adaptive query execution, which basically does", "timestamp": "00:02:49,902", "timestamp_s": 169.0}, {"text": "lots of optimizations for you,", "timestamp": "00:02:54,582", "timestamp_s": 174.0}, {"text": "but still there is a chance it", "timestamp": "00:02:57,574", "timestamp_s": 177.0}, {"text": "will fail, it will be too slow and you have to do the", "timestamp": "00:03:01,230", "timestamp_s": 181.0}, {"text": "manual tuning. And today I\u0027ll show you", "timestamp": "00:03:04,686", "timestamp_s": 184.0}, {"text": "some of these examples, some of examples which are not fixed", "timestamp": "00:03:08,366", "timestamp_s": 188.0}, {"text": "even if, even in spark three,", "timestamp": "00:03:12,566", "timestamp_s": 192.0}, {"text": "if SQL is good enough these", "timestamp": "00:03:16,134", "timestamp_s": 196.0}, {"text": "days, in many cases, yes, in many cases you are good", "timestamp": "00:03:19,878", "timestamp_s": 199.0}, {"text": "with SQL or with understanding of spark API,", "timestamp": "00:03:23,670", "timestamp_s": 203.0}, {"text": "but I\u0027ll be sharing the cases where SQL is", "timestamp": "00:03:26,990", "timestamp_s": 206.0}, {"text": "just let\u0027s get started with case number one", "timestamp": "00:03:30,150", "timestamp_s": 210.0}, {"text": "and a short disclaimer is about what", "timestamp": "00:03:34,174", "timestamp_s": 214.0}, {"text": "kind of cases. I\u0027m showing cases which are", "timestamp": "00:03:37,682", "timestamp_s": 217.0}, {"text": "based on production use cases, but they are very much simplified", "timestamp": "00:03:42,074", "timestamp_s": 222.0}, {"text": "so they are simplified. We are dealing with very,", "timestamp": "00:03:45,546", "timestamp_s": 225.0}, {"text": "very simplistic schema. We are working with very simplistic SQL,", "timestamp": "00:03:48,250", "timestamp_s": 228.0}, {"text": "but the techniques we will be applying are very much", "timestamp": "00:03:52,562", "timestamp_s": 232.0}, {"text": "matching what you would do in production. So how", "timestamp": "00:03:56,594", "timestamp_s": 236.0}, {"text": "you debug, how you find out what the problem is,", "timestamp": "00:03:59,762", "timestamp_s": 239.0}, {"text": "how you fix that, it\u0027s pretty much production", "timestamp": "00:04:03,256", "timestamp_s": 243.0}, {"text": "like. And so it\u0027s very practical. So let\u0027s get started with case number", "timestamp": "00:04:07,328", "timestamp_s": 247.0}, {"text": "one. In case number one, we will be processing", "timestamp": "00:04:11,256", "timestamp_s": 251.0}, {"text": "events. We\u0027ll be processing a table with events. And that", "timestamp": "00:04:15,344", "timestamp_s": 255.0}, {"text": "table will have just three columns, user id, event id,", "timestamp": "00:04:19,184", "timestamp_s": 259.0}, {"text": "and a timestamp. And the whole point is that we are", "timestamp": "00:04:23,752", "timestamp_s": 263.0}, {"text": "collecting some events, and let\u0027s say we are collecting them because", "timestamp": "00:04:27,312", "timestamp_s": 267.0}, {"text": "we would like to understand how our users", "timestamp": "00:04:31,184", "timestamp_s": 271.0}, {"text": "are interacting with a mobile app. So we", "timestamp": "00:04:34,648", "timestamp_s": 274.0}, {"text": "understand where the glitch is, what is confusing to the users,", "timestamp": "00:04:37,880", "timestamp_s": 277.0}, {"text": "and so on. And we would like to understand how much", "timestamp": "00:04:41,288", "timestamp_s": 281.0}, {"text": "time they spend on a specific event. So we would like to calculate", "timestamp": "00:04:44,992", "timestamp_s": 284.0}, {"text": "current event timestamp and the next event timestamp.", "timestamp": "00:04:49,944", "timestamp_s": 289.0}, {"text": "So we understand which action", "timestamp": "00:04:53,800", "timestamp_s": 293.0}, {"text": "is taking lots of time, which is potentially a", "timestamp": "00:04:57,672", "timestamp_s": 297.0}, {"text": "confusing one. So we are searching for a potential of two", "timestamp": "00:05:01,104", "timestamp_s": 301.0}, {"text": "to improve. So we are searching for the", "timestamp": "00:05:05,304", "timestamp_s": 305.0}, {"text": "next event. We have some users and timestamp here we are", "timestamp": "00:05:08,992", "timestamp_s": 308.0}, {"text": "looking at just single user. I pre sorted the event", "timestamp": "00:05:12,528", "timestamp_s": 312.0}, {"text": "timestamp. We want to fill in", "timestamp": "00:05:16,288", "timestamp_s": 316.0}, {"text": "an extra column which is next timestamp. And that", "timestamp": "00:05:20,244", "timestamp_s": 320.0}, {"text": "is super simple on a data which is already pre sorted because the next", "timestamp": "00:05:23,348", "timestamp_s": 323.0}, {"text": "timestamp would be exactly this one.", "timestamp": "00:05:27,172", "timestamp_s": 327.0}, {"text": "And then for the second row, the next", "timestamp": "00:05:30,588", "timestamp_s": 330.0}, {"text": "timestamp would be and", "timestamp": "00:05:33,844", "timestamp_s": 333.0}, {"text": "so on. So it is quite simple. And if you", "timestamp": "00:05:37,236", "timestamp_s": 337.0}, {"text": "would like to implement the code, then this is what it would", "timestamp": "00:05:40,956", "timestamp_s": 340.0}, {"text": "look like in it doesn\u0027t look like a rocket science. We are just", "timestamp": "00:05:44,972", "timestamp_s": 344.0}, {"text": "using a lead function.", "timestamp": "00:05:48,830", "timestamp_s": 348.0}, {"text": "We do it over partition, data partition by", "timestamp": "00:05:52,014", "timestamp_s": 352.0}, {"text": "user id and ordered by event timestamp.", "timestamp": "00:05:56,174", "timestamp_s": 356.0}, {"text": "Super simple code. I don\u0027t really want to dig into that more,", "timestamp": "00:06:00,390", "timestamp_s": 360.0}, {"text": "but the point is the code is perfectly fine,", "timestamp": "00:06:04,182", "timestamp_s": 364.0}, {"text": "the code is correct. And let\u0027s see", "timestamp": "00:06:07,782", "timestamp_s": 367.0}, {"text": "what will happen when you go to the Sparkui.", "timestamp": "00:06:10,942", "timestamp_s": 370.0}, {"text": "If you go to the Sparkui, you will realize that", "timestamp": "00:06:14,834", "timestamp_s": 374.0}, {"text": "the job is running. It has been running for 23", "timestamp": "00:06:18,282", "timestamp_s": 378.0}, {"text": "minutes. Nothing to be worried about yet. We don\u0027t know the size", "timestamp": "00:06:21,786", "timestamp_s": 381.0}, {"text": "of the data yet. So might be perfectly fine,", "timestamp": "00:06:25,442", "timestamp_s": 385.0}, {"text": "might be not. What\u0027s a bit worrisome", "timestamp": "00:06:28,682", "timestamp_s": 388.0}, {"text": "is number of tasks which are failing. We have already", "timestamp": "00:06:32,474", "timestamp_s": 392.0}, {"text": "three tasks which are failing, but that doesn\u0027t necessarily", "timestamp": "00:06:36,242", "timestamp_s": 396.0}, {"text": "mean something is wrong. We are talking about distributed system.", "timestamp": "00:06:39,838", "timestamp_s": 399.0}, {"text": "It could be a network glitch and spark is supposed", "timestamp": "00:06:43,750", "timestamp_s": 403.0}, {"text": "to recover from some random failures. So that\u0027s", "timestamp": "00:06:47,222", "timestamp_s": 407.0}, {"text": "the whole point of having system like spark. It will hide", "timestamp": "00:06:50,550", "timestamp_s": 410.0}, {"text": "some of the complexities, some of the failures from you if it was just", "timestamp": "00:06:54,622", "timestamp_s": 414.0}, {"text": "random. But let\u0027s go a bit deeper. Let\u0027s go into", "timestamp": "00:06:58,230", "timestamp_s": 418.0}, {"text": "the job details. In the job details, we have a", "timestamp": "00:07:01,694", "timestamp_s": 421.0}, {"text": "single active stage which has been running for", "timestamp": "00:07:05,510", "timestamp_s": 425.0}, {"text": "23 minutes, and we have 126", "timestamp": "00:07:08,674", "timestamp_s": 428.0}, {"text": "tasks completed. One task is still waiting, is still", "timestamp": "00:07:13,506", "timestamp_s": 433.0}, {"text": "running. If we go to that stage details,", "timestamp": "00:07:17,322", "timestamp_s": 437.0}, {"text": "we can see extra information.", "timestamp": "00:07:21,082", "timestamp_s": 441.0}, {"text": "So, first of all, the output size so far is quite", "timestamp": "00:07:24,754", "timestamp_s": 444.0}, {"text": "small. It\u0027s just five gigs. But the PO is", "timestamp": "00:07:28,786", "timestamp_s": 448.0}, {"text": "150 gigs of memory spill,", "timestamp": "00:07:33,174", "timestamp_s": 453.0}, {"text": "80 gigs of disk spill. So it\u0027s, it is quite a lot. And that already", "timestamp": "00:07:35,982", "timestamp_s": 455.0}, {"text": "shows us that there is some inefficiency.", "timestamp": "00:07:40,470", "timestamp_s": 460.0}, {"text": "Whether we should be optimizing that or not, it very much depends. It very much", "timestamp": "00:07:44,134", "timestamp_s": 464.0}, {"text": "depends on what exactly we are optimizing", "timestamp": "00:07:47,662", "timestamp_s": 467.0}, {"text": "for. And it doesn\u0027t necessarily mean that if you", "timestamp": "00:07:51,926", "timestamp_s": 471.0}, {"text": "see some spill that you have to jump into the optimization, because it could", "timestamp": "00:07:55,270", "timestamp_s": 475.0}, {"text": "be quite hard. Let\u0027s see if", "timestamp": "00:07:58,702", "timestamp_s": 478.0}, {"text": "we actually can see anything else which is boring.", "timestamp": "00:08:02,416", "timestamp_s": 482.0}, {"text": "So if we can have a look at the diagram, we can see lots of", "timestamp": "00:08:06,904", "timestamp_s": 486.0}, {"text": "those green, very tiny tasks. So most of the", "timestamp": "00:08:10,712", "timestamp_s": 490.0}, {"text": "tasks are completing in no time.", "timestamp": "00:08:14,560", "timestamp_s": 494.0}, {"text": "There is this one task has been running for quite a", "timestamp": "00:08:17,504", "timestamp_s": 497.0}, {"text": "lot of time. There is another one which", "timestamp": "00:08:21,448", "timestamp_s": 501.0}, {"text": "has been running for some time, and it failed again.", "timestamp": "00:08:24,864", "timestamp_s": 504.0}, {"text": "And it\u0027s attempt number one. The previous one was attempt", "timestamp": "00:08:28,790", "timestamp_s": 508.0}, {"text": "number zero. Now it\u0027s attempt number one. So we", "timestamp": "00:08:32,078", "timestamp_s": 512.0}, {"text": "keep restarting the same task failing,", "timestamp": "00:08:35,206", "timestamp_s": 515.0}, {"text": "and it takes most of the job time. That\u0027s already", "timestamp": "00:08:39,294", "timestamp_s": 519.0}, {"text": "something we should look closer into. So what", "timestamp": "00:08:43,134", "timestamp_s": 523.0}, {"text": "we have now, we have another attempt of the same task,", "timestamp": "00:08:46,982", "timestamp_s": 526.0}, {"text": "and it\u0027s running for the fourth time. In the", "timestamp": "00:08:50,190", "timestamp_s": 530.0}, {"text": "task overview, we can see all the tasks which has failed. We can", "timestamp": "00:08:53,420", "timestamp_s": 533.0}, {"text": "see the single one which is running. This memory", "timestamp": "00:08:57,252", "timestamp_s": 537.0}, {"text": "spill is actually produced only, but by those tasks,", "timestamp": "00:09:01,148", "timestamp_s": 541.0}, {"text": "there is no more memory spill. We can see", "timestamp": "00:09:04,860", "timestamp_s": 544.0}, {"text": "that they are taking some time, as we could see on the graph.", "timestamp": "00:09:08,380", "timestamp_s": 548.0}, {"text": "And we also can see some, we can see some errors, and they", "timestamp": "00:09:11,924", "timestamp_s": 551.0}, {"text": "are not very descriptive, maybe, except the disk space one.", "timestamp": "00:09:15,788", "timestamp_s": 555.0}, {"text": "But overall, we can see errors,", "timestamp": "00:09:19,744", "timestamp_s": 559.0}, {"text": "which doesn\u0027t really give us a good clue", "timestamp": "00:09:22,736", "timestamp_s": 562.0}, {"text": "why it\u0027s happening. And other than that,", "timestamp": "00:09:26,200", "timestamp_s": 566.0}, {"text": "we can see other tasks which are completing within 10", "timestamp": "00:09:30,200", "timestamp_s": 570.0}, {"text": "seconds, which are producing like 40 megabytes", "timestamp": "00:09:33,840", "timestamp_s": 573.0}, {"text": "of data. Nothing really suspicious about that.", "timestamp": "00:09:37,168", "timestamp_s": 577.0}, {"text": "So let\u0027s try to dig into the problematic tasks, the task which", "timestamp": "00:09:40,480", "timestamp_s": 580.0}, {"text": "keep restarting. If we look here,", "timestamp": "00:09:45,194", "timestamp_s": 585.0}, {"text": "we can see the view from the SQL tab in", "timestamp": "00:09:48,466", "timestamp_s": 588.0}, {"text": "spark and that gives us pretty much an execution", "timestamp": "00:09:51,970", "timestamp_s": 591.0}, {"text": "plan with lots of details.", "timestamp": "00:09:55,354", "timestamp_s": 595.0}, {"text": "First information we can see is that we are reading 100gb", "timestamp": "00:09:58,114", "timestamp_s": 598.0}, {"text": "of data, nothing very special. It\u0027s 1 billion", "timestamp": "00:10:02,722", "timestamp_s": 602.0}, {"text": "records. It is a lot, but it not", "timestamp": "00:10:06,226", "timestamp_s": 606.0}, {"text": "something we shouldn\u0027t be able to process, right? Right. We are dealing with a distributed", "timestamp": "00:10:10,098", "timestamp_s": 610.0}, {"text": "system, we are dealing with very small records. It shouldn\u0027t be", "timestamp": "00:10:13,966", "timestamp_s": 613.0}, {"text": "too bad. And if we scroll down, we can", "timestamp": "00:10:17,662", "timestamp_s": 617.0}, {"text": "see this first box we always should", "timestamp": "00:10:21,622", "timestamp_s": 621.0}, {"text": "be paying attention to is called exchange. And that\u0027s pretty much", "timestamp": "00:10:25,110", "timestamp_s": 625.0}, {"text": "means we are shuffling the data over the network.", "timestamp": "00:10:29,534", "timestamp_s": 629.0}, {"text": "We are exchanging the data over the network. And this is something", "timestamp": "00:10:32,430", "timestamp_s": 632.0}, {"text": "you need to pay attention to simply because first", "timestamp": "00:10:36,174", "timestamp_s": 636.0}, {"text": "of all, it\u0027s expensive in general. Shuffle is something", "timestamp": "00:10:39,482", "timestamp_s": 639.0}, {"text": "expensive in general, because it involves disk,", "timestamp": "00:10:42,786", "timestamp_s": 642.0}, {"text": "network and so on. But other than that,", "timestamp": "00:10:46,554", "timestamp_s": 646.0}, {"text": "it\u0027s good to pay attention to these kind of boxes.", "timestamp": "00:10:50,002", "timestamp_s": 650.0}, {"text": "There are many things which are going wrong with exchanging", "timestamp": "00:10:54,114", "timestamp_s": 654.0}, {"text": "of the data with. And in this code we are", "timestamp": "00:10:57,666", "timestamp_s": 657.0}, {"text": "doing just a single shuffle. It\u0027s good to", "timestamp": "00:11:00,970", "timestamp_s": 660.0}, {"text": "hover over the exchange box and understand what it\u0027s", "timestamp": "00:11:04,810", "timestamp_s": 664.0}, {"text": "caused by. And it\u0027s here we are hash partitioning", "timestamp": "00:11:08,720", "timestamp_s": 668.0}, {"text": "based on user id simply because we are explicitly", "timestamp": "00:11:12,064", "timestamp_s": 672.0}, {"text": "in the, in the SQL code, we tell that we want to", "timestamp": "00:11:16,624", "timestamp_s": 676.0}, {"text": "partition the data based on user id. But if your code", "timestamp": "00:11:19,960", "timestamp_s": 679.0}, {"text": "is much bigger, it\u0027s good to understand what is", "timestamp": "00:11:23,040", "timestamp_s": 683.0}, {"text": "the correlation between what in the spark UI and part of the code.", "timestamp": "00:11:26,872", "timestamp_s": 686.0}, {"text": "And that helps you understand that, because usually you join by,", "timestamp": "00:11:30,352", "timestamp_s": 690.0}, {"text": "you have multiple joins, you join by multiple different columns.", "timestamp": "00:11:33,968", "timestamp_s": 693.0}, {"text": "And this is a good hint to narrow it down. Which part of the code", "timestamp": "00:11:37,426", "timestamp_s": 697.0}, {"text": "is responsible for a specific box", "timestamp": "00:11:41,442", "timestamp_s": 701.0}, {"text": "in the execution plan in the SQL tab?", "timestamp": "00:11:46,354", "timestamp_s": 706.0}, {"text": "Okay, but if we check how many bytes", "timestamp": "00:11:49,394", "timestamp_s": 709.0}, {"text": "were written by the shuffle, we are talking about 40 gigs.", "timestamp": "00:11:54,026", "timestamp_s": 714.0}, {"text": "And the top partition is 45 megabytes. It is", "timestamp": "00:11:58,450", "timestamp_s": 718.0}, {"text": "small, nothing to be worried about. But on the other hand,", "timestamp": "00:12:02,406", "timestamp_s": 722.0}, {"text": "how many bytes have been after the", "timestamp": "00:12:07,134", "timestamp_s": 727.0}, {"text": "shuffle, then it\u0027s completely different story.", "timestamp": "00:12:10,550", "timestamp_s": 730.0}, {"text": "The top partition is 6gb, and that\u0027s", "timestamp": "00:12:14,294", "timestamp_s": 734.0}, {"text": "huge. That means top partition is 67gb", "timestamp": "00:12:18,702", "timestamp_s": 738.0}, {"text": "and that partition will be processed by just a single,", "timestamp": "00:12:22,574", "timestamp_s": 742.0}, {"text": "by a single task. And that partition will", "timestamp": "00:12:26,630", "timestamp_s": 746.0}, {"text": "be causing the problems because the,", "timestamp": "00:12:30,362", "timestamp_s": 750.0}, {"text": "the whole rule is that single partition is processed", "timestamp": "00:12:33,650", "timestamp_s": 753.0}, {"text": "by a single task. So the way it looks like", "timestamp": "00:12:37,482", "timestamp_s": 757.0}, {"text": "is that whenever you read the data here we have virtual", "timestamp": "00:12:41,394", "timestamp_s": 761.0}, {"text": "slide with hdfs. But that applies to s three,", "timestamp": "00:12:45,498", "timestamp_s": 765.0}, {"text": "that applies to delta. Whatever data source", "timestamp": "00:12:49,242", "timestamp_s": 769.0}, {"text": "you have, parc always have the", "timestamp": "00:12:53,010", "timestamp_s": 773.0}, {"text": "concept of partition in mind, and it reads the data in chunks.", "timestamp": "00:12:56,212", "timestamp_s": 776.0}, {"text": "So you read a chunk of the data within a task, you do some", "timestamp": "00:12:59,548", "timestamp_s": 779.0}, {"text": "processing on the fly and eventually you prepare the", "timestamp": "00:13:03,364", "timestamp_s": 783.0}, {"text": "data for shuffle. Here we are organizing the data based on the", "timestamp": "00:13:06,972", "timestamp_s": 786.0}, {"text": "user id, simply because we are partitioning by", "timestamp": "00:13:10,460", "timestamp_s": 790.0}, {"text": "user id. But it\u0027s the same with joins. If you join by a specific", "timestamp": "00:13:13,948", "timestamp_s": 793.0}, {"text": "column, the data will be organized by that column,", "timestamp": "00:13:17,588", "timestamp_s": 797.0}, {"text": "and then you have many tasks like that. And what will", "timestamp": "00:13:22,142", "timestamp_s": 802.0}, {"text": "happen during the shuffle? All the chunks", "timestamp": "00:13:25,838", "timestamp_s": 805.0}, {"text": "with specific user will go to the", "timestamp": "00:13:29,526", "timestamp_s": 809.0}, {"text": "same, and that\u0027s perfectly fine.", "timestamp": "00:13:33,654", "timestamp_s": 813.0}, {"text": "And the second user will probably go to another task,", "timestamp": "00:13:37,030", "timestamp_s": 817.0}, {"text": "and that\u0027s all perfectly fine as long as", "timestamp": "00:13:40,582", "timestamp_s": 820.0}, {"text": "the data can fit into the executor, as the data can be processed", "timestamp": "00:13:43,662", "timestamp_s": 823.0}, {"text": "by the executor. If your user\u0027s user", "timestamp": "00:13:47,310", "timestamp_s": 827.0}, {"text": "base, the event base is not balanced, if single", "timestamp": "00:13:51,396", "timestamp_s": 831.0}, {"text": "user is producing too many events, you have", "timestamp": "00:13:54,996", "timestamp_s": 834.0}, {"text": "a problem. Then you have a problem with maybe just", "timestamp": "00:13:58,572", "timestamp_s": 838.0}, {"text": "a single task which cannot really process that data.", "timestamp": "00:14:02,084", "timestamp_s": 842.0}, {"text": "And these kind of problems were very common in spark version", "timestamp": "00:14:05,740", "timestamp_s": 845.0}, {"text": "two. Then with adaptive query", "timestamp": "00:14:09,372", "timestamp_s": 849.0}, {"text": "execution it\u0027s been improved because for instance, like if you", "timestamp": "00:14:13,516", "timestamp_s": 853.0}, {"text": "have this problem with left join, it\u0027s automatically", "timestamp": "00:14:17,234", "timestamp_s": 857.0}, {"text": "balanced. But we are looking at the window function example", "timestamp": "00:14:20,922", "timestamp_s": 860.0}, {"text": "where it is not balanced and we are struggling with that.", "timestamp": "00:14:24,866", "timestamp_s": 864.0}, {"text": "That\u0027s exactly the situation we are struggling with. So how do", "timestamp": "00:14:28,218", "timestamp_s": 868.0}, {"text": "we solve that? How do you fix a", "timestamp": "00:14:31,730", "timestamp_s": 871.0}, {"text": "data which is imbalanced? How do you fix", "timestamp": "00:14:34,986", "timestamp_s": 874.0}, {"text": "a skew in your data? First of all, you really need to", "timestamp": "00:14:38,418", "timestamp_s": 878.0}, {"text": "understand where the problem is coming from and that", "timestamp": "00:14:42,460", "timestamp_s": 882.0}, {"text": "your spark job is failing because of the skew. And once", "timestamp": "00:14:45,996", "timestamp_s": 885.0}, {"text": "you understand that, then you can think, okay, maybe it", "timestamp": "00:14:49,868", "timestamp_s": 889.0}, {"text": "is a bug, maybe it is a bug in my data, and then you simply", "timestamp": "00:14:53,508", "timestamp_s": 893.0}, {"text": "have to fix that. Maybe you can think of filtering", "timestamp": "00:14:57,332", "timestamp_s": 897.0}, {"text": "out the problematic users because in that given processing,", "timestamp": "00:15:01,004", "timestamp_s": 901.0}, {"text": "you don\u0027t really need them. If that doesn\u0027t help,", "timestamp": "00:15:05,060", "timestamp_s": 905.0}, {"text": "then you need to find out a way, figure out", "timestamp": "00:15:09,566", "timestamp_s": 909.0}, {"text": "a way of completing the processing.", "timestamp": "00:15:13,302", "timestamp_s": 913.0}, {"text": "And before I show you how to do that in this specific", "timestamp": "00:15:16,782", "timestamp_s": 916.0}, {"text": "use case, I just want to make one more note,", "timestamp": "00:15:20,310", "timestamp_s": 920.0}, {"text": "one more note, which is upgrade Spark if", "timestamp": "00:15:24,054", "timestamp_s": 924.0}, {"text": "you are not on spark version three yet, because the", "timestamp": "00:15:28,070", "timestamp_s": 928.0}, {"text": "problem I\u0027m showing you is still something you", "timestamp": "00:15:32,014", "timestamp_s": 932.0}, {"text": "have to fix manually. But in many cases,", "timestamp": "00:15:36,160", "timestamp_s": 936.0}, {"text": "Spark three allows you to avoid this kind of manual fixes.", "timestamp": "00:15:40,984", "timestamp_s": 940.0}, {"text": "So for instance, if you are doing a left join,", "timestamp": "00:15:44,584", "timestamp_s": 944.0}, {"text": "Spark would automatically fix it for you if you are with", "timestamp": "00:15:48,144", "timestamp_s": 948.0}, {"text": "the newest version. So keep that in mind,", "timestamp": "00:15:51,920", "timestamp_s": 951.0}, {"text": "but let\u0027s see how we can potentially solve this problem.", "timestamp": "00:15:55,016", "timestamp_s": 955.0}, {"text": "So the scenario I showed you is that we are calculating", "timestamp": "00:15:59,364", "timestamp_s": 959.0}, {"text": "the next timestamp, so we are pulling it from the next record", "timestamp": "00:16:03,604", "timestamp_s": 963.0}, {"text": "and so on. And the scenario I\u0027m showing you", "timestamp": "00:16:07,964", "timestamp_s": 967.0}, {"text": "is that we are calculating user one", "timestamp": "00:16:11,652", "timestamp_s": 971.0}, {"text": "data in the same partition. But if this user is producing", "timestamp": "00:16:15,572", "timestamp_s": 975.0}, {"text": "so many records, why don\u0027t we process that", "timestamp": "00:16:19,684", "timestamp_s": 979.0}, {"text": "user or all the users, so we don\u0027t have to", "timestamp": "00:16:23,268", "timestamp_s": 983.0}, {"text": "process all the, all the records at once. We have,", "timestamp": "00:16:26,808", "timestamp_s": 986.0}, {"text": "we can process them day by day,", "timestamp": "00:16:29,952", "timestamp_s": 989.0}, {"text": "and that\u0027s quite easy to implement. The only problem with that will", "timestamp": "00:16:33,480", "timestamp_s": 993.0}, {"text": "be that the last record of each", "timestamp": "00:16:36,872", "timestamp_s": 996.0}, {"text": "day will be now, unless we fix that. And coming up with", "timestamp": "00:16:40,536", "timestamp_s": 1000.0}, {"text": "a fix is really not a rocket science.", "timestamp": "00:16:44,200", "timestamp_s": 1004.0}, {"text": "So if we look into that here, we are calculating an extra", "timestamp": "00:16:47,264", "timestamp_s": 1007.0}, {"text": "column, which is a bit of math to tell which day", "timestamp": "00:16:50,656", "timestamp_s": 1010.0}, {"text": "is that. So we are not dealing with timestamp anymore. We are also dealing", "timestamp": "00:16:55,004", "timestamp_s": 1015.0}, {"text": "with number of a day. We are defining", "timestamp": "00:16:58,692", "timestamp_s": 1018.0}, {"text": "a bunch of windows for the processing,", "timestamp": "00:17:02,004", "timestamp_s": 1022.0}, {"text": "because we will be processing the user not only based", "timestamp": "00:17:05,572", "timestamp_s": 1025.0}, {"text": "on user id, but also on a window which is user id and", "timestamp": "00:17:09,372", "timestamp_s": 1029.0}, {"text": "a day. And then we calculate a bunch of", "timestamp": "00:17:12,860", "timestamp_s": 1032.0}, {"text": "kind of helper data frames, which is the", "timestamp": "00:17:16,804", "timestamp_s": 1036.0}, {"text": "events with nodes. Then after that we", "timestamp": "00:17:20,413", "timestamp_s": 1040.0}, {"text": "fix the nodes and then we do the union and", "timestamp": "00:17:23,829", "timestamp_s": 1043.0}, {"text": "merge them together. But the whole point is not really how exactly this code works.", "timestamp": "00:17:27,821", "timestamp_s": 1047.0}, {"text": "It\u0027s not a rocket science. The whole point is that if we", "timestamp": "00:17:31,901", "timestamp_s": 1051.0}, {"text": "do that, if we do this kind of processing, we explicitly tell", "timestamp": "00:17:35,341", "timestamp_s": 1055.0}, {"text": "Spark that we want to do day by day processing.", "timestamp": "00:17:38,973", "timestamp_s": 1058.0}, {"text": "And this is what we will see in the spark UI.", "timestamp": "00:17:43,053", "timestamp_s": 1063.0}, {"text": "So we don\u0027t have this single event with or single task,", "timestamp": "00:17:46,556", "timestamp_s": 1066.0}, {"text": "which is taking most of the time and eventually failing. We see", "timestamp": "00:17:50,732", "timestamp_s": 1070.0}, {"text": "the distribution being very even and the", "timestamp": "00:17:54,492", "timestamp_s": 1074.0}, {"text": "top task is taking 210 seconds. You might argue that", "timestamp": "00:17:58,132", "timestamp_s": 1078.0}, {"text": "it probably not optimal either.", "timestamp": "00:18:01,964", "timestamp_s": 1081.0}, {"text": "But the point is the job was running for 20 minutes", "timestamp": "00:18:04,980", "timestamp_s": 1084.0}, {"text": "and it would never really complete. I just killed that.", "timestamp": "00:18:08,364", "timestamp_s": 1088.0}, {"text": "And now it\u0027s running less for less than", "timestamp": "00:18:12,348", "timestamp_s": 1092.0}, {"text": "1 minute and it completes and everything is fine.", "timestamp": "00:18:16,124", "timestamp_s": 1096.0}, {"text": "So if you do this kind of optimizations,", "timestamp": "00:18:19,524", "timestamp_s": 1099.0}, {"text": "really need to understand why you are optimizing", "timestamp": "00:18:23,524", "timestamp_s": 1103.0}, {"text": "this. In our case, the job was just failing,", "timestamp": "00:18:27,492", "timestamp_s": 1107.0}, {"text": "so you had to fix that. But if you do further optimizations, you need to", "timestamp": "00:18:30,940", "timestamp_s": 1110.0}, {"text": "think what is worth your time. Maybe you want to", "timestamp": "00:18:34,612", "timestamp_s": 1114.0}, {"text": "just move on and move to another problem. Maybe you want to", "timestamp": "00:18:38,180", "timestamp_s": 1118.0}, {"text": "optimize for the wall clock time because your customers are waiting", "timestamp": "00:18:41,872", "timestamp_s": 1121.0}, {"text": "for the data. Maybe you want to optimize for the resource utilizer", "timestamp": "00:18:45,472", "timestamp_s": 1125.0}, {"text": "because you want to optimize the cloud bill. And maybe", "timestamp": "00:18:49,160", "timestamp_s": 1129.0}, {"text": "you want to avoid optimization because you don\u0027t want to complicate", "timestamp": "00:18:52,984", "timestamp_s": 1132.0}, {"text": "your code. You don\u0027t want to make your code", "timestamp": "00:18:57,112", "timestamp_s": 1137.0}, {"text": "more complex simply because you want the maintenance.", "timestamp": "00:19:00,872", "timestamp_s": 1140.0}, {"text": "All right, so let\u0027s have a look at case number two. Case number", "timestamp": "00:19:05,524", "timestamp_s": 1145.0}, {"text": "two, which on the surface could look very similar", "timestamp": "00:19:09,196", "timestamp_s": 1149.0}, {"text": "to the previous one, but it would be slightly different.", "timestamp": "00:19:12,332", "timestamp_s": 1152.0}, {"text": "So let\u0027s have a look. We are not looking into the code.", "timestamp": "00:19:15,532", "timestamp_s": 1155.0}, {"text": "We just try to very quickly figure out what\u0027s going", "timestamp": "00:19:19,532", "timestamp_s": 1159.0}, {"text": "on based on just Sparkui. So we have a spark drop, which is", "timestamp": "00:19:23,356", "timestamp_s": 1163.0}, {"text": "again running for 20 minutes. After an hour or so, I killed it because", "timestamp": "00:19:26,948", "timestamp_s": 1166.0}, {"text": "it could never really complete. And what we can see is", "timestamp": "00:19:30,484", "timestamp_s": 1170.0}, {"text": "a very similar situation to the previous", "timestamp": "00:19:33,930", "timestamp_s": 1173.0}, {"text": "job, which had tasks almost", "timestamp": "00:19:37,866", "timestamp_s": 1177.0}, {"text": "immediately completing. And this single task, which is problematic,", "timestamp": "00:19:41,866", "timestamp_s": 1181.0}, {"text": "which is running for probably it would be very hard to complete.", "timestamp": "00:19:45,890", "timestamp_s": 1185.0}, {"text": "And you might say, okay, but it looks like exactly the same situation.", "timestamp": "00:19:50,474", "timestamp_s": 1190.0}, {"text": "The difference would be when we look into", "timestamp": "00:19:54,594", "timestamp_s": 1194.0}, {"text": "active stages and if you look at the output", "timestamp": "00:19:58,122", "timestamp_s": 1198.0}, {"text": "and the shuffle read, it looks like we are processing", "timestamp": "00:20:02,140", "timestamp_s": 1202.0}, {"text": "almost no data. In the shuffle read phase we have", "timestamp": "00:20:05,836", "timestamp_s": 1205.0}, {"text": "just 20 megabytes. So it looks like we are processing", "timestamp": "00:20:09,180", "timestamp_s": 1209.0}, {"text": "almost no data. Yet the job cannot complete.", "timestamp": "00:20:12,524", "timestamp_s": 1212.0}, {"text": "In the SQL tab we can confirm that", "timestamp": "00:20:17,444", "timestamp_s": 1217.0}, {"text": "the input is small. After doing", "timestamp": "00:20:21,364", "timestamp_s": 1221.0}, {"text": "a bit of kind of self joining, we can see that", "timestamp": "00:20:24,860", "timestamp_s": 1224.0}, {"text": "the sortmer join phase is", "timestamp": "00:20:28,178", "timestamp_s": 1228.0}, {"text": "processing the record number, 4 billion something.", "timestamp": "00:20:31,738", "timestamp_s": 1231.0}, {"text": "And it, the number is growing. So even though we are reading", "timestamp": "00:20:35,794", "timestamp_s": 1235.0}, {"text": "not that many records, we are producing lots of", "timestamp": "00:20:39,778", "timestamp_s": 1239.0}, {"text": "record. I\u0027ll do a bit of a shortcut because", "timestamp": "00:20:43,650", "timestamp_s": 1243.0}, {"text": "of the time limitation, but bottom line", "timestamp": "00:20:47,162", "timestamp_s": 1247.0}, {"text": "is that products table with order id", "timestamp": "00:20:50,586", "timestamp_s": 1250.0}, {"text": "and we are joining the product table with itself based", "timestamp": "00:20:54,168", "timestamp_s": 1254.0}, {"text": "on the order id, because we would like to do an", "timestamp": "00:20:57,952", "timestamp_s": 1257.0}, {"text": "analysis of products r", "timestamp": "00:21:01,552", "timestamp_s": 1261.0}, {"text": "board. And the problem with Cartesian join, that if", "timestamp": "00:21:05,368", "timestamp_s": 1265.0}, {"text": "you have three records as an input size is", "timestamp": "00:21:08,912", "timestamp_s": 1268.0}, {"text": "nine, then for ten you get hundred in an output,", "timestamp": "00:21:12,336", "timestamp_s": 1272.0}, {"text": "but it grows really quickly. So for 10,000 records,", "timestamp": "00:21:16,576", "timestamp_s": 1276.0}, {"text": "you end up with hundreds, millions of records. It\u0027s nothing", "timestamp": "00:21:20,308", "timestamp_s": 1280.0}, {"text": "new. It\u0027s a problem which is known for a long time. You just need to", "timestamp": "00:21:24,516", "timestamp_s": 1284.0}, {"text": "be aware that if you are doing self joined, then the number of records will", "timestamp": "00:21:27,948", "timestamp_s": 1287.0}, {"text": "be huge. But the problem here is that all the records are", "timestamp": "00:21:31,468", "timestamp_s": 1291.0}, {"text": "processed within just a single executors.", "timestamp": "00:21:34,844", "timestamp_s": 1294.0}, {"text": "Single executor. Simply because Spark", "timestamp": "00:21:38,644", "timestamp_s": 1298.0}, {"text": "is doing that based on the order id is our joint key", "timestamp": "00:21:43,260", "timestamp_s": 1303.0}, {"text": "and the same order id is being processed in the", "timestamp": "00:21:46,832", "timestamp_s": 1306.0}, {"text": "same task. Unless we explicitly. The very", "timestamp": "00:21:49,928", "timestamp_s": 1309.0}, {"text": "simple technique to avoid this kind of behavior is salting", "timestamp": "00:21:53,744", "timestamp_s": 1313.0}, {"text": "in the product table. If we join it", "timestamp": "00:21:57,984", "timestamp_s": 1317.0}, {"text": "with itself, we on one hand we", "timestamp": "00:22:01,560", "timestamp_s": 1321.0}, {"text": "add a random value.", "timestamp": "00:22:05,224", "timestamp_s": 1325.0}, {"text": "Here I\u0027m using the random value from range one up to two", "timestamp": "00:22:08,964", "timestamp_s": 1328.0}, {"text": "so it can fit into the slides right hand side", "timestamp": "00:22:12,492", "timestamp_s": 1332.0}, {"text": "table. We are generating every single", "timestamp": "00:22:16,036", "timestamp_s": 1336.0}, {"text": "possible combination of SAl. So we duplicate", "timestamp": "00:22:20,620", "timestamp_s": 1340.0}, {"text": "the records. But the benefit of doing that is", "timestamp": "00:22:24,812", "timestamp_s": 1344.0}, {"text": "that instead of all the nine records being", "timestamp": "00:22:28,020", "timestamp_s": 1348.0}, {"text": "processed in one task, with these", "timestamp": "00:22:31,772", "timestamp_s": 1351.0}, {"text": "three producing six records with the remaining", "timestamp": "00:22:35,560", "timestamp_s": 1355.0}, {"text": "three. So instead of processing all the nine", "timestamp": "00:22:39,696", "timestamp_s": 1359.0}, {"text": "records in the same task, it will be processed by two", "timestamp": "00:22:43,016", "timestamp_s": 1363.0}, {"text": "separate tasks. And this way we distribute the load.", "timestamp": "00:22:46,368", "timestamp_s": 1366.0}, {"text": "So just so we are on the same page doing", "timestamp": "00:22:49,904", "timestamp_s": 1369.0}, {"text": "something in cartesian join, we are not limiting the number of", "timestamp": "00:22:53,248", "timestamp_s": 1373.0}, {"text": "records. The number of records will still be the", "timestamp": "00:22:56,464", "timestamp_s": 1376.0}, {"text": "same. You just produce lots of records. But what you\u0027re doing is you\u0027re", "timestamp": "00:23:00,040", "timestamp_s": 1380.0}, {"text": "parallelizing the execution, you make it better", "timestamp": "00:23:03,662", "timestamp_s": 1383.0}, {"text": "distributed. So end of the day,", "timestamp": "00:23:07,718", "timestamp_s": 1387.0}, {"text": "we can see many tasks which are", "timestamp": "00:23:10,878", "timestamp_s": 1390.0}, {"text": "all doing something which are all running for quite some time,", "timestamp": "00:23:14,774", "timestamp_s": 1394.0}, {"text": "and the top task is running for eleven minutes. You could argue we", "timestamp": "00:23:19,142", "timestamp_s": 1399.0}, {"text": "could split it even further. The tasks are still processing quite", "timestamp": "00:23:23,518", "timestamp_s": 1403.0}, {"text": "a lot of data. Probably we can split that. But the point is", "timestamp": "00:23:27,342", "timestamp_s": 1407.0}, {"text": "we won\u0027t be waiting forever. This might be good enough.", "timestamp": "00:23:31,446", "timestamp_s": 1411.0}, {"text": "You might want to tune the saud value we used in this case,", "timestamp": "00:23:35,326", "timestamp_s": 1415.0}, {"text": "I believe we used 180 or something like that.", "timestamp": "00:23:38,902", "timestamp_s": 1418.0}, {"text": "So a bit more than on the. Alright, so let\u0027s have", "timestamp": "00:23:42,054", "timestamp_s": 1422.0}, {"text": "a look at case number three and case number four.", "timestamp": "00:23:45,478", "timestamp_s": 1425.0}, {"text": "And they are grouped together because they are both related to lazy evaluation.", "timestamp": "00:23:49,134", "timestamp_s": 1429.0}, {"text": "So lazy evaluation is something which is thought", "timestamp": "00:23:54,134", "timestamp_s": 1434.0}, {"text": "at the very beginning of every single spark curse.", "timestamp": "00:23:57,574", "timestamp_s": 1437.0}, {"text": "Yet it is something which is very easy to forget about.", "timestamp": "00:24:00,522", "timestamp_s": 1440.0}, {"text": "And the whole concept is that if you read some data", "timestamp": "00:24:04,882", "timestamp_s": 1444.0}, {"text": "frame and then you do some complex transformation,", "timestamp": "00:24:08,826", "timestamp_s": 1448.0}, {"text": "then that complex transformation does not happen immediately.", "timestamp": "00:24:11,938", "timestamp_s": 1451.0}, {"text": "The park just remembers what it has to do,", "timestamp": "00:24:15,762", "timestamp_s": 1455.0}, {"text": "and it does it when it\u0027s absolutely necessary.", "timestamp": "00:24:18,826", "timestamp_s": 1458.0}, {"text": "So it\u0027s a, it\u0027s an optimization concept, so it doesn\u0027t", "timestamp": "00:24:22,802", "timestamp_s": 1462.0}, {"text": "have to do every single action immediately.", "timestamp": "00:24:26,418", "timestamp_s": 1466.0}, {"text": "If you for some reason decide to do a while and", "timestamp": "00:24:30,194", "timestamp_s": 1470.0}, {"text": "then do this kind of complex transformation in a loop,", "timestamp": "00:24:33,810", "timestamp_s": 1473.0}, {"text": "you need to be aware that this will not", "timestamp": "00:24:37,482", "timestamp_s": 1477.0}, {"text": "be memorized anywhere. Spark doesn\u0027t have any cache for", "timestamp": "00:24:41,818", "timestamp_s": 1481.0}, {"text": "that which is happening immediately.", "timestamp": "00:24:45,210", "timestamp_s": 1485.0}, {"text": "Parc will be just remembering more and more operations to be", "timestamp": "00:24:49,294", "timestamp_s": 1489.0}, {"text": "done, and the complexity of every single iteration", "timestamp": "00:24:53,006", "timestamp_s": 1493.0}, {"text": "will grow. So the first iteration it takes 23 seconds", "timestamp": "00:24:57,382", "timestamp_s": 1497.0}, {"text": "and a few jobs to be completed. Then after some more iterations,", "timestamp": "00:25:01,614", "timestamp_s": 1501.0}, {"text": "it takes 1 minute and several jobs to be completed.", "timestamp": "00:25:05,518", "timestamp_s": 1505.0}, {"text": "And then it takes nine minutes and growing really", "timestamp": "00:25:09,974", "timestamp_s": 1509.0}, {"text": "fast. And the same with the complexity.", "timestamp": "00:25:13,470", "timestamp_s": 1513.0}, {"text": "Initial one is initial job is quite simple,", "timestamp": "00:25:17,018", "timestamp_s": 1517.0}, {"text": "then it\u0027s a bit more complex. And then we go", "timestamp": "00:25:21,274", "timestamp_s": 1521.0}, {"text": "here, we scroll down even more and we are keep repeating the", "timestamp": "00:25:25,130", "timestamp_s": 1525.0}, {"text": "same operations, but we do them from scratch", "timestamp": "00:25:28,570", "timestamp_s": 1528.0}, {"text": "in every iteration unless we do something", "timestamp": "00:25:32,210", "timestamp_s": 1532.0}, {"text": "about that. So what is the conclusion here. First of all,", "timestamp": "00:25:35,770", "timestamp_s": 1535.0}, {"text": "loops are suspicious because it\u0027s somewhat like", "timestamp": "00:25:39,938", "timestamp_s": 1539.0}, {"text": "doing a batch within a batch system so far", "timestamp": "00:25:43,710", "timestamp_s": 1543.0}, {"text": "has its own operators,", "timestamp": "00:25:47,262", "timestamp_s": 1547.0}, {"text": "which are batch operators. But we are using loops simply", "timestamp": "00:25:50,646", "timestamp_s": 1550.0}, {"text": "because we can. And sometimes it\u0027s okay, but in some cases", "timestamp": "00:25:54,590", "timestamp_s": 1554.0}, {"text": "it\u0027s really suspicious. In some cases it really leads to", "timestamp": "00:25:57,894", "timestamp_s": 1557.0}, {"text": "growing complexity of the execution plan. But you", "timestamp": "00:26:01,582", "timestamp_s": 1561.0}, {"text": "can grow the execution plan even without the loop. So if your", "timestamp": "00:26:04,878", "timestamp_s": 1564.0}, {"text": "execution plan is growing out of hand, if you can see that spark", "timestamp": "00:26:08,502", "timestamp_s": 1568.0}, {"text": "slowing down because of how complex,", "timestamp": "00:26:13,244", "timestamp_s": 1573.0}, {"text": "how many operations you have to do, then it\u0027s worth", "timestamp": "00:26:16,508", "timestamp_s": 1576.0}, {"text": "considering checkpointing or materializing the results", "timestamp": "00:26:20,428", "timestamp_s": 1580.0}, {"text": "on the way. And it\u0027s, on one hand, it\u0027s a", "timestamp": "00:26:24,116", "timestamp_s": 1584.0}, {"text": "good kind of hack, or it\u0027s a", "timestamp": "00:26:27,260", "timestamp_s": 1587.0}, {"text": "good, let\u0027s say, workaround for very", "timestamp": "00:26:30,812", "timestamp_s": 1590.0}, {"text": "big. But on the other hand, it could be good idea to", "timestamp": "00:26:34,228", "timestamp_s": 1594.0}, {"text": "split very complex code, very complex, dug into modules,", "timestamp": "00:26:38,060", "timestamp_s": 1598.0}, {"text": "and that could help, you could help even with the code maintenance.", "timestamp": "00:26:42,136", "timestamp_s": 1602.0}, {"text": "So it could serve two purposes.", "timestamp": "00:26:46,344", "timestamp_s": 1606.0}, {"text": "But other than that, something which is very much related to", "timestamp": "00:26:49,344", "timestamp_s": 1609.0}, {"text": "the lazy execution is whether our code is", "timestamp": "00:26:53,120", "timestamp_s": 1613.0}, {"text": "deterministic or not, because if it\u0027s not deterministic.", "timestamp": "00:26:56,768", "timestamp_s": 1616.0}, {"text": "So for instance, we want to randomly generate", "timestamp": "00:27:00,488", "timestamp_s": 1620.0}, {"text": "values because we want a unique.", "timestamp": "00:27:03,856", "timestamp_s": 1623.0}, {"text": "It becomes very tricky. It becomes", "timestamp": "00:27:07,064", "timestamp_s": 1627.0}, {"text": "very tricky because let\u0027s say we want to split our", "timestamp": "00:27:10,456", "timestamp_s": 1630.0}, {"text": "data frame into two data frames because of the machine", "timestamp": "00:27:13,784", "timestamp_s": 1633.0}, {"text": "learning, split the split for machine learning. Then if we write", "timestamp": "00:27:17,384", "timestamp_s": 1637.0}, {"text": "a code like that, we generate a column with random value", "timestamp": "00:27:21,400", "timestamp_s": 1641.0}, {"text": "and we generate two different data frames, and we hope that the", "timestamp": "00:27:26,024", "timestamp_s": 1646.0}, {"text": "split based on that random value is,", "timestamp": "00:27:29,952", "timestamp_s": 1649.0}, {"text": "is happening. So you have two data frames", "timestamp": "00:27:33,224", "timestamp_s": 1653.0}, {"text": "which are not overlapping. Then you might get surprised,", "timestamp": "00:27:37,096", "timestamp_s": 1657.0}, {"text": "because when you write data frame one, then you write data", "timestamp": "00:27:40,504", "timestamp_s": 1660.0}, {"text": "frame two. The random generation will happen", "timestamp": "00:27:43,976", "timestamp_s": 1663.0}, {"text": "from the very beginning, it will happen from scratch.", "timestamp": "00:27:47,824", "timestamp_s": 1667.0}, {"text": "And that\u0027s a real problem I actually have seen.", "timestamp": "00:27:50,744", "timestamp_s": 1670.0}, {"text": "It will fail. It will create overlaps, it will create", "timestamp": "00:27:54,264", "timestamp_s": 1674.0}, {"text": "lost records. And this is a LinkedIn message", "timestamp": "00:27:57,912", "timestamp_s": 1677.0}, {"text": "I received from a friend. He was fuming because", "timestamp": "00:28:01,760", "timestamp_s": 1681.0}, {"text": "of that. He spent lots of time.", "timestamp": "00:28:05,304", "timestamp_s": 1685.0}, {"text": "It was really significant bug because it was introducing", "timestamp": "00:28:09,184", "timestamp_s": 1689.0}, {"text": "an overfitting effect", "timestamp": "00:28:14,784", "timestamp_s": 1694.0}, {"text": "in their machine learning pipeline. So whenever", "timestamp": "00:28:19,344", "timestamp_s": 1699.0}, {"text": "you deal with random values, first of all, check if you", "timestamp": "00:28:22,752", "timestamp_s": 1702.0}, {"text": "don\u0027t have this kind of mechanism like splitting data frames", "timestamp": "00:28:26,252", "timestamp_s": 1706.0}, {"text": "in the standard library, because that you do have. But if you", "timestamp": "00:28:29,924", "timestamp_s": 1709.0}, {"text": "do something a bit more custom, then make sure you materialize", "timestamp": "00:28:33,668", "timestamp_s": 1713.0}, {"text": "result, because that\u0027s the safest. That is the safest one. It might be not", "timestamp": "00:28:37,428", "timestamp_s": 1717.0}, {"text": "the most kind of time efficient, but it\u0027s", "timestamp": "00:28:41,444", "timestamp_s": 1721.0}, {"text": "the safest. You don\u0027t risk that someone else will come do", "timestamp": "00:28:45,148", "timestamp_s": 1725.0}, {"text": "some modification in your code without knowing what is happening.", "timestamp": "00:28:48,924", "timestamp_s": 1728.0}, {"text": "So what will be the conclusion from all", "timestamp": "00:28:52,734", "timestamp_s": 1732.0}, {"text": "the examples I showed you? First of all, you really need to know", "timestamp": "00:28:57,710", "timestamp_s": 1737.0}, {"text": "what you are optimizing for, whether it\u0027s your time,", "timestamp": "00:29:01,478", "timestamp_s": 1741.0}, {"text": "the compute time, the wall clock time. It really", "timestamp": "00:29:04,678", "timestamp_s": 1744.0}, {"text": "helps if you understand where the bottleneck is.", "timestamp": "00:29:09,454", "timestamp_s": 1749.0}, {"text": "If these kind of cases are new to you,", "timestamp": "00:29:13,334", "timestamp_s": 1753.0}, {"text": "I would suggest that you invest a bit of time for experimenting and", "timestamp": "00:29:16,566", "timestamp_s": 1756.0}, {"text": "learning a bit more about how spark works under the hood. But if", "timestamp": "00:29:20,142", "timestamp_s": 1760.0}, {"text": "you feel that you don\u0027t have these kind of problems", "timestamp": "00:29:24,080", "timestamp_s": 1764.0}, {"text": "on daily basis, you should at least know", "timestamp": "00:29:27,528", "timestamp_s": 1767.0}, {"text": "when to ask for help and who to ask for help. Because maybe you", "timestamp": "00:29:31,152", "timestamp_s": 1771.0}, {"text": "are a data scientist. You want to focus on the data science, not spark debugging.", "timestamp": "00:29:35,096", "timestamp_s": 1775.0}, {"text": "You don\u0027t want to be a PhD in", "timestamp": "00:29:38,832", "timestamp_s": 1778.0}, {"text": "spark, but then at least know when you are blocked", "timestamp": "00:29:41,960", "timestamp_s": 1781.0}, {"text": "and make sure you know where to ask for help. So for", "timestamp": "00:29:45,616", "timestamp_s": 1785.0}, {"text": "instance, maybe there is a data engineer which is good at these kind of things.", "timestamp": "00:29:48,940", "timestamp_s": 1788.0}, {"text": "Feel free to reach out to me on LinkedIn and", "timestamp": "00:29:52,804", "timestamp_s": 1792.0}, {"text": "I will be very happy to talk to.", "timestamp": "00:29:56,996", "timestamp_s": 1796.0}];
              

              var tag = document.createElement('script');

              tag.src = "https://www.youtube.com/iframe_api";
              var firstScriptTag = document.getElementsByTagName('script')[0];
              firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

              // 3. This function creates an <iframe> (and YouTube player)
              //    after the API code downloads.
              var player;
              function onYouTubeIframeAPIReady() {
                player = new YT.Player('player', {
                  height: '100%',
                  width: '100%',
                  videoId: 'z77vlwwk6dc',
                  playerVars: {
                    'playsinline': 1
                  },
                  events: {
                    'onReady': onPlayerReady,
                    // 'onStateChange': onPlayerStateChange
                  }
                });
              }
              function onPlayerReady(event) {
                console.log("Player ready");
                var sec = Number(location.href.split("#")[1]);
                if (sec){
                  player.seekTo(sec, true);
                }
                player.playVideo();
                highlightParagraph();
              }
              // find the number of the paragraph
              function findParagraph(sec){
                for (var i = 1; i < transcript.length; i++) {
                  if (transcript[i].timestamp_s > sec){
                    return i - 1;
                  }
                }
                return transcript.length - 1;
              }
              // move the video to the desired second
              function seek(sec){
                if(player){
                  player.playVideo();
                  player.seekTo(sec, true);
                }
                location.href = location.href.split("#")[0] + "#" + sec;
                highlightParagraph(sec);
              }
              // highlight the right paragraph
              var prevParagraph;
              function highlightParagraph(sec) {
                var currentTime = sec;
                if (!currentTime && player) {
                  currentTime = player.getCurrentTime();
                }
                if (!currentTime){
                  console.log("No current time")
                  return;
                }
                var currentParagraph = findParagraph(currentTime);
                if (currentParagraph !== prevParagraph){
                  prevParagraph = currentParagraph;
                  Array.from(document.getElementsByClassName("transcript-chunks")).forEach((e) => {
                    e.classList.remove('text-selected');
                  });
                  var body = document.getElementById("chunk-"+currentParagraph);
                  body.classList.add('text-selected');
                }
              }
              time_update_interval = setInterval(highlightParagraph, 1000);
            </script>
          </div>
        </div> <!-- / .row -->
      </div> <!-- / .container -->
    </section>
    

    <!-- CONTENT -->
    <section class="pt-2">
      <div class="container">
        <div class="row justify-content-center">

          <div class="col-12 mb-5">
            <h1>
              Optimising Apache Spark and SQL for improved performance
            </h1>
            
            <h3 class="bg-white">
              Video size:
              <a href="javascript:void(0);" onclick="resizeVideo(25)"><i class="fe fe-zoom-out me-2"></i></a>
              <a href="javascript:void(0);" onclick="resizeVideo(50)"><i class="fe fe-zoom-in me-2"></i></a>
            </h3>
            
          </div>

          <div class="col-12 mb-5">
            <h3>
              Abstract
            </h3>
<!-- Text -->
<p>Unlock the secrets of Apache Spark optimisation. Dive into manual aspects and technical know-how for enhancing performance. Our talk provides practical solutions to optimise Spark&rsquo;s functionality, empowering you with the skills to achieve peak performance in your data-driven projects.</p>
<!-- End Text -->
          </div>

          

          <div class="col-12 mb-5">
            <h3>
              Summary
            </h3>
            <ul>
              
              <li>
                Today we are going to discuss performance tuning of Apache Spark. Spark three is quite good, is good enough. But problems are still happening every now and then. If you know how to tune the performance, then you save time and money.

              </li>
              
              <li>
                Martin Martin is CEO of Tantus Data. The company helps customers with everything data related. Today he will share some of the lessons learned from multiple projects. The techniques we will be applying are very much matching what you would do in production.

              </li>
              
              <li>
                The Sparkui job has been running for 23 minutes. The output size so far is quite small. But the PO is 150 gigs of memory spill, 80 gigs of disk spill. That already shows us that there is some inefficiency. Whether we should be optimizing that or not, it very much depends.

              </li>
              
              <li>
                Shuffle is something expensive in general, because it involves disk, network and so on. There are many things which are going wrong with exchanging of the data with. In this code we are doing just a single shuffle. So let's try to dig into the problematic tasks, the task which keep restarting.

              </li>
              
              <li>
                How do you fix a skew in your data? First of all, you really need to understand where the problem is coming from. Upgrade Spark if you are not on spark version three yet. In many cases, Spark three allows you to avoid this kind of manual fixes.

              </li>
              
              <li>
                The problem here is that all the records are processed within just a single executors. The simple technique to avoid this kind of behavior is salting in the product table. Instead of processing all the nine records in the same task, it will be processed by two separate tasks.

              </li>
              
              <li>
                Lazy evaluation is something which is thought at the very beginning of every single spark curse. In some cases it really leads to growing complexity of the execution plan. If your execution plan is growing out of hand, it's worth considering checkpointing or materializing results on the way.
              </li>
              
            </ul>
          </div>

          <div class="col-12 mb-5">
            <h3>
              Transcript
            </h3>
            <span class="text-muted">
              This transcript was autogenerated. To make changes, <a href="https://github.com/conf42/src/edit/main/./assemblyai/z77vlwwk6dc.srt" target="_blank">submit a PR</a>.
            </span>
            <div>
            
            <span id="chunk-0" class="transcript-chunks" onclick="console.log('00:00:27,160'); seek(27.0)">
              Hi guys. Today we are going to discuss optimizing
            </span>
            
            <span id="chunk-1" class="transcript-chunks" onclick="console.log('00:00:30,482'); seek(30.0)">
              of Apache Spark. Today we are going to discuss performance tuning
            </span>
            
            <span id="chunk-2" class="transcript-chunks" onclick="console.log('00:00:34,674'); seek(34.0)">
              of Apache Spark. And you might ask, why would I
            </span>
            
            <span id="chunk-3" class="transcript-chunks" onclick="console.log('00:00:38,330'); seek(38.0)">
              care? Spark three is quite good, is good enough.
            </span>
            
            <span id="chunk-4" class="transcript-chunks" onclick="console.log('00:00:41,386'); seek(41.0)">
              I don't really need to pay attention to that.
            </span>
            
            <span id="chunk-5" class="transcript-chunks" onclick="console.log('00:00:43,994'); seek(43.0)">
              But the reality is that problems are
            </span>
            
            <span id="chunk-6" class="transcript-chunks" onclick="console.log('00:00:47,802'); seek(47.0)">
              still happening every now and then. So if you know how to debug them,
            </span>
            
            <span id="chunk-7" class="transcript-chunks" onclick="console.log('00:00:51,770'); seek(51.0)">
              if you know how to tune the performance, then you
            </span>
            
            <span id="chunk-8" class="transcript-chunks" onclick="console.log('00:00:55,150'); seek(55.0)">
              save time of yourself, you save time of
            </span>
            
            <span id="chunk-9" class="transcript-chunks" onclick="console.log('00:00:59,030'); seek(59.0)">
              your team, but that also means saving money
            </span>
            
            <span id="chunk-10" class="transcript-chunks" onclick="console.log('00:01:02,526'); seek(62.0)">
              you spend on the infrastructure, saving money
            </span>
            
            <span id="chunk-11" class="transcript-chunks" onclick="console.log('00:01:05,878'); seek(65.0)">
              you spend on your cloud. Bill my name is Martin,
            </span>
            
            <span id="chunk-12" class="transcript-chunks" onclick="console.log('00:01:10,118'); seek(70.0)">
              I'm CEO of Tantus Data. At Tantusdata
            </span>
            
            <span id="chunk-13" class="transcript-chunks" onclick="console.log('00:01:13,918'); seek(73.0)">
              we help our customers with everything data related,
            </span>
            
            <span id="chunk-14" class="transcript-chunks" onclick="console.log('00:01:17,318'); seek(77.0)">
              from infrastructure through data engineering
            </span>
            
            <span id="chunk-15" class="transcript-chunks" onclick="console.log('00:01:20,674'); seek(80.0)">
              up to machine learning in production. And we also help
            </span>
            
            <span id="chunk-16" class="transcript-chunks" onclick="console.log('00:01:25,122'); seek(85.0)">
              with trainings. And today I'll share
            </span>
            
            <span id="chunk-17" class="transcript-chunks" onclick="console.log('00:01:28,954'); seek(88.0)">
              our lessons learned from multiple projects we
            </span>
            
            <span id="chunk-18" class="transcript-chunks" onclick="console.log('00:01:32,866'); seek(92.0)">
              have been helping with. And let me get started with
            </span>
            
            <span id="chunk-19" class="transcript-chunks" onclick="console.log('00:01:37,058'); seek(97.0)">
              short history of Spark. Because depending of
            </span>
            
            <span id="chunk-20" class="transcript-chunks" onclick="console.log('00:01:41,210'); seek(101.0)">
              which spark version you are working with,
            </span>
            
            <span id="chunk-21" class="transcript-chunks" onclick="console.log('00:01:44,642'); seek(104.0)">
              which spark version you had experience with, it very much depends
            </span>
            
            <span id="chunk-22" class="transcript-chunks" onclick="console.log('00:01:48,690'); seek(108.0)">
              on what impressions you've had, what experience you've had.
            </span>
            
            <span id="chunk-23" class="transcript-chunks" onclick="console.log('00:01:52,434'); seek(112.0)">
              So Spark version one was very unstable construct and
            </span>
            
            <span id="chunk-24" class="transcript-chunks" onclick="console.log('00:01:56,370'); seek(116.0)">
              you very often had to run to your admins, to your ops for some
            </span>
            
            <span id="chunk-25" class="transcript-chunks" onclick="console.log('00:02:00,274'); seek(120.0)">
              help for restarting of some services.
            </span>
            
            <span id="chunk-26" class="transcript-chunks" onclick="console.log('00:02:03,554'); seek(123.0)">
              Then Spark version two was much
            </span>
            
            <span id="chunk-27" class="transcript-chunks" onclick="console.log('00:02:06,906'); seek(126.0)">
              more stable. But still there was quite a big chance that
            </span>
            
            <span id="chunk-28" class="transcript-chunks" onclick="console.log('00:02:10,682'); seek(130.0)">
              you run a sequel, a sequel, which is
            </span>
            
            <span id="chunk-29" class="transcript-chunks" onclick="console.log('00:02:14,450'); seek(134.0)">
              perfectly correct, but it doesn't work. It doesn't work
            </span>
            
            <span id="chunk-30" class="transcript-chunks" onclick="console.log('00:02:18,388'); seek(138.0)">
              because of the data distribution, it doesn't work
            </span>
            
            <span id="chunk-31" class="transcript-chunks" onclick="console.log('00:02:21,916'); seek(141.0)">
              because of size of the data.
            </span>
            
            <span id="chunk-32" class="transcript-chunks" onclick="console.log('00:02:24,844'); seek(144.0)">
              If it doesn't work, if you don't know how to solve this
            </span>
            
            <span id="chunk-33" class="transcript-chunks" onclick="console.log('00:02:28,060'); seek(148.0)">
              kind of problem, all you could do, you could go and
            </span>
            
            <span id="chunk-34" class="transcript-chunks" onclick="console.log('00:02:31,364'); seek(151.0)">
              run asking for help or randomly selecting
            </span>
            
            <span id="chunk-35" class="transcript-chunks" onclick="console.log('00:02:35,148'); seek(155.0)">
              some random parameters with some hope that it will help,
            </span>
            
            <span id="chunk-36" class="transcript-chunks" onclick="console.log('00:02:38,844'); seek(158.0)">
              but usually it need not help. And then with Spark
            </span>
            
            <span id="chunk-37" class="transcript-chunks" onclick="console.log('00:02:42,966'); seek(162.0)">
              version three, the situation improved significantly because
            </span>
            
            <span id="chunk-38" class="transcript-chunks" onclick="console.log('00:02:46,694'); seek(166.0)">
              many of the common problems have been resolved.
            </span>
            
            <span id="chunk-39" class="transcript-chunks" onclick="console.log('00:02:49,902'); seek(169.0)">
              You have adaptive query execution, which basically does
            </span>
            
            <span id="chunk-40" class="transcript-chunks" onclick="console.log('00:02:54,582'); seek(174.0)">
              lots of optimizations for you,
            </span>
            
            <span id="chunk-41" class="transcript-chunks" onclick="console.log('00:02:57,574'); seek(177.0)">
              but still there is a chance it
            </span>
            
            <span id="chunk-42" class="transcript-chunks" onclick="console.log('00:03:01,230'); seek(181.0)">
              will fail, it will be too slow and you have to do the
            </span>
            
            <span id="chunk-43" class="transcript-chunks" onclick="console.log('00:03:04,686'); seek(184.0)">
              manual tuning. And today I'll show you
            </span>
            
            <span id="chunk-44" class="transcript-chunks" onclick="console.log('00:03:08,366'); seek(188.0)">
              some of these examples, some of examples which are not fixed
            </span>
            
            <span id="chunk-45" class="transcript-chunks" onclick="console.log('00:03:12,566'); seek(192.0)">
              even if, even in spark three,
            </span>
            
            <span id="chunk-46" class="transcript-chunks" onclick="console.log('00:03:16,134'); seek(196.0)">
              if SQL is good enough these
            </span>
            
            <span id="chunk-47" class="transcript-chunks" onclick="console.log('00:03:19,878'); seek(199.0)">
              days, in many cases, yes, in many cases you are good
            </span>
            
            <span id="chunk-48" class="transcript-chunks" onclick="console.log('00:03:23,670'); seek(203.0)">
              with SQL or with understanding of spark API,
            </span>
            
            <span id="chunk-49" class="transcript-chunks" onclick="console.log('00:03:26,990'); seek(206.0)">
              but I'll be sharing the cases where SQL is
            </span>
            
            <span id="chunk-50" class="transcript-chunks" onclick="console.log('00:03:30,150'); seek(210.0)">
              just let's get started with case number one
            </span>
            
            <span id="chunk-51" class="transcript-chunks" onclick="console.log('00:03:34,174'); seek(214.0)">
              and a short disclaimer is about what
            </span>
            
            <span id="chunk-52" class="transcript-chunks" onclick="console.log('00:03:37,682'); seek(217.0)">
              kind of cases. I'm showing cases which are
            </span>
            
            <span id="chunk-53" class="transcript-chunks" onclick="console.log('00:03:42,074'); seek(222.0)">
              based on production use cases, but they are very much simplified
            </span>
            
            <span id="chunk-54" class="transcript-chunks" onclick="console.log('00:03:45,546'); seek(225.0)">
              so they are simplified. We are dealing with very,
            </span>
            
            <span id="chunk-55" class="transcript-chunks" onclick="console.log('00:03:48,250'); seek(228.0)">
              very simplistic schema. We are working with very simplistic SQL,
            </span>
            
            <span id="chunk-56" class="transcript-chunks" onclick="console.log('00:03:52,562'); seek(232.0)">
              but the techniques we will be applying are very much
            </span>
            
            <span id="chunk-57" class="transcript-chunks" onclick="console.log('00:03:56,594'); seek(236.0)">
              matching what you would do in production. So how
            </span>
            
            <span id="chunk-58" class="transcript-chunks" onclick="console.log('00:03:59,762'); seek(239.0)">
              you debug, how you find out what the problem is,
            </span>
            
            <span id="chunk-59" class="transcript-chunks" onclick="console.log('00:04:03,256'); seek(243.0)">
              how you fix that, it's pretty much production
            </span>
            
            <span id="chunk-60" class="transcript-chunks" onclick="console.log('00:04:07,328'); seek(247.0)">
              like. And so it's very practical. So let's get started with case number
            </span>
            
            <span id="chunk-61" class="transcript-chunks" onclick="console.log('00:04:11,256'); seek(251.0)">
              one. In case number one, we will be processing
            </span>
            
            <span id="chunk-62" class="transcript-chunks" onclick="console.log('00:04:15,344'); seek(255.0)">
              events. We'll be processing a table with events. And that
            </span>
            
            <span id="chunk-63" class="transcript-chunks" onclick="console.log('00:04:19,184'); seek(259.0)">
              table will have just three columns, user id, event id,
            </span>
            
            <span id="chunk-64" class="transcript-chunks" onclick="console.log('00:04:23,752'); seek(263.0)">
              and a timestamp. And the whole point is that we are
            </span>
            
            <span id="chunk-65" class="transcript-chunks" onclick="console.log('00:04:27,312'); seek(267.0)">
              collecting some events, and let's say we are collecting them because
            </span>
            
            <span id="chunk-66" class="transcript-chunks" onclick="console.log('00:04:31,184'); seek(271.0)">
              we would like to understand how our users
            </span>
            
            <span id="chunk-67" class="transcript-chunks" onclick="console.log('00:04:34,648'); seek(274.0)">
              are interacting with a mobile app. So we
            </span>
            
            <span id="chunk-68" class="transcript-chunks" onclick="console.log('00:04:37,880'); seek(277.0)">
              understand where the glitch is, what is confusing to the users,
            </span>
            
            <span id="chunk-69" class="transcript-chunks" onclick="console.log('00:04:41,288'); seek(281.0)">
              and so on. And we would like to understand how much
            </span>
            
            <span id="chunk-70" class="transcript-chunks" onclick="console.log('00:04:44,992'); seek(284.0)">
              time they spend on a specific event. So we would like to calculate
            </span>
            
            <span id="chunk-71" class="transcript-chunks" onclick="console.log('00:04:49,944'); seek(289.0)">
              current event timestamp and the next event timestamp.
            </span>
            
            <span id="chunk-72" class="transcript-chunks" onclick="console.log('00:04:53,800'); seek(293.0)">
              So we understand which action
            </span>
            
            <span id="chunk-73" class="transcript-chunks" onclick="console.log('00:04:57,672'); seek(297.0)">
              is taking lots of time, which is potentially a
            </span>
            
            <span id="chunk-74" class="transcript-chunks" onclick="console.log('00:05:01,104'); seek(301.0)">
              confusing one. So we are searching for a potential of two
            </span>
            
            <span id="chunk-75" class="transcript-chunks" onclick="console.log('00:05:05,304'); seek(305.0)">
              to improve. So we are searching for the
            </span>
            
            <span id="chunk-76" class="transcript-chunks" onclick="console.log('00:05:08,992'); seek(308.0)">
              next event. We have some users and timestamp here we are
            </span>
            
            <span id="chunk-77" class="transcript-chunks" onclick="console.log('00:05:12,528'); seek(312.0)">
              looking at just single user. I pre sorted the event
            </span>
            
            <span id="chunk-78" class="transcript-chunks" onclick="console.log('00:05:16,288'); seek(316.0)">
              timestamp. We want to fill in
            </span>
            
            <span id="chunk-79" class="transcript-chunks" onclick="console.log('00:05:20,244'); seek(320.0)">
              an extra column which is next timestamp. And that
            </span>
            
            <span id="chunk-80" class="transcript-chunks" onclick="console.log('00:05:23,348'); seek(323.0)">
              is super simple on a data which is already pre sorted because the next
            </span>
            
            <span id="chunk-81" class="transcript-chunks" onclick="console.log('00:05:27,172'); seek(327.0)">
              timestamp would be exactly this one.
            </span>
            
            <span id="chunk-82" class="transcript-chunks" onclick="console.log('00:05:30,588'); seek(330.0)">
              And then for the second row, the next
            </span>
            
            <span id="chunk-83" class="transcript-chunks" onclick="console.log('00:05:33,844'); seek(333.0)">
              timestamp would be and
            </span>
            
            <span id="chunk-84" class="transcript-chunks" onclick="console.log('00:05:37,236'); seek(337.0)">
              so on. So it is quite simple. And if you
            </span>
            
            <span id="chunk-85" class="transcript-chunks" onclick="console.log('00:05:40,956'); seek(340.0)">
              would like to implement the code, then this is what it would
            </span>
            
            <span id="chunk-86" class="transcript-chunks" onclick="console.log('00:05:44,972'); seek(344.0)">
              look like in it doesn't look like a rocket science. We are just
            </span>
            
            <span id="chunk-87" class="transcript-chunks" onclick="console.log('00:05:48,830'); seek(348.0)">
              using a lead function.
            </span>
            
            <span id="chunk-88" class="transcript-chunks" onclick="console.log('00:05:52,014'); seek(352.0)">
              We do it over partition, data partition by
            </span>
            
            <span id="chunk-89" class="transcript-chunks" onclick="console.log('00:05:56,174'); seek(356.0)">
              user id and ordered by event timestamp.
            </span>
            
            <span id="chunk-90" class="transcript-chunks" onclick="console.log('00:06:00,390'); seek(360.0)">
              Super simple code. I don't really want to dig into that more,
            </span>
            
            <span id="chunk-91" class="transcript-chunks" onclick="console.log('00:06:04,182'); seek(364.0)">
              but the point is the code is perfectly fine,
            </span>
            
            <span id="chunk-92" class="transcript-chunks" onclick="console.log('00:06:07,782'); seek(367.0)">
              the code is correct. And let's see
            </span>
            
            <span id="chunk-93" class="transcript-chunks" onclick="console.log('00:06:10,942'); seek(370.0)">
              what will happen when you go to the Sparkui.
            </span>
            
            <span id="chunk-94" class="transcript-chunks" onclick="console.log('00:06:14,834'); seek(374.0)">
              If you go to the Sparkui, you will realize that
            </span>
            
            <span id="chunk-95" class="transcript-chunks" onclick="console.log('00:06:18,282'); seek(378.0)">
              the job is running. It has been running for 23
            </span>
            
            <span id="chunk-96" class="transcript-chunks" onclick="console.log('00:06:21,786'); seek(381.0)">
              minutes. Nothing to be worried about yet. We don't know the size
            </span>
            
            <span id="chunk-97" class="transcript-chunks" onclick="console.log('00:06:25,442'); seek(385.0)">
              of the data yet. So might be perfectly fine,
            </span>
            
            <span id="chunk-98" class="transcript-chunks" onclick="console.log('00:06:28,682'); seek(388.0)">
              might be not. What's a bit worrisome
            </span>
            
            <span id="chunk-99" class="transcript-chunks" onclick="console.log('00:06:32,474'); seek(392.0)">
              is number of tasks which are failing. We have already
            </span>
            
            <span id="chunk-100" class="transcript-chunks" onclick="console.log('00:06:36,242'); seek(396.0)">
              three tasks which are failing, but that doesn't necessarily
            </span>
            
            <span id="chunk-101" class="transcript-chunks" onclick="console.log('00:06:39,838'); seek(399.0)">
              mean something is wrong. We are talking about distributed system.
            </span>
            
            <span id="chunk-102" class="transcript-chunks" onclick="console.log('00:06:43,750'); seek(403.0)">
              It could be a network glitch and spark is supposed
            </span>
            
            <span id="chunk-103" class="transcript-chunks" onclick="console.log('00:06:47,222'); seek(407.0)">
              to recover from some random failures. So that's
            </span>
            
            <span id="chunk-104" class="transcript-chunks" onclick="console.log('00:06:50,550'); seek(410.0)">
              the whole point of having system like spark. It will hide
            </span>
            
            <span id="chunk-105" class="transcript-chunks" onclick="console.log('00:06:54,622'); seek(414.0)">
              some of the complexities, some of the failures from you if it was just
            </span>
            
            <span id="chunk-106" class="transcript-chunks" onclick="console.log('00:06:58,230'); seek(418.0)">
              random. But let's go a bit deeper. Let's go into
            </span>
            
            <span id="chunk-107" class="transcript-chunks" onclick="console.log('00:07:01,694'); seek(421.0)">
              the job details. In the job details, we have a
            </span>
            
            <span id="chunk-108" class="transcript-chunks" onclick="console.log('00:07:05,510'); seek(425.0)">
              single active stage which has been running for
            </span>
            
            <span id="chunk-109" class="transcript-chunks" onclick="console.log('00:07:08,674'); seek(428.0)">
              23 minutes, and we have 126
            </span>
            
            <span id="chunk-110" class="transcript-chunks" onclick="console.log('00:07:13,506'); seek(433.0)">
              tasks completed. One task is still waiting, is still
            </span>
            
            <span id="chunk-111" class="transcript-chunks" onclick="console.log('00:07:17,322'); seek(437.0)">
              running. If we go to that stage details,
            </span>
            
            <span id="chunk-112" class="transcript-chunks" onclick="console.log('00:07:21,082'); seek(441.0)">
              we can see extra information.
            </span>
            
            <span id="chunk-113" class="transcript-chunks" onclick="console.log('00:07:24,754'); seek(444.0)">
              So, first of all, the output size so far is quite
            </span>
            
            <span id="chunk-114" class="transcript-chunks" onclick="console.log('00:07:28,786'); seek(448.0)">
              small. It's just five gigs. But the PO is
            </span>
            
            <span id="chunk-115" class="transcript-chunks" onclick="console.log('00:07:33,174'); seek(453.0)">
              150 gigs of memory spill,
            </span>
            
            <span id="chunk-116" class="transcript-chunks" onclick="console.log('00:07:35,982'); seek(455.0)">
              80 gigs of disk spill. So it's, it is quite a lot. And that already
            </span>
            
            <span id="chunk-117" class="transcript-chunks" onclick="console.log('00:07:40,470'); seek(460.0)">
              shows us that there is some inefficiency.
            </span>
            
            <span id="chunk-118" class="transcript-chunks" onclick="console.log('00:07:44,134'); seek(464.0)">
              Whether we should be optimizing that or not, it very much depends. It very much
            </span>
            
            <span id="chunk-119" class="transcript-chunks" onclick="console.log('00:07:47,662'); seek(467.0)">
              depends on what exactly we are optimizing
            </span>
            
            <span id="chunk-120" class="transcript-chunks" onclick="console.log('00:07:51,926'); seek(471.0)">
              for. And it doesn't necessarily mean that if you
            </span>
            
            <span id="chunk-121" class="transcript-chunks" onclick="console.log('00:07:55,270'); seek(475.0)">
              see some spill that you have to jump into the optimization, because it could
            </span>
            
            <span id="chunk-122" class="transcript-chunks" onclick="console.log('00:07:58,702'); seek(478.0)">
              be quite hard. Let's see if
            </span>
            
            <span id="chunk-123" class="transcript-chunks" onclick="console.log('00:08:02,416'); seek(482.0)">
              we actually can see anything else which is boring.
            </span>
            
            <span id="chunk-124" class="transcript-chunks" onclick="console.log('00:08:06,904'); seek(486.0)">
              So if we can have a look at the diagram, we can see lots of
            </span>
            
            <span id="chunk-125" class="transcript-chunks" onclick="console.log('00:08:10,712'); seek(490.0)">
              those green, very tiny tasks. So most of the
            </span>
            
            <span id="chunk-126" class="transcript-chunks" onclick="console.log('00:08:14,560'); seek(494.0)">
              tasks are completing in no time.
            </span>
            
            <span id="chunk-127" class="transcript-chunks" onclick="console.log('00:08:17,504'); seek(497.0)">
              There is this one task has been running for quite a
            </span>
            
            <span id="chunk-128" class="transcript-chunks" onclick="console.log('00:08:21,448'); seek(501.0)">
              lot of time. There is another one which
            </span>
            
            <span id="chunk-129" class="transcript-chunks" onclick="console.log('00:08:24,864'); seek(504.0)">
              has been running for some time, and it failed again.
            </span>
            
            <span id="chunk-130" class="transcript-chunks" onclick="console.log('00:08:28,790'); seek(508.0)">
              And it's attempt number one. The previous one was attempt
            </span>
            
            <span id="chunk-131" class="transcript-chunks" onclick="console.log('00:08:32,078'); seek(512.0)">
              number zero. Now it's attempt number one. So we
            </span>
            
            <span id="chunk-132" class="transcript-chunks" onclick="console.log('00:08:35,206'); seek(515.0)">
              keep restarting the same task failing,
            </span>
            
            <span id="chunk-133" class="transcript-chunks" onclick="console.log('00:08:39,294'); seek(519.0)">
              and it takes most of the job time. That's already
            </span>
            
            <span id="chunk-134" class="transcript-chunks" onclick="console.log('00:08:43,134'); seek(523.0)">
              something we should look closer into. So what
            </span>
            
            <span id="chunk-135" class="transcript-chunks" onclick="console.log('00:08:46,982'); seek(526.0)">
              we have now, we have another attempt of the same task,
            </span>
            
            <span id="chunk-136" class="transcript-chunks" onclick="console.log('00:08:50,190'); seek(530.0)">
              and it's running for the fourth time. In the
            </span>
            
            <span id="chunk-137" class="transcript-chunks" onclick="console.log('00:08:53,420'); seek(533.0)">
              task overview, we can see all the tasks which has failed. We can
            </span>
            
            <span id="chunk-138" class="transcript-chunks" onclick="console.log('00:08:57,252'); seek(537.0)">
              see the single one which is running. This memory
            </span>
            
            <span id="chunk-139" class="transcript-chunks" onclick="console.log('00:09:01,148'); seek(541.0)">
              spill is actually produced only, but by those tasks,
            </span>
            
            <span id="chunk-140" class="transcript-chunks" onclick="console.log('00:09:04,860'); seek(544.0)">
              there is no more memory spill. We can see
            </span>
            
            <span id="chunk-141" class="transcript-chunks" onclick="console.log('00:09:08,380'); seek(548.0)">
              that they are taking some time, as we could see on the graph.
            </span>
            
            <span id="chunk-142" class="transcript-chunks" onclick="console.log('00:09:11,924'); seek(551.0)">
              And we also can see some, we can see some errors, and they
            </span>
            
            <span id="chunk-143" class="transcript-chunks" onclick="console.log('00:09:15,788'); seek(555.0)">
              are not very descriptive, maybe, except the disk space one.
            </span>
            
            <span id="chunk-144" class="transcript-chunks" onclick="console.log('00:09:19,744'); seek(559.0)">
              But overall, we can see errors,
            </span>
            
            <span id="chunk-145" class="transcript-chunks" onclick="console.log('00:09:22,736'); seek(562.0)">
              which doesn't really give us a good clue
            </span>
            
            <span id="chunk-146" class="transcript-chunks" onclick="console.log('00:09:26,200'); seek(566.0)">
              why it's happening. And other than that,
            </span>
            
            <span id="chunk-147" class="transcript-chunks" onclick="console.log('00:09:30,200'); seek(570.0)">
              we can see other tasks which are completing within 10
            </span>
            
            <span id="chunk-148" class="transcript-chunks" onclick="console.log('00:09:33,840'); seek(573.0)">
              seconds, which are producing like 40 megabytes
            </span>
            
            <span id="chunk-149" class="transcript-chunks" onclick="console.log('00:09:37,168'); seek(577.0)">
              of data. Nothing really suspicious about that.
            </span>
            
            <span id="chunk-150" class="transcript-chunks" onclick="console.log('00:09:40,480'); seek(580.0)">
              So let's try to dig into the problematic tasks, the task which
            </span>
            
            <span id="chunk-151" class="transcript-chunks" onclick="console.log('00:09:45,194'); seek(585.0)">
              keep restarting. If we look here,
            </span>
            
            <span id="chunk-152" class="transcript-chunks" onclick="console.log('00:09:48,466'); seek(588.0)">
              we can see the view from the SQL tab in
            </span>
            
            <span id="chunk-153" class="transcript-chunks" onclick="console.log('00:09:51,970'); seek(591.0)">
              spark and that gives us pretty much an execution
            </span>
            
            <span id="chunk-154" class="transcript-chunks" onclick="console.log('00:09:55,354'); seek(595.0)">
              plan with lots of details.
            </span>
            
            <span id="chunk-155" class="transcript-chunks" onclick="console.log('00:09:58,114'); seek(598.0)">
              First information we can see is that we are reading 100gb
            </span>
            
            <span id="chunk-156" class="transcript-chunks" onclick="console.log('00:10:02,722'); seek(602.0)">
              of data, nothing very special. It's 1 billion
            </span>
            
            <span id="chunk-157" class="transcript-chunks" onclick="console.log('00:10:06,226'); seek(606.0)">
              records. It is a lot, but it not
            </span>
            
            <span id="chunk-158" class="transcript-chunks" onclick="console.log('00:10:10,098'); seek(610.0)">
              something we shouldn't be able to process, right? Right. We are dealing with a distributed
            </span>
            
            <span id="chunk-159" class="transcript-chunks" onclick="console.log('00:10:13,966'); seek(613.0)">
              system, we are dealing with very small records. It shouldn't be
            </span>
            
            <span id="chunk-160" class="transcript-chunks" onclick="console.log('00:10:17,662'); seek(617.0)">
              too bad. And if we scroll down, we can
            </span>
            
            <span id="chunk-161" class="transcript-chunks" onclick="console.log('00:10:21,622'); seek(621.0)">
              see this first box we always should
            </span>
            
            <span id="chunk-162" class="transcript-chunks" onclick="console.log('00:10:25,110'); seek(625.0)">
              be paying attention to is called exchange. And that's pretty much
            </span>
            
            <span id="chunk-163" class="transcript-chunks" onclick="console.log('00:10:29,534'); seek(629.0)">
              means we are shuffling the data over the network.
            </span>
            
            <span id="chunk-164" class="transcript-chunks" onclick="console.log('00:10:32,430'); seek(632.0)">
              We are exchanging the data over the network. And this is something
            </span>
            
            <span id="chunk-165" class="transcript-chunks" onclick="console.log('00:10:36,174'); seek(636.0)">
              you need to pay attention to simply because first
            </span>
            
            <span id="chunk-166" class="transcript-chunks" onclick="console.log('00:10:39,482'); seek(639.0)">
              of all, it's expensive in general. Shuffle is something
            </span>
            
            <span id="chunk-167" class="transcript-chunks" onclick="console.log('00:10:42,786'); seek(642.0)">
              expensive in general, because it involves disk,
            </span>
            
            <span id="chunk-168" class="transcript-chunks" onclick="console.log('00:10:46,554'); seek(646.0)">
              network and so on. But other than that,
            </span>
            
            <span id="chunk-169" class="transcript-chunks" onclick="console.log('00:10:50,002'); seek(650.0)">
              it's good to pay attention to these kind of boxes.
            </span>
            
            <span id="chunk-170" class="transcript-chunks" onclick="console.log('00:10:54,114'); seek(654.0)">
              There are many things which are going wrong with exchanging
            </span>
            
            <span id="chunk-171" class="transcript-chunks" onclick="console.log('00:10:57,666'); seek(657.0)">
              of the data with. And in this code we are
            </span>
            
            <span id="chunk-172" class="transcript-chunks" onclick="console.log('00:11:00,970'); seek(660.0)">
              doing just a single shuffle. It's good to
            </span>
            
            <span id="chunk-173" class="transcript-chunks" onclick="console.log('00:11:04,810'); seek(664.0)">
              hover over the exchange box and understand what it's
            </span>
            
            <span id="chunk-174" class="transcript-chunks" onclick="console.log('00:11:08,720'); seek(668.0)">
              caused by. And it's here we are hash partitioning
            </span>
            
            <span id="chunk-175" class="transcript-chunks" onclick="console.log('00:11:12,064'); seek(672.0)">
              based on user id simply because we are explicitly
            </span>
            
            <span id="chunk-176" class="transcript-chunks" onclick="console.log('00:11:16,624'); seek(676.0)">
              in the, in the SQL code, we tell that we want to
            </span>
            
            <span id="chunk-177" class="transcript-chunks" onclick="console.log('00:11:19,960'); seek(679.0)">
              partition the data based on user id. But if your code
            </span>
            
            <span id="chunk-178" class="transcript-chunks" onclick="console.log('00:11:23,040'); seek(683.0)">
              is much bigger, it's good to understand what is
            </span>
            
            <span id="chunk-179" class="transcript-chunks" onclick="console.log('00:11:26,872'); seek(686.0)">
              the correlation between what in the spark UI and part of the code.
            </span>
            
            <span id="chunk-180" class="transcript-chunks" onclick="console.log('00:11:30,352'); seek(690.0)">
              And that helps you understand that, because usually you join by,
            </span>
            
            <span id="chunk-181" class="transcript-chunks" onclick="console.log('00:11:33,968'); seek(693.0)">
              you have multiple joins, you join by multiple different columns.
            </span>
            
            <span id="chunk-182" class="transcript-chunks" onclick="console.log('00:11:37,426'); seek(697.0)">
              And this is a good hint to narrow it down. Which part of the code
            </span>
            
            <span id="chunk-183" class="transcript-chunks" onclick="console.log('00:11:41,442'); seek(701.0)">
              is responsible for a specific box
            </span>
            
            <span id="chunk-184" class="transcript-chunks" onclick="console.log('00:11:46,354'); seek(706.0)">
              in the execution plan in the SQL tab?
            </span>
            
            <span id="chunk-185" class="transcript-chunks" onclick="console.log('00:11:49,394'); seek(709.0)">
              Okay, but if we check how many bytes
            </span>
            
            <span id="chunk-186" class="transcript-chunks" onclick="console.log('00:11:54,026'); seek(714.0)">
              were written by the shuffle, we are talking about 40 gigs.
            </span>
            
            <span id="chunk-187" class="transcript-chunks" onclick="console.log('00:11:58,450'); seek(718.0)">
              And the top partition is 45 megabytes. It is
            </span>
            
            <span id="chunk-188" class="transcript-chunks" onclick="console.log('00:12:02,406'); seek(722.0)">
              small, nothing to be worried about. But on the other hand,
            </span>
            
            <span id="chunk-189" class="transcript-chunks" onclick="console.log('00:12:07,134'); seek(727.0)">
              how many bytes have been after the
            </span>
            
            <span id="chunk-190" class="transcript-chunks" onclick="console.log('00:12:10,550'); seek(730.0)">
              shuffle, then it's completely different story.
            </span>
            
            <span id="chunk-191" class="transcript-chunks" onclick="console.log('00:12:14,294'); seek(734.0)">
              The top partition is 6gb, and that's
            </span>
            
            <span id="chunk-192" class="transcript-chunks" onclick="console.log('00:12:18,702'); seek(738.0)">
              huge. That means top partition is 67gb
            </span>
            
            <span id="chunk-193" class="transcript-chunks" onclick="console.log('00:12:22,574'); seek(742.0)">
              and that partition will be processed by just a single,
            </span>
            
            <span id="chunk-194" class="transcript-chunks" onclick="console.log('00:12:26,630'); seek(746.0)">
              by a single task. And that partition will
            </span>
            
            <span id="chunk-195" class="transcript-chunks" onclick="console.log('00:12:30,362'); seek(750.0)">
              be causing the problems because the,
            </span>
            
            <span id="chunk-196" class="transcript-chunks" onclick="console.log('00:12:33,650'); seek(753.0)">
              the whole rule is that single partition is processed
            </span>
            
            <span id="chunk-197" class="transcript-chunks" onclick="console.log('00:12:37,482'); seek(757.0)">
              by a single task. So the way it looks like
            </span>
            
            <span id="chunk-198" class="transcript-chunks" onclick="console.log('00:12:41,394'); seek(761.0)">
              is that whenever you read the data here we have virtual
            </span>
            
            <span id="chunk-199" class="transcript-chunks" onclick="console.log('00:12:45,498'); seek(765.0)">
              slide with hdfs. But that applies to s three,
            </span>
            
            <span id="chunk-200" class="transcript-chunks" onclick="console.log('00:12:49,242'); seek(769.0)">
              that applies to delta. Whatever data source
            </span>
            
            <span id="chunk-201" class="transcript-chunks" onclick="console.log('00:12:53,010'); seek(773.0)">
              you have, parc always have the
            </span>
            
            <span id="chunk-202" class="transcript-chunks" onclick="console.log('00:12:56,212'); seek(776.0)">
              concept of partition in mind, and it reads the data in chunks.
            </span>
            
            <span id="chunk-203" class="transcript-chunks" onclick="console.log('00:12:59,548'); seek(779.0)">
              So you read a chunk of the data within a task, you do some
            </span>
            
            <span id="chunk-204" class="transcript-chunks" onclick="console.log('00:13:03,364'); seek(783.0)">
              processing on the fly and eventually you prepare the
            </span>
            
            <span id="chunk-205" class="transcript-chunks" onclick="console.log('00:13:06,972'); seek(786.0)">
              data for shuffle. Here we are organizing the data based on the
            </span>
            
            <span id="chunk-206" class="transcript-chunks" onclick="console.log('00:13:10,460'); seek(790.0)">
              user id, simply because we are partitioning by
            </span>
            
            <span id="chunk-207" class="transcript-chunks" onclick="console.log('00:13:13,948'); seek(793.0)">
              user id. But it's the same with joins. If you join by a specific
            </span>
            
            <span id="chunk-208" class="transcript-chunks" onclick="console.log('00:13:17,588'); seek(797.0)">
              column, the data will be organized by that column,
            </span>
            
            <span id="chunk-209" class="transcript-chunks" onclick="console.log('00:13:22,142'); seek(802.0)">
              and then you have many tasks like that. And what will
            </span>
            
            <span id="chunk-210" class="transcript-chunks" onclick="console.log('00:13:25,838'); seek(805.0)">
              happen during the shuffle? All the chunks
            </span>
            
            <span id="chunk-211" class="transcript-chunks" onclick="console.log('00:13:29,526'); seek(809.0)">
              with specific user will go to the
            </span>
            
            <span id="chunk-212" class="transcript-chunks" onclick="console.log('00:13:33,654'); seek(813.0)">
              same, and that's perfectly fine.
            </span>
            
            <span id="chunk-213" class="transcript-chunks" onclick="console.log('00:13:37,030'); seek(817.0)">
              And the second user will probably go to another task,
            </span>
            
            <span id="chunk-214" class="transcript-chunks" onclick="console.log('00:13:40,582'); seek(820.0)">
              and that's all perfectly fine as long as
            </span>
            
            <span id="chunk-215" class="transcript-chunks" onclick="console.log('00:13:43,662'); seek(823.0)">
              the data can fit into the executor, as the data can be processed
            </span>
            
            <span id="chunk-216" class="transcript-chunks" onclick="console.log('00:13:47,310'); seek(827.0)">
              by the executor. If your user's user
            </span>
            
            <span id="chunk-217" class="transcript-chunks" onclick="console.log('00:13:51,396'); seek(831.0)">
              base, the event base is not balanced, if single
            </span>
            
            <span id="chunk-218" class="transcript-chunks" onclick="console.log('00:13:54,996'); seek(834.0)">
              user is producing too many events, you have
            </span>
            
            <span id="chunk-219" class="transcript-chunks" onclick="console.log('00:13:58,572'); seek(838.0)">
              a problem. Then you have a problem with maybe just
            </span>
            
            <span id="chunk-220" class="transcript-chunks" onclick="console.log('00:14:02,084'); seek(842.0)">
              a single task which cannot really process that data.
            </span>
            
            <span id="chunk-221" class="transcript-chunks" onclick="console.log('00:14:05,740'); seek(845.0)">
              And these kind of problems were very common in spark version
            </span>
            
            <span id="chunk-222" class="transcript-chunks" onclick="console.log('00:14:09,372'); seek(849.0)">
              two. Then with adaptive query
            </span>
            
            <span id="chunk-223" class="transcript-chunks" onclick="console.log('00:14:13,516'); seek(853.0)">
              execution it's been improved because for instance, like if you
            </span>
            
            <span id="chunk-224" class="transcript-chunks" onclick="console.log('00:14:17,234'); seek(857.0)">
              have this problem with left join, it's automatically
            </span>
            
            <span id="chunk-225" class="transcript-chunks" onclick="console.log('00:14:20,922'); seek(860.0)">
              balanced. But we are looking at the window function example
            </span>
            
            <span id="chunk-226" class="transcript-chunks" onclick="console.log('00:14:24,866'); seek(864.0)">
              where it is not balanced and we are struggling with that.
            </span>
            
            <span id="chunk-227" class="transcript-chunks" onclick="console.log('00:14:28,218'); seek(868.0)">
              That's exactly the situation we are struggling with. So how do
            </span>
            
            <span id="chunk-228" class="transcript-chunks" onclick="console.log('00:14:31,730'); seek(871.0)">
              we solve that? How do you fix a
            </span>
            
            <span id="chunk-229" class="transcript-chunks" onclick="console.log('00:14:34,986'); seek(874.0)">
              data which is imbalanced? How do you fix
            </span>
            
            <span id="chunk-230" class="transcript-chunks" onclick="console.log('00:14:38,418'); seek(878.0)">
              a skew in your data? First of all, you really need to
            </span>
            
            <span id="chunk-231" class="transcript-chunks" onclick="console.log('00:14:42,460'); seek(882.0)">
              understand where the problem is coming from and that
            </span>
            
            <span id="chunk-232" class="transcript-chunks" onclick="console.log('00:14:45,996'); seek(885.0)">
              your spark job is failing because of the skew. And once
            </span>
            
            <span id="chunk-233" class="transcript-chunks" onclick="console.log('00:14:49,868'); seek(889.0)">
              you understand that, then you can think, okay, maybe it
            </span>
            
            <span id="chunk-234" class="transcript-chunks" onclick="console.log('00:14:53,508'); seek(893.0)">
              is a bug, maybe it is a bug in my data, and then you simply
            </span>
            
            <span id="chunk-235" class="transcript-chunks" onclick="console.log('00:14:57,332'); seek(897.0)">
              have to fix that. Maybe you can think of filtering
            </span>
            
            <span id="chunk-236" class="transcript-chunks" onclick="console.log('00:15:01,004'); seek(901.0)">
              out the problematic users because in that given processing,
            </span>
            
            <span id="chunk-237" class="transcript-chunks" onclick="console.log('00:15:05,060'); seek(905.0)">
              you don't really need them. If that doesn't help,
            </span>
            
            <span id="chunk-238" class="transcript-chunks" onclick="console.log('00:15:09,566'); seek(909.0)">
              then you need to find out a way, figure out
            </span>
            
            <span id="chunk-239" class="transcript-chunks" onclick="console.log('00:15:13,302'); seek(913.0)">
              a way of completing the processing.
            </span>
            
            <span id="chunk-240" class="transcript-chunks" onclick="console.log('00:15:16,782'); seek(916.0)">
              And before I show you how to do that in this specific
            </span>
            
            <span id="chunk-241" class="transcript-chunks" onclick="console.log('00:15:20,310'); seek(920.0)">
              use case, I just want to make one more note,
            </span>
            
            <span id="chunk-242" class="transcript-chunks" onclick="console.log('00:15:24,054'); seek(924.0)">
              one more note, which is upgrade Spark if
            </span>
            
            <span id="chunk-243" class="transcript-chunks" onclick="console.log('00:15:28,070'); seek(928.0)">
              you are not on spark version three yet, because the
            </span>
            
            <span id="chunk-244" class="transcript-chunks" onclick="console.log('00:15:32,014'); seek(932.0)">
              problem I'm showing you is still something you
            </span>
            
            <span id="chunk-245" class="transcript-chunks" onclick="console.log('00:15:36,160'); seek(936.0)">
              have to fix manually. But in many cases,
            </span>
            
            <span id="chunk-246" class="transcript-chunks" onclick="console.log('00:15:40,984'); seek(940.0)">
              Spark three allows you to avoid this kind of manual fixes.
            </span>
            
            <span id="chunk-247" class="transcript-chunks" onclick="console.log('00:15:44,584'); seek(944.0)">
              So for instance, if you are doing a left join,
            </span>
            
            <span id="chunk-248" class="transcript-chunks" onclick="console.log('00:15:48,144'); seek(948.0)">
              Spark would automatically fix it for you if you are with
            </span>
            
            <span id="chunk-249" class="transcript-chunks" onclick="console.log('00:15:51,920'); seek(951.0)">
              the newest version. So keep that in mind,
            </span>
            
            <span id="chunk-250" class="transcript-chunks" onclick="console.log('00:15:55,016'); seek(955.0)">
              but let's see how we can potentially solve this problem.
            </span>
            
            <span id="chunk-251" class="transcript-chunks" onclick="console.log('00:15:59,364'); seek(959.0)">
              So the scenario I showed you is that we are calculating
            </span>
            
            <span id="chunk-252" class="transcript-chunks" onclick="console.log('00:16:03,604'); seek(963.0)">
              the next timestamp, so we are pulling it from the next record
            </span>
            
            <span id="chunk-253" class="transcript-chunks" onclick="console.log('00:16:07,964'); seek(967.0)">
              and so on. And the scenario I'm showing you
            </span>
            
            <span id="chunk-254" class="transcript-chunks" onclick="console.log('00:16:11,652'); seek(971.0)">
              is that we are calculating user one
            </span>
            
            <span id="chunk-255" class="transcript-chunks" onclick="console.log('00:16:15,572'); seek(975.0)">
              data in the same partition. But if this user is producing
            </span>
            
            <span id="chunk-256" class="transcript-chunks" onclick="console.log('00:16:19,684'); seek(979.0)">
              so many records, why don't we process that
            </span>
            
            <span id="chunk-257" class="transcript-chunks" onclick="console.log('00:16:23,268'); seek(983.0)">
              user or all the users, so we don't have to
            </span>
            
            <span id="chunk-258" class="transcript-chunks" onclick="console.log('00:16:26,808'); seek(986.0)">
              process all the, all the records at once. We have,
            </span>
            
            <span id="chunk-259" class="transcript-chunks" onclick="console.log('00:16:29,952'); seek(989.0)">
              we can process them day by day,
            </span>
            
            <span id="chunk-260" class="transcript-chunks" onclick="console.log('00:16:33,480'); seek(993.0)">
              and that's quite easy to implement. The only problem with that will
            </span>
            
            <span id="chunk-261" class="transcript-chunks" onclick="console.log('00:16:36,872'); seek(996.0)">
              be that the last record of each
            </span>
            
            <span id="chunk-262" class="transcript-chunks" onclick="console.log('00:16:40,536'); seek(1000.0)">
              day will be now, unless we fix that. And coming up with
            </span>
            
            <span id="chunk-263" class="transcript-chunks" onclick="console.log('00:16:44,200'); seek(1004.0)">
              a fix is really not a rocket science.
            </span>
            
            <span id="chunk-264" class="transcript-chunks" onclick="console.log('00:16:47,264'); seek(1007.0)">
              So if we look into that here, we are calculating an extra
            </span>
            
            <span id="chunk-265" class="transcript-chunks" onclick="console.log('00:16:50,656'); seek(1010.0)">
              column, which is a bit of math to tell which day
            </span>
            
            <span id="chunk-266" class="transcript-chunks" onclick="console.log('00:16:55,004'); seek(1015.0)">
              is that. So we are not dealing with timestamp anymore. We are also dealing
            </span>
            
            <span id="chunk-267" class="transcript-chunks" onclick="console.log('00:16:58,692'); seek(1018.0)">
              with number of a day. We are defining
            </span>
            
            <span id="chunk-268" class="transcript-chunks" onclick="console.log('00:17:02,004'); seek(1022.0)">
              a bunch of windows for the processing,
            </span>
            
            <span id="chunk-269" class="transcript-chunks" onclick="console.log('00:17:05,572'); seek(1025.0)">
              because we will be processing the user not only based
            </span>
            
            <span id="chunk-270" class="transcript-chunks" onclick="console.log('00:17:09,372'); seek(1029.0)">
              on user id, but also on a window which is user id and
            </span>
            
            <span id="chunk-271" class="transcript-chunks" onclick="console.log('00:17:12,860'); seek(1032.0)">
              a day. And then we calculate a bunch of
            </span>
            
            <span id="chunk-272" class="transcript-chunks" onclick="console.log('00:17:16,804'); seek(1036.0)">
              kind of helper data frames, which is the
            </span>
            
            <span id="chunk-273" class="transcript-chunks" onclick="console.log('00:17:20,413'); seek(1040.0)">
              events with nodes. Then after that we
            </span>
            
            <span id="chunk-274" class="transcript-chunks" onclick="console.log('00:17:23,829'); seek(1043.0)">
              fix the nodes and then we do the union and
            </span>
            
            <span id="chunk-275" class="transcript-chunks" onclick="console.log('00:17:27,821'); seek(1047.0)">
              merge them together. But the whole point is not really how exactly this code works.
            </span>
            
            <span id="chunk-276" class="transcript-chunks" onclick="console.log('00:17:31,901'); seek(1051.0)">
              It's not a rocket science. The whole point is that if we
            </span>
            
            <span id="chunk-277" class="transcript-chunks" onclick="console.log('00:17:35,341'); seek(1055.0)">
              do that, if we do this kind of processing, we explicitly tell
            </span>
            
            <span id="chunk-278" class="transcript-chunks" onclick="console.log('00:17:38,973'); seek(1058.0)">
              Spark that we want to do day by day processing.
            </span>
            
            <span id="chunk-279" class="transcript-chunks" onclick="console.log('00:17:43,053'); seek(1063.0)">
              And this is what we will see in the spark UI.
            </span>
            
            <span id="chunk-280" class="transcript-chunks" onclick="console.log('00:17:46,556'); seek(1066.0)">
              So we don't have this single event with or single task,
            </span>
            
            <span id="chunk-281" class="transcript-chunks" onclick="console.log('00:17:50,732'); seek(1070.0)">
              which is taking most of the time and eventually failing. We see
            </span>
            
            <span id="chunk-282" class="transcript-chunks" onclick="console.log('00:17:54,492'); seek(1074.0)">
              the distribution being very even and the
            </span>
            
            <span id="chunk-283" class="transcript-chunks" onclick="console.log('00:17:58,132'); seek(1078.0)">
              top task is taking 210 seconds. You might argue that
            </span>
            
            <span id="chunk-284" class="transcript-chunks" onclick="console.log('00:18:01,964'); seek(1081.0)">
              it probably not optimal either.
            </span>
            
            <span id="chunk-285" class="transcript-chunks" onclick="console.log('00:18:04,980'); seek(1084.0)">
              But the point is the job was running for 20 minutes
            </span>
            
            <span id="chunk-286" class="transcript-chunks" onclick="console.log('00:18:08,364'); seek(1088.0)">
              and it would never really complete. I just killed that.
            </span>
            
            <span id="chunk-287" class="transcript-chunks" onclick="console.log('00:18:12,348'); seek(1092.0)">
              And now it's running less for less than
            </span>
            
            <span id="chunk-288" class="transcript-chunks" onclick="console.log('00:18:16,124'); seek(1096.0)">
              1 minute and it completes and everything is fine.
            </span>
            
            <span id="chunk-289" class="transcript-chunks" onclick="console.log('00:18:19,524'); seek(1099.0)">
              So if you do this kind of optimizations,
            </span>
            
            <span id="chunk-290" class="transcript-chunks" onclick="console.log('00:18:23,524'); seek(1103.0)">
              really need to understand why you are optimizing
            </span>
            
            <span id="chunk-291" class="transcript-chunks" onclick="console.log('00:18:27,492'); seek(1107.0)">
              this. In our case, the job was just failing,
            </span>
            
            <span id="chunk-292" class="transcript-chunks" onclick="console.log('00:18:30,940'); seek(1110.0)">
              so you had to fix that. But if you do further optimizations, you need to
            </span>
            
            <span id="chunk-293" class="transcript-chunks" onclick="console.log('00:18:34,612'); seek(1114.0)">
              think what is worth your time. Maybe you want to
            </span>
            
            <span id="chunk-294" class="transcript-chunks" onclick="console.log('00:18:38,180'); seek(1118.0)">
              just move on and move to another problem. Maybe you want to
            </span>
            
            <span id="chunk-295" class="transcript-chunks" onclick="console.log('00:18:41,872'); seek(1121.0)">
              optimize for the wall clock time because your customers are waiting
            </span>
            
            <span id="chunk-296" class="transcript-chunks" onclick="console.log('00:18:45,472'); seek(1125.0)">
              for the data. Maybe you want to optimize for the resource utilizer
            </span>
            
            <span id="chunk-297" class="transcript-chunks" onclick="console.log('00:18:49,160'); seek(1129.0)">
              because you want to optimize the cloud bill. And maybe
            </span>
            
            <span id="chunk-298" class="transcript-chunks" onclick="console.log('00:18:52,984'); seek(1132.0)">
              you want to avoid optimization because you don't want to complicate
            </span>
            
            <span id="chunk-299" class="transcript-chunks" onclick="console.log('00:18:57,112'); seek(1137.0)">
              your code. You don't want to make your code
            </span>
            
            <span id="chunk-300" class="transcript-chunks" onclick="console.log('00:19:00,872'); seek(1140.0)">
              more complex simply because you want the maintenance.
            </span>
            
            <span id="chunk-301" class="transcript-chunks" onclick="console.log('00:19:05,524'); seek(1145.0)">
              All right, so let's have a look at case number two. Case number
            </span>
            
            <span id="chunk-302" class="transcript-chunks" onclick="console.log('00:19:09,196'); seek(1149.0)">
              two, which on the surface could look very similar
            </span>
            
            <span id="chunk-303" class="transcript-chunks" onclick="console.log('00:19:12,332'); seek(1152.0)">
              to the previous one, but it would be slightly different.
            </span>
            
            <span id="chunk-304" class="transcript-chunks" onclick="console.log('00:19:15,532'); seek(1155.0)">
              So let's have a look. We are not looking into the code.
            </span>
            
            <span id="chunk-305" class="transcript-chunks" onclick="console.log('00:19:19,532'); seek(1159.0)">
              We just try to very quickly figure out what's going
            </span>
            
            <span id="chunk-306" class="transcript-chunks" onclick="console.log('00:19:23,356'); seek(1163.0)">
              on based on just Sparkui. So we have a spark drop, which is
            </span>
            
            <span id="chunk-307" class="transcript-chunks" onclick="console.log('00:19:26,948'); seek(1166.0)">
              again running for 20 minutes. After an hour or so, I killed it because
            </span>
            
            <span id="chunk-308" class="transcript-chunks" onclick="console.log('00:19:30,484'); seek(1170.0)">
              it could never really complete. And what we can see is
            </span>
            
            <span id="chunk-309" class="transcript-chunks" onclick="console.log('00:19:33,930'); seek(1173.0)">
              a very similar situation to the previous
            </span>
            
            <span id="chunk-310" class="transcript-chunks" onclick="console.log('00:19:37,866'); seek(1177.0)">
              job, which had tasks almost
            </span>
            
            <span id="chunk-311" class="transcript-chunks" onclick="console.log('00:19:41,866'); seek(1181.0)">
              immediately completing. And this single task, which is problematic,
            </span>
            
            <span id="chunk-312" class="transcript-chunks" onclick="console.log('00:19:45,890'); seek(1185.0)">
              which is running for probably it would be very hard to complete.
            </span>
            
            <span id="chunk-313" class="transcript-chunks" onclick="console.log('00:19:50,474'); seek(1190.0)">
              And you might say, okay, but it looks like exactly the same situation.
            </span>
            
            <span id="chunk-314" class="transcript-chunks" onclick="console.log('00:19:54,594'); seek(1194.0)">
              The difference would be when we look into
            </span>
            
            <span id="chunk-315" class="transcript-chunks" onclick="console.log('00:19:58,122'); seek(1198.0)">
              active stages and if you look at the output
            </span>
            
            <span id="chunk-316" class="transcript-chunks" onclick="console.log('00:20:02,140'); seek(1202.0)">
              and the shuffle read, it looks like we are processing
            </span>
            
            <span id="chunk-317" class="transcript-chunks" onclick="console.log('00:20:05,836'); seek(1205.0)">
              almost no data. In the shuffle read phase we have
            </span>
            
            <span id="chunk-318" class="transcript-chunks" onclick="console.log('00:20:09,180'); seek(1209.0)">
              just 20 megabytes. So it looks like we are processing
            </span>
            
            <span id="chunk-319" class="transcript-chunks" onclick="console.log('00:20:12,524'); seek(1212.0)">
              almost no data. Yet the job cannot complete.
            </span>
            
            <span id="chunk-320" class="transcript-chunks" onclick="console.log('00:20:17,444'); seek(1217.0)">
              In the SQL tab we can confirm that
            </span>
            
            <span id="chunk-321" class="transcript-chunks" onclick="console.log('00:20:21,364'); seek(1221.0)">
              the input is small. After doing
            </span>
            
            <span id="chunk-322" class="transcript-chunks" onclick="console.log('00:20:24,860'); seek(1224.0)">
              a bit of kind of self joining, we can see that
            </span>
            
            <span id="chunk-323" class="transcript-chunks" onclick="console.log('00:20:28,178'); seek(1228.0)">
              the sortmer join phase is
            </span>
            
            <span id="chunk-324" class="transcript-chunks" onclick="console.log('00:20:31,738'); seek(1231.0)">
              processing the record number, 4 billion something.
            </span>
            
            <span id="chunk-325" class="transcript-chunks" onclick="console.log('00:20:35,794'); seek(1235.0)">
              And it, the number is growing. So even though we are reading
            </span>
            
            <span id="chunk-326" class="transcript-chunks" onclick="console.log('00:20:39,778'); seek(1239.0)">
              not that many records, we are producing lots of
            </span>
            
            <span id="chunk-327" class="transcript-chunks" onclick="console.log('00:20:43,650'); seek(1243.0)">
              record. I'll do a bit of a shortcut because
            </span>
            
            <span id="chunk-328" class="transcript-chunks" onclick="console.log('00:20:47,162'); seek(1247.0)">
              of the time limitation, but bottom line
            </span>
            
            <span id="chunk-329" class="transcript-chunks" onclick="console.log('00:20:50,586'); seek(1250.0)">
              is that products table with order id
            </span>
            
            <span id="chunk-330" class="transcript-chunks" onclick="console.log('00:20:54,168'); seek(1254.0)">
              and we are joining the product table with itself based
            </span>
            
            <span id="chunk-331" class="transcript-chunks" onclick="console.log('00:20:57,952'); seek(1257.0)">
              on the order id, because we would like to do an
            </span>
            
            <span id="chunk-332" class="transcript-chunks" onclick="console.log('00:21:01,552'); seek(1261.0)">
              analysis of products r
            </span>
            
            <span id="chunk-333" class="transcript-chunks" onclick="console.log('00:21:05,368'); seek(1265.0)">
              board. And the problem with Cartesian join, that if
            </span>
            
            <span id="chunk-334" class="transcript-chunks" onclick="console.log('00:21:08,912'); seek(1268.0)">
              you have three records as an input size is
            </span>
            
            <span id="chunk-335" class="transcript-chunks" onclick="console.log('00:21:12,336'); seek(1272.0)">
              nine, then for ten you get hundred in an output,
            </span>
            
            <span id="chunk-336" class="transcript-chunks" onclick="console.log('00:21:16,576'); seek(1276.0)">
              but it grows really quickly. So for 10,000 records,
            </span>
            
            <span id="chunk-337" class="transcript-chunks" onclick="console.log('00:21:20,308'); seek(1280.0)">
              you end up with hundreds, millions of records. It's nothing
            </span>
            
            <span id="chunk-338" class="transcript-chunks" onclick="console.log('00:21:24,516'); seek(1284.0)">
              new. It's a problem which is known for a long time. You just need to
            </span>
            
            <span id="chunk-339" class="transcript-chunks" onclick="console.log('00:21:27,948'); seek(1287.0)">
              be aware that if you are doing self joined, then the number of records will
            </span>
            
            <span id="chunk-340" class="transcript-chunks" onclick="console.log('00:21:31,468'); seek(1291.0)">
              be huge. But the problem here is that all the records are
            </span>
            
            <span id="chunk-341" class="transcript-chunks" onclick="console.log('00:21:34,844'); seek(1294.0)">
              processed within just a single executors.
            </span>
            
            <span id="chunk-342" class="transcript-chunks" onclick="console.log('00:21:38,644'); seek(1298.0)">
              Single executor. Simply because Spark
            </span>
            
            <span id="chunk-343" class="transcript-chunks" onclick="console.log('00:21:43,260'); seek(1303.0)">
              is doing that based on the order id is our joint key
            </span>
            
            <span id="chunk-344" class="transcript-chunks" onclick="console.log('00:21:46,832'); seek(1306.0)">
              and the same order id is being processed in the
            </span>
            
            <span id="chunk-345" class="transcript-chunks" onclick="console.log('00:21:49,928'); seek(1309.0)">
              same task. Unless we explicitly. The very
            </span>
            
            <span id="chunk-346" class="transcript-chunks" onclick="console.log('00:21:53,744'); seek(1313.0)">
              simple technique to avoid this kind of behavior is salting
            </span>
            
            <span id="chunk-347" class="transcript-chunks" onclick="console.log('00:21:57,984'); seek(1317.0)">
              in the product table. If we join it
            </span>
            
            <span id="chunk-348" class="transcript-chunks" onclick="console.log('00:22:01,560'); seek(1321.0)">
              with itself, we on one hand we
            </span>
            
            <span id="chunk-349" class="transcript-chunks" onclick="console.log('00:22:05,224'); seek(1325.0)">
              add a random value.
            </span>
            
            <span id="chunk-350" class="transcript-chunks" onclick="console.log('00:22:08,964'); seek(1328.0)">
              Here I'm using the random value from range one up to two
            </span>
            
            <span id="chunk-351" class="transcript-chunks" onclick="console.log('00:22:12,492'); seek(1332.0)">
              so it can fit into the slides right hand side
            </span>
            
            <span id="chunk-352" class="transcript-chunks" onclick="console.log('00:22:16,036'); seek(1336.0)">
              table. We are generating every single
            </span>
            
            <span id="chunk-353" class="transcript-chunks" onclick="console.log('00:22:20,620'); seek(1340.0)">
              possible combination of SAl. So we duplicate
            </span>
            
            <span id="chunk-354" class="transcript-chunks" onclick="console.log('00:22:24,812'); seek(1344.0)">
              the records. But the benefit of doing that is
            </span>
            
            <span id="chunk-355" class="transcript-chunks" onclick="console.log('00:22:28,020'); seek(1348.0)">
              that instead of all the nine records being
            </span>
            
            <span id="chunk-356" class="transcript-chunks" onclick="console.log('00:22:31,772'); seek(1351.0)">
              processed in one task, with these
            </span>
            
            <span id="chunk-357" class="transcript-chunks" onclick="console.log('00:22:35,560'); seek(1355.0)">
              three producing six records with the remaining
            </span>
            
            <span id="chunk-358" class="transcript-chunks" onclick="console.log('00:22:39,696'); seek(1359.0)">
              three. So instead of processing all the nine
            </span>
            
            <span id="chunk-359" class="transcript-chunks" onclick="console.log('00:22:43,016'); seek(1363.0)">
              records in the same task, it will be processed by two
            </span>
            
            <span id="chunk-360" class="transcript-chunks" onclick="console.log('00:22:46,368'); seek(1366.0)">
              separate tasks. And this way we distribute the load.
            </span>
            
            <span id="chunk-361" class="transcript-chunks" onclick="console.log('00:22:49,904'); seek(1369.0)">
              So just so we are on the same page doing
            </span>
            
            <span id="chunk-362" class="transcript-chunks" onclick="console.log('00:22:53,248'); seek(1373.0)">
              something in cartesian join, we are not limiting the number of
            </span>
            
            <span id="chunk-363" class="transcript-chunks" onclick="console.log('00:22:56,464'); seek(1376.0)">
              records. The number of records will still be the
            </span>
            
            <span id="chunk-364" class="transcript-chunks" onclick="console.log('00:23:00,040'); seek(1380.0)">
              same. You just produce lots of records. But what you're doing is you're
            </span>
            
            <span id="chunk-365" class="transcript-chunks" onclick="console.log('00:23:03,662'); seek(1383.0)">
              parallelizing the execution, you make it better
            </span>
            
            <span id="chunk-366" class="transcript-chunks" onclick="console.log('00:23:07,718'); seek(1387.0)">
              distributed. So end of the day,
            </span>
            
            <span id="chunk-367" class="transcript-chunks" onclick="console.log('00:23:10,878'); seek(1390.0)">
              we can see many tasks which are
            </span>
            
            <span id="chunk-368" class="transcript-chunks" onclick="console.log('00:23:14,774'); seek(1394.0)">
              all doing something which are all running for quite some time,
            </span>
            
            <span id="chunk-369" class="transcript-chunks" onclick="console.log('00:23:19,142'); seek(1399.0)">
              and the top task is running for eleven minutes. You could argue we
            </span>
            
            <span id="chunk-370" class="transcript-chunks" onclick="console.log('00:23:23,518'); seek(1403.0)">
              could split it even further. The tasks are still processing quite
            </span>
            
            <span id="chunk-371" class="transcript-chunks" onclick="console.log('00:23:27,342'); seek(1407.0)">
              a lot of data. Probably we can split that. But the point is
            </span>
            
            <span id="chunk-372" class="transcript-chunks" onclick="console.log('00:23:31,446'); seek(1411.0)">
              we won't be waiting forever. This might be good enough.
            </span>
            
            <span id="chunk-373" class="transcript-chunks" onclick="console.log('00:23:35,326'); seek(1415.0)">
              You might want to tune the saud value we used in this case,
            </span>
            
            <span id="chunk-374" class="transcript-chunks" onclick="console.log('00:23:38,902'); seek(1418.0)">
              I believe we used 180 or something like that.
            </span>
            
            <span id="chunk-375" class="transcript-chunks" onclick="console.log('00:23:42,054'); seek(1422.0)">
              So a bit more than on the. Alright, so let's have
            </span>
            
            <span id="chunk-376" class="transcript-chunks" onclick="console.log('00:23:45,478'); seek(1425.0)">
              a look at case number three and case number four.
            </span>
            
            <span id="chunk-377" class="transcript-chunks" onclick="console.log('00:23:49,134'); seek(1429.0)">
              And they are grouped together because they are both related to lazy evaluation.
            </span>
            
            <span id="chunk-378" class="transcript-chunks" onclick="console.log('00:23:54,134'); seek(1434.0)">
              So lazy evaluation is something which is thought
            </span>
            
            <span id="chunk-379" class="transcript-chunks" onclick="console.log('00:23:57,574'); seek(1437.0)">
              at the very beginning of every single spark curse.
            </span>
            
            <span id="chunk-380" class="transcript-chunks" onclick="console.log('00:24:00,522'); seek(1440.0)">
              Yet it is something which is very easy to forget about.
            </span>
            
            <span id="chunk-381" class="transcript-chunks" onclick="console.log('00:24:04,882'); seek(1444.0)">
              And the whole concept is that if you read some data
            </span>
            
            <span id="chunk-382" class="transcript-chunks" onclick="console.log('00:24:08,826'); seek(1448.0)">
              frame and then you do some complex transformation,
            </span>
            
            <span id="chunk-383" class="transcript-chunks" onclick="console.log('00:24:11,938'); seek(1451.0)">
              then that complex transformation does not happen immediately.
            </span>
            
            <span id="chunk-384" class="transcript-chunks" onclick="console.log('00:24:15,762'); seek(1455.0)">
              The park just remembers what it has to do,
            </span>
            
            <span id="chunk-385" class="transcript-chunks" onclick="console.log('00:24:18,826'); seek(1458.0)">
              and it does it when it's absolutely necessary.
            </span>
            
            <span id="chunk-386" class="transcript-chunks" onclick="console.log('00:24:22,802'); seek(1462.0)">
              So it's a, it's an optimization concept, so it doesn't
            </span>
            
            <span id="chunk-387" class="transcript-chunks" onclick="console.log('00:24:26,418'); seek(1466.0)">
              have to do every single action immediately.
            </span>
            
            <span id="chunk-388" class="transcript-chunks" onclick="console.log('00:24:30,194'); seek(1470.0)">
              If you for some reason decide to do a while and
            </span>
            
            <span id="chunk-389" class="transcript-chunks" onclick="console.log('00:24:33,810'); seek(1473.0)">
              then do this kind of complex transformation in a loop,
            </span>
            
            <span id="chunk-390" class="transcript-chunks" onclick="console.log('00:24:37,482'); seek(1477.0)">
              you need to be aware that this will not
            </span>
            
            <span id="chunk-391" class="transcript-chunks" onclick="console.log('00:24:41,818'); seek(1481.0)">
              be memorized anywhere. Spark doesn't have any cache for
            </span>
            
            <span id="chunk-392" class="transcript-chunks" onclick="console.log('00:24:45,210'); seek(1485.0)">
              that which is happening immediately.
            </span>
            
            <span id="chunk-393" class="transcript-chunks" onclick="console.log('00:24:49,294'); seek(1489.0)">
              Parc will be just remembering more and more operations to be
            </span>
            
            <span id="chunk-394" class="transcript-chunks" onclick="console.log('00:24:53,006'); seek(1493.0)">
              done, and the complexity of every single iteration
            </span>
            
            <span id="chunk-395" class="transcript-chunks" onclick="console.log('00:24:57,382'); seek(1497.0)">
              will grow. So the first iteration it takes 23 seconds
            </span>
            
            <span id="chunk-396" class="transcript-chunks" onclick="console.log('00:25:01,614'); seek(1501.0)">
              and a few jobs to be completed. Then after some more iterations,
            </span>
            
            <span id="chunk-397" class="transcript-chunks" onclick="console.log('00:25:05,518'); seek(1505.0)">
              it takes 1 minute and several jobs to be completed.
            </span>
            
            <span id="chunk-398" class="transcript-chunks" onclick="console.log('00:25:09,974'); seek(1509.0)">
              And then it takes nine minutes and growing really
            </span>
            
            <span id="chunk-399" class="transcript-chunks" onclick="console.log('00:25:13,470'); seek(1513.0)">
              fast. And the same with the complexity.
            </span>
            
            <span id="chunk-400" class="transcript-chunks" onclick="console.log('00:25:17,018'); seek(1517.0)">
              Initial one is initial job is quite simple,
            </span>
            
            <span id="chunk-401" class="transcript-chunks" onclick="console.log('00:25:21,274'); seek(1521.0)">
              then it's a bit more complex. And then we go
            </span>
            
            <span id="chunk-402" class="transcript-chunks" onclick="console.log('00:25:25,130'); seek(1525.0)">
              here, we scroll down even more and we are keep repeating the
            </span>
            
            <span id="chunk-403" class="transcript-chunks" onclick="console.log('00:25:28,570'); seek(1528.0)">
              same operations, but we do them from scratch
            </span>
            
            <span id="chunk-404" class="transcript-chunks" onclick="console.log('00:25:32,210'); seek(1532.0)">
              in every iteration unless we do something
            </span>
            
            <span id="chunk-405" class="transcript-chunks" onclick="console.log('00:25:35,770'); seek(1535.0)">
              about that. So what is the conclusion here. First of all,
            </span>
            
            <span id="chunk-406" class="transcript-chunks" onclick="console.log('00:25:39,938'); seek(1539.0)">
              loops are suspicious because it's somewhat like
            </span>
            
            <span id="chunk-407" class="transcript-chunks" onclick="console.log('00:25:43,710'); seek(1543.0)">
              doing a batch within a batch system so far
            </span>
            
            <span id="chunk-408" class="transcript-chunks" onclick="console.log('00:25:47,262'); seek(1547.0)">
              has its own operators,
            </span>
            
            <span id="chunk-409" class="transcript-chunks" onclick="console.log('00:25:50,646'); seek(1550.0)">
              which are batch operators. But we are using loops simply
            </span>
            
            <span id="chunk-410" class="transcript-chunks" onclick="console.log('00:25:54,590'); seek(1554.0)">
              because we can. And sometimes it's okay, but in some cases
            </span>
            
            <span id="chunk-411" class="transcript-chunks" onclick="console.log('00:25:57,894'); seek(1557.0)">
              it's really suspicious. In some cases it really leads to
            </span>
            
            <span id="chunk-412" class="transcript-chunks" onclick="console.log('00:26:01,582'); seek(1561.0)">
              growing complexity of the execution plan. But you
            </span>
            
            <span id="chunk-413" class="transcript-chunks" onclick="console.log('00:26:04,878'); seek(1564.0)">
              can grow the execution plan even without the loop. So if your
            </span>
            
            <span id="chunk-414" class="transcript-chunks" onclick="console.log('00:26:08,502'); seek(1568.0)">
              execution plan is growing out of hand, if you can see that spark
            </span>
            
            <span id="chunk-415" class="transcript-chunks" onclick="console.log('00:26:13,244'); seek(1573.0)">
              slowing down because of how complex,
            </span>
            
            <span id="chunk-416" class="transcript-chunks" onclick="console.log('00:26:16,508'); seek(1576.0)">
              how many operations you have to do, then it's worth
            </span>
            
            <span id="chunk-417" class="transcript-chunks" onclick="console.log('00:26:20,428'); seek(1580.0)">
              considering checkpointing or materializing the results
            </span>
            
            <span id="chunk-418" class="transcript-chunks" onclick="console.log('00:26:24,116'); seek(1584.0)">
              on the way. And it's, on one hand, it's a
            </span>
            
            <span id="chunk-419" class="transcript-chunks" onclick="console.log('00:26:27,260'); seek(1587.0)">
              good kind of hack, or it's a
            </span>
            
            <span id="chunk-420" class="transcript-chunks" onclick="console.log('00:26:30,812'); seek(1590.0)">
              good, let's say, workaround for very
            </span>
            
            <span id="chunk-421" class="transcript-chunks" onclick="console.log('00:26:34,228'); seek(1594.0)">
              big. But on the other hand, it could be good idea to
            </span>
            
            <span id="chunk-422" class="transcript-chunks" onclick="console.log('00:26:38,060'); seek(1598.0)">
              split very complex code, very complex, dug into modules,
            </span>
            
            <span id="chunk-423" class="transcript-chunks" onclick="console.log('00:26:42,136'); seek(1602.0)">
              and that could help, you could help even with the code maintenance.
            </span>
            
            <span id="chunk-424" class="transcript-chunks" onclick="console.log('00:26:46,344'); seek(1606.0)">
              So it could serve two purposes.
            </span>
            
            <span id="chunk-425" class="transcript-chunks" onclick="console.log('00:26:49,344'); seek(1609.0)">
              But other than that, something which is very much related to
            </span>
            
            <span id="chunk-426" class="transcript-chunks" onclick="console.log('00:26:53,120'); seek(1613.0)">
              the lazy execution is whether our code is
            </span>
            
            <span id="chunk-427" class="transcript-chunks" onclick="console.log('00:26:56,768'); seek(1616.0)">
              deterministic or not, because if it's not deterministic.
            </span>
            
            <span id="chunk-428" class="transcript-chunks" onclick="console.log('00:27:00,488'); seek(1620.0)">
              So for instance, we want to randomly generate
            </span>
            
            <span id="chunk-429" class="transcript-chunks" onclick="console.log('00:27:03,856'); seek(1623.0)">
              values because we want a unique.
            </span>
            
            <span id="chunk-430" class="transcript-chunks" onclick="console.log('00:27:07,064'); seek(1627.0)">
              It becomes very tricky. It becomes
            </span>
            
            <span id="chunk-431" class="transcript-chunks" onclick="console.log('00:27:10,456'); seek(1630.0)">
              very tricky because let's say we want to split our
            </span>
            
            <span id="chunk-432" class="transcript-chunks" onclick="console.log('00:27:13,784'); seek(1633.0)">
              data frame into two data frames because of the machine
            </span>
            
            <span id="chunk-433" class="transcript-chunks" onclick="console.log('00:27:17,384'); seek(1637.0)">
              learning, split the split for machine learning. Then if we write
            </span>
            
            <span id="chunk-434" class="transcript-chunks" onclick="console.log('00:27:21,400'); seek(1641.0)">
              a code like that, we generate a column with random value
            </span>
            
            <span id="chunk-435" class="transcript-chunks" onclick="console.log('00:27:26,024'); seek(1646.0)">
              and we generate two different data frames, and we hope that the
            </span>
            
            <span id="chunk-436" class="transcript-chunks" onclick="console.log('00:27:29,952'); seek(1649.0)">
              split based on that random value is,
            </span>
            
            <span id="chunk-437" class="transcript-chunks" onclick="console.log('00:27:33,224'); seek(1653.0)">
              is happening. So you have two data frames
            </span>
            
            <span id="chunk-438" class="transcript-chunks" onclick="console.log('00:27:37,096'); seek(1657.0)">
              which are not overlapping. Then you might get surprised,
            </span>
            
            <span id="chunk-439" class="transcript-chunks" onclick="console.log('00:27:40,504'); seek(1660.0)">
              because when you write data frame one, then you write data
            </span>
            
            <span id="chunk-440" class="transcript-chunks" onclick="console.log('00:27:43,976'); seek(1663.0)">
              frame two. The random generation will happen
            </span>
            
            <span id="chunk-441" class="transcript-chunks" onclick="console.log('00:27:47,824'); seek(1667.0)">
              from the very beginning, it will happen from scratch.
            </span>
            
            <span id="chunk-442" class="transcript-chunks" onclick="console.log('00:27:50,744'); seek(1670.0)">
              And that's a real problem I actually have seen.
            </span>
            
            <span id="chunk-443" class="transcript-chunks" onclick="console.log('00:27:54,264'); seek(1674.0)">
              It will fail. It will create overlaps, it will create
            </span>
            
            <span id="chunk-444" class="transcript-chunks" onclick="console.log('00:27:57,912'); seek(1677.0)">
              lost records. And this is a LinkedIn message
            </span>
            
            <span id="chunk-445" class="transcript-chunks" onclick="console.log('00:28:01,760'); seek(1681.0)">
              I received from a friend. He was fuming because
            </span>
            
            <span id="chunk-446" class="transcript-chunks" onclick="console.log('00:28:05,304'); seek(1685.0)">
              of that. He spent lots of time.
            </span>
            
            <span id="chunk-447" class="transcript-chunks" onclick="console.log('00:28:09,184'); seek(1689.0)">
              It was really significant bug because it was introducing
            </span>
            
            <span id="chunk-448" class="transcript-chunks" onclick="console.log('00:28:14,784'); seek(1694.0)">
              an overfitting effect
            </span>
            
            <span id="chunk-449" class="transcript-chunks" onclick="console.log('00:28:19,344'); seek(1699.0)">
              in their machine learning pipeline. So whenever
            </span>
            
            <span id="chunk-450" class="transcript-chunks" onclick="console.log('00:28:22,752'); seek(1702.0)">
              you deal with random values, first of all, check if you
            </span>
            
            <span id="chunk-451" class="transcript-chunks" onclick="console.log('00:28:26,252'); seek(1706.0)">
              don't have this kind of mechanism like splitting data frames
            </span>
            
            <span id="chunk-452" class="transcript-chunks" onclick="console.log('00:28:29,924'); seek(1709.0)">
              in the standard library, because that you do have. But if you
            </span>
            
            <span id="chunk-453" class="transcript-chunks" onclick="console.log('00:28:33,668'); seek(1713.0)">
              do something a bit more custom, then make sure you materialize
            </span>
            
            <span id="chunk-454" class="transcript-chunks" onclick="console.log('00:28:37,428'); seek(1717.0)">
              result, because that's the safest. That is the safest one. It might be not
            </span>
            
            <span id="chunk-455" class="transcript-chunks" onclick="console.log('00:28:41,444'); seek(1721.0)">
              the most kind of time efficient, but it's
            </span>
            
            <span id="chunk-456" class="transcript-chunks" onclick="console.log('00:28:45,148'); seek(1725.0)">
              the safest. You don't risk that someone else will come do
            </span>
            
            <span id="chunk-457" class="transcript-chunks" onclick="console.log('00:28:48,924'); seek(1728.0)">
              some modification in your code without knowing what is happening.
            </span>
            
            <span id="chunk-458" class="transcript-chunks" onclick="console.log('00:28:52,734'); seek(1732.0)">
              So what will be the conclusion from all
            </span>
            
            <span id="chunk-459" class="transcript-chunks" onclick="console.log('00:28:57,710'); seek(1737.0)">
              the examples I showed you? First of all, you really need to know
            </span>
            
            <span id="chunk-460" class="transcript-chunks" onclick="console.log('00:29:01,478'); seek(1741.0)">
              what you are optimizing for, whether it's your time,
            </span>
            
            <span id="chunk-461" class="transcript-chunks" onclick="console.log('00:29:04,678'); seek(1744.0)">
              the compute time, the wall clock time. It really
            </span>
            
            <span id="chunk-462" class="transcript-chunks" onclick="console.log('00:29:09,454'); seek(1749.0)">
              helps if you understand where the bottleneck is.
            </span>
            
            <span id="chunk-463" class="transcript-chunks" onclick="console.log('00:29:13,334'); seek(1753.0)">
              If these kind of cases are new to you,
            </span>
            
            <span id="chunk-464" class="transcript-chunks" onclick="console.log('00:29:16,566'); seek(1756.0)">
              I would suggest that you invest a bit of time for experimenting and
            </span>
            
            <span id="chunk-465" class="transcript-chunks" onclick="console.log('00:29:20,142'); seek(1760.0)">
              learning a bit more about how spark works under the hood. But if
            </span>
            
            <span id="chunk-466" class="transcript-chunks" onclick="console.log('00:29:24,080'); seek(1764.0)">
              you feel that you don't have these kind of problems
            </span>
            
            <span id="chunk-467" class="transcript-chunks" onclick="console.log('00:29:27,528'); seek(1767.0)">
              on daily basis, you should at least know
            </span>
            
            <span id="chunk-468" class="transcript-chunks" onclick="console.log('00:29:31,152'); seek(1771.0)">
              when to ask for help and who to ask for help. Because maybe you
            </span>
            
            <span id="chunk-469" class="transcript-chunks" onclick="console.log('00:29:35,096'); seek(1775.0)">
              are a data scientist. You want to focus on the data science, not spark debugging.
            </span>
            
            <span id="chunk-470" class="transcript-chunks" onclick="console.log('00:29:38,832'); seek(1778.0)">
              You don't want to be a PhD in
            </span>
            
            <span id="chunk-471" class="transcript-chunks" onclick="console.log('00:29:41,960'); seek(1781.0)">
              spark, but then at least know when you are blocked
            </span>
            
            <span id="chunk-472" class="transcript-chunks" onclick="console.log('00:29:45,616'); seek(1785.0)">
              and make sure you know where to ask for help. So for
            </span>
            
            <span id="chunk-473" class="transcript-chunks" onclick="console.log('00:29:48,940'); seek(1788.0)">
              instance, maybe there is a data engineer which is good at these kind of things.
            </span>
            
            <span id="chunk-474" class="transcript-chunks" onclick="console.log('00:29:52,804'); seek(1792.0)">
              Feel free to reach out to me on LinkedIn and
            </span>
            
            <span id="chunk-475" class="transcript-chunks" onclick="console.log('00:29:56,996'); seek(1796.0)">
              I will be very happy to talk to.
            </span>
            
            </div>
          </div>
          

          
          <div class="col-12 mb-5">
            <h3>
              Slides
            </h3>
            <iframe src="https://conf42.github.io/static/slides/Marcin%20Szymaniuk%20-%20Conf42%20Machine%20Learning%202024.pdf" width="100%" height="500px"></iframe>
            <a href="https://conf42.github.io/static/slides/Marcin%20Szymaniuk%20-%20Conf42%20Machine%20Learning%202024.pdf" class="btn btn-xs btn-info shadow lift" style="background-color: #198B91;" target="_blank">
              <i class="fe fe-paperclip me-2"></i>
              Download slides (PDF)
            </a>
          </div>
          

          <div class="col-12 mb-2 text-center">
            <div class="text-center mb-5">
              <a href="https://www.conf42.com/ml2024" class="btn btn-sm btn-danger shadow lift" style="background-color: #198B91;">
                <i class="fe fe-grid me-2"></i>
                See all 36 talks at this event!
              </a>
            </div>
          </div>
        </div> <!-- / .row -->
      </div> <!-- / .container -->
    </section>

    <!-- PHOTO -->
    <section class="pt-8 pb-6">
      <div class="container">

        <div class="row align-items-center">
          <div class="col-12 col-md-6 col-lg-7">

            <div class="mb-8 mb-md-0">

              <!-- Image -->
              <img src="https://conf42.github.io/static/headshots/Marcin%20Szymaniuk_ml.png" alt="..." class="screenshot img-fluid mw-md-110 float-end me-md-6 mb-6 mb-md-0">

            </div>

          </div>
          <div class="col-12 col-md-6 col-lg-5">

            <!-- List -->
            <div class="d-flex">

              <!-- Body -->
              <div class="ms-5">

                <!-- Author 1 -->
                <h2 class="me-2">
                  Marcin Szymaniuk
                </h2>
                <h3 class="me-2">
                  <span class="text-muted">
                    CEO @ TantusData
                  </span>
                </h3>

                <p class="text-uppercase text-muted me-2 mb-3">
                  
                  <a href="https://www.linkedin.com/in/marcin-szymaniuk/" target="_blank" class="mr-3">
                    <img src="./assets/img/icons/social/linkedin.svg" class="list-social-icon" alt="Marcin Szymaniuk's LinkedIn account" />
                  </a>
                  
                  
                </p>
                

                <br />

                <a
                  href="https://twitter.com/share?ref_src=twsrc%5Etfw"
                  class="twitter-share-button"

                  data-text="Check out this talk by Marcin Szymaniuk"
                  data-url="https://www.conf42.com/ml2024"
                  data-via="conf42com"
                  data-related=""
                  data-show-count="false"
                >
                  Tweet
                </a>
                <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

                <br />

                <script src="https://platform.linkedin.com/in.js" type="text/javascript">lang: en_US</script>
                <script type="IN/Share" data-url="https://www.conf42.com/ml2024"></script>
              </div>

            </div>
          </div>
        </div> <!-- / .row -->
      </div> <!-- / .container -->
    </section>





  <script>
    function gtag_report_conversion(url) {
      var callback = function () {
        if (typeof(url) != 'undefined') {
          window.location = url;
        }
      };
      gtag('event', 'conversion', {
          'send_to': 'AW-882275635/jLVTCPbt1N8CELPq2aQD',
          'event_callback': callback
      });
      return false;
    }
    </script>
    <!-- SUBSCRIBE -->
    <section class="pt-8 pt-md-11 bg-gradient-light-white" id="register">
        <div class="container">
          <div class="row align-items-center justify-content-between mb-8 mb-md-11">
            <div class="col-12 col-md-6 order-md-2" data-aos="fade-left">
  
              <!-- Heading -->
              <h2>
                Awesome tech events for <br>
                <span class="text-success"><span data-typed='{"strings": ["software engineers.", "tech leaders.", "SREs.", "DevOps.", "CTOs.",  "managers.", "architects.", "QAs.", "developers.", "coders.", "founders.", "CEOs.", "students.", "geeks.", "ethical hackers.", "educators.", "enthusiasts.", "directors.", "researchers.", "PHDs.", "evangelists.", "tech authors."]}'></span></span>
              </h2>
  
              <!-- Text -->
              <p class="fs-lg text-muted mb-6">
  
              </p>
  
              <!-- List -->
              <div class="row">
                <div class="col-12 col-lg-12">
  
                  <!-- Item -->
                  <div class="d-flex">
                    <!-- Check -->
                    <div class="badge badge-rounded-circle bg-success-soft mt-1 me-4">
                      <i class="fe fe-check"></i>
                    </div>
                    <!-- Text -->
                    <p class="text-success">
                      Priority access to all content
                    </p>
                  </div>
  
                  <!-- Item -->
                  <div class="d-flex">
                    <!-- Check -->
                    <div class="badge badge-rounded-circle bg-success-soft mt-1 me-4">
                      <i class="fe fe-check"></i>
                    </div>
                    <p class="text-success">
                      Video hallway track
                    </p>
                  </div>

                  <!-- Item -->
                  <div class="d-flex">
                    <!-- Check -->
                    <div class="badge badge-rounded-circle bg-success-soft mt-1 me-4">
                      <i class="fe fe-check"></i>
                    </div>
                    <p class="text-success">
                      Community chat
                    </p>
                  </div>
  
                  <!-- Item -->
                  <div class="d-flex">
                    <!-- Check -->
                    <div class="badge badge-rounded-circle bg-success-soft mt-1 me-4">
                      <i class="fe fe-check"></i>
                    </div>
                    <p class="text-success">
                      Exclusive promotions and giveaways
                    </p>
                  </div>
  
                </div>
              </div> <!-- / .row -->
  
            </div>
            <div class="col-12 col-md-6 col-lg-5 order-md-1">
  
              <!-- Card -->
              <div class="card shadow-light-lg">
  
                <!-- Body -->
                <div class="card-body">
  
                  <!-- Form -->
                  <link rel="stylesheet" href="https://emailoctopus.com/bundles/emailoctopuslist/css/1.6/form.css">
                  <p class="emailoctopus-success-message text-success"></p>
                  <p class="emailoctopus-error-message text-danger"></p>
                  <form
                    action="https://emailoctopus.com/lists/a3ba0cb5-7524-11eb-a3d0-06b4694bee2a/members/embedded/1.3/add"
                    method="post"
                    data-message-success="Thanks! Check your email for further directions!"
                    data-message-missing-email-address="Your email address is required."
                    data-message-invalid-email-address="Your email address looks incorrect, please try again."
                    data-message-bot-submission-error="This doesn't look like a human submission."
                    data-message-consent-required="Please check the checkbox to indicate your consent."
                    data-message-invalid-parameters-error="This form has missing or invalid fields."
                    data-message-unknown-error="Sorry, an unknown error has occurred. Please try again later."
                    class="emailoctopus-form"
                    data-sitekey="6LdYsmsUAAAAAPXVTt-ovRsPIJ_IVhvYBBhGvRV6"
                  >
                    <div class="form-floating emailoctopus-form-row">
                      <input type="email" class="form-control form-control-flush" name="field_0" id="field_0" placeholder="Email" required>
                      <label for="field_0">Email address</label>
                    </div>
                    <div class="form-floating emailoctopus-form-row">
                      <input type="text" class="form-control form-control-flush" name="field_1" id="field_1" placeholder="First Name" required>
                      <label for="field_1">First Name</label>
                    </div>
                    <div class="form-floating emailoctopus-form-row">
                      <input type="text" class="form-control form-control-flush" name="field_2" id="field_2" placeholder="Last Name" required>
                      <label for="field_2">Last Name</label>
                    </div>
                    <div class="form-floating emailoctopus-form-row">
                      <input type="text" class="form-control form-control-flush" name="field_4" id="field_4" placeholder="Company" required>
                      <label for="field_4">Company</label>
                    </div>
                    <div class="form-floating emailoctopus-form-row">
                      <input type="text" class="form-control form-control-flush" name="field_5" id="field_5" placeholder="Job Title" required>
                      <label for="field_5">Job Title</label>
                    </div>
                    <div class="form-floating emailoctopus-form-row">
                      <input type="text" class="form-control form-control-flush" name="field_3" id="field_3" placeholder="Phone">
                      <label for="field_3">Phone Number</label>
                    </div>
                    <div class="form-floating emailoctopus-form-row">
                      <select type="text" class="form-control form-control-flush" name="field_7" id="country-source" required
                        oninput="updateCountry()"
                      >
                        <!-- Country names and Country Name -->
    <option value="">Please select your country</option>
    <option value="Afghanistan">Afghanistan</option>
    <option value="Aland Islands">Aland Islands</option>
    <option value="Albania">Albania</option>
    <option value="Algeria">Algeria</option>
    <option value="American Samoa">American Samoa</option>
    <option value="Andorra">Andorra</option>
    <option value="Angola">Angola</option>
    <option value="Anguilla">Anguilla</option>
    <option value="Antarctica">Antarctica</option>
    <option value="Antigua and Barbuda">Antigua and Barbuda</option>
    <option value="Argentina">Argentina</option>
    <option value="Armenia">Armenia</option>
    <option value="Aruba">Aruba</option>
    <option value="Australia">Australia</option>
    <option value="Austria">Austria</option>
    <option value="Azerbaijan">Azerbaijan</option>
    <option value="Bahamas">Bahamas</option>
    <option value="Bahrain">Bahrain</option>
    <option value="Bangladesh">Bangladesh</option>
    <option value="Barbados">Barbados</option>
    <option value="Belarus">Belarus</option>
    <option value="Belgium">Belgium</option>
    <option value="Belize">Belize</option>
    <option value="Benin">Benin</option>
    <option value="Bermuda">Bermuda</option>
    <option value="Bhutan">Bhutan</option>
    <option value="Bolivia">Bolivia</option>
    <option value="Bonaire, Sint Eustatius and Saba">Bonaire, Sint Eustatius and Saba</option>
    <option value="Bosnia and Herzegovina">Bosnia and Herzegovina</option>
    <option value="Botswana">Botswana</option>
    <option value="Bouvet Island">Bouvet Island</option>
    <option value="Brazil">Brazil</option>
    <option value="British Indian Ocean Territory">British Indian Ocean Territory</option>
    <option value="Brunei Darussalam">Brunei Darussalam</option>
    <option value="Bulgaria">Bulgaria</option>
    <option value="Burkina Faso">Burkina Faso</option>
    <option value="Burundi">Burundi</option>
    <option value="Cambodia">Cambodia</option>
    <option value="Cameroon">Cameroon</option>
    <option value="Canada">Canada</option>
    <option value="Cape Verde">Cape Verde</option>
    <option value="Cayman Islands">Cayman Islands</option>
    <option value="Central African Republic">Central African Republic</option>
    <option value="Chad">Chad</option>
    <option value="Chile">Chile</option>
    <option value="China">China</option>
    <option value="Christmas Island">Christmas Island</option>
    <option value="Cocos (Keeling) Islands">Cocos (Keeling) Islands</option>
    <option value="Colombia">Colombia</option>
    <option value="Comoros">Comoros</option>
    <option value="Congo">Congo</option>
    <option value="Congo, Democratic Republic of the Congo">Congo, Democratic Republic of the Congo</option>
    <option value="Cook Islands">Cook Islands</option>
    <option value="Costa Rica">Costa Rica</option>
    <option value="Cote D'Ivoire">Cote D'Ivoire</option>
    <option value="Croatia">Croatia</option>
    <option value="Cuba">Cuba</option>
    <option value="Curacao">Curacao</option>
    <option value="Cyprus">Cyprus</option>
    <option value="Czech Republic">Czech Republic</option>
    <option value="Denmark">Denmark</option>
    <option value="Djibouti">Djibouti</option>
    <option value="Dominica">Dominica</option>
    <option value="Dominican Republic">Dominican Republic</option>
    <option value="Ecuador">Ecuador</option>
    <option value="Egypt">Egypt</option>
    <option value="El Salvador">El Salvador</option>
    <option value="Equatorial Guinea">Equatorial Guinea</option>
    <option value="Eritrea">Eritrea</option>
    <option value="Estonia">Estonia</option>
    <option value="Ethiopia">Ethiopia</option>
    <option value="Falkland Islands (Malvinas)">Falkland Islands (Malvinas)</option>
    <option value="Faroe Islands">Faroe Islands</option>
    <option value="Fiji">Fiji</option>
    <option value="Finland">Finland</option>
    <option value="France">France</option>
    <option value="French Guiana">French Guiana</option>
    <option value="French Polynesia">French Polynesia</option>
    <option value="French Southern Territories">French Southern Territories</option>
    <option value="Gabon">Gabon</option>
    <option value="Gambia">Gambia</option>
    <option value="Georgia">Georgia</option>
    <option value="Germany">Germany</option>
    <option value="Ghana">Ghana</option>
    <option value="Gibraltar">Gibraltar</option>
    <option value="Greece">Greece</option>
    <option value="Greenland">Greenland</option>
    <option value="Grenada">Grenada</option>
    <option value="Guadeloupe">Guadeloupe</option>
    <option value="Guam">Guam</option>
    <option value="Guatemala">Guatemala</option>
    <option value="Guernsey">Guernsey</option>
    <option value="Guinea">Guinea</option>
    <option value="Guinea-Bissau">Guinea-Bissau</option>
    <option value="Guyana">Guyana</option>
    <option value="Haiti">Haiti</option>
    <option value="Heard Island and Mcdonald Islands">Heard Island and Mcdonald Islands</option>
    <option value="Holy See (Vatican City State)">Holy See (Vatican City State)</option>
    <option value="Honduras">Honduras</option>
    <option value="Hong Kong">Hong Kong</option>
    <option value="Hungary">Hungary</option>
    <option value="Iceland">Iceland</option>
    <option value="India">India</option>
    <option value="Indonesia">Indonesia</option>
    <option value="Iran, Islamic Republic of">Iran, Islamic Republic of</option>
    <option value="Iraq">Iraq</option>
    <option value="Ireland">Ireland</option>
    <option value="Isle of Man">Isle of Man</option>
    <option value="Israel">Israel</option>
    <option value="Italy">Italy</option>
    <option value="Jamaica">Jamaica</option>
    <option value="Japan">Japan</option>
    <option value="Jersey">Jersey</option>
    <option value="Jordan">Jordan</option>
    <option value="Kazakhstan">Kazakhstan</option>
    <option value="Kenya">Kenya</option>
    <option value="Kiribati">Kiribati</option>
    <option value="Korea, Democratic People's Republic of">Korea, Democratic People's Republic of</option>
    <option value="Korea, Republic of">Korea, Republic of</option>
    <option value="Kosovo">Kosovo</option>
    <option value="Kuwait">Kuwait</option>
    <option value="Kyrgyzstan">Kyrgyzstan</option>
    <option value="Lao People's Democratic Republic">Lao People's Democratic Republic</option>
    <option value="Latvia">Latvia</option>
    <option value="Lebanon">Lebanon</option>
    <option value="Lesotho">Lesotho</option>
    <option value="Liberia">Liberia</option>
    <option value="Libyan Arab Jamahiriya">Libyan Arab Jamahiriya</option>
    <option value="Liechtenstein">Liechtenstein</option>
    <option value="Lithuania">Lithuania</option>
    <option value="Luxembourg">Luxembourg</option>
    <option value="Macao">Macao</option>
    <option value="Macedonia, the Former Yugoslav Republic of">Macedonia, the Former Yugoslav Republic of</option>
    <option value="Madagascar">Madagascar</option>
    <option value="Malawi">Malawi</option>
    <option value="Malaysia">Malaysia</option>
    <option value="Maldives">Maldives</option>
    <option value="Mali">Mali</option>
    <option value="Malta">Malta</option>
    <option value="Marshall Islands">Marshall Islands</option>
    <option value="Martinique">Martinique</option>
    <option value="Mauritania">Mauritania</option>
    <option value="Mauritius">Mauritius</option>
    <option value="Mayotte">Mayotte</option>
    <option value="Mexico">Mexico</option>
    <option value="Micronesia, Federated States of">Micronesia, Federated States of</option>
    <option value="Moldova, Republic of">Moldova, Republic of</option>
    <option value="Monaco">Monaco</option>
    <option value="Mongolia">Mongolia</option>
    <option value="Montenegro">Montenegro</option>
    <option value="Montserrat">Montserrat</option>
    <option value="Morocco">Morocco</option>
    <option value="Mozambique">Mozambique</option>
    <option value="Myanmar">Myanmar</option>
    <option value="Namibia">Namibia</option>
    <option value="Nauru">Nauru</option>
    <option value="Nepal">Nepal</option>
    <option value="Netherlands">Netherlands</option>
    <option value="Netherlands Antilles">Netherlands Antilles</option>
    <option value="New Caledonia">New Caledonia</option>
    <option value="New Zealand">New Zealand</option>
    <option value="Nicaragua">Nicaragua</option>
    <option value="Niger">Niger</option>
    <option value="Nigeria">Nigeria</option>
    <option value="Niue">Niue</option>
    <option value="Norfolk Island">Norfolk Island</option>
    <option value="Northern Mariana Islands">Northern Mariana Islands</option>
    <option value="Norway">Norway</option>
    <option value="Oman">Oman</option>
    <option value="Pakistan">Pakistan</option>
    <option value="Palau">Palau</option>
    <option value="Palestinian Territory, Occupied">Palestinian Territory, Occupied</option>
    <option value="Panama">Panama</option>
    <option value="Papua New Guinea">Papua New Guinea</option>
    <option value="Paraguay">Paraguay</option>
    <option value="Peru">Peru</option>
    <option value="Philippines">Philippines</option>
    <option value="Pitcairn">Pitcairn</option>
    <option value="Poland">Poland</option>
    <option value="Portugal">Portugal</option>
    <option value="Puerto Rico">Puerto Rico</option>
    <option value="Qatar">Qatar</option>
    <option value="Reunion">Reunion</option>
    <option value="Romania">Romania</option>
    <option value="Russian Federation">Russian Federation</option>
    <option value="Rwanda">Rwanda</option>
    <option value="Saint Barthelemy">Saint Barthelemy</option>
    <option value="Saint Helena">Saint Helena</option>
    <option value="Saint Kitts and Nevis">Saint Kitts and Nevis</option>
    <option value="Saint Lucia">Saint Lucia</option>
    <option value="Saint Martin">Saint Martin</option>
    <option value="Saint Pierre and Miquelon">Saint Pierre and Miquelon</option>
    <option value="Saint Vincent and the Grenadines">Saint Vincent and the Grenadines</option>
    <option value="Samoa">Samoa</option>
    <option value="San Marino">San Marino</option>
    <option value="Sao Tome and Principe">Sao Tome and Principe</option>
    <option value="Saudi Arabia">Saudi Arabia</option>
    <option value="Senegal">Senegal</option>
    <option value="Serbia">Serbia</option>
    <option value="Serbia and Montenegro">Serbia and Montenegro</option>
    <option value="Seychelles">Seychelles</option>
    <option value="Sierra Leone">Sierra Leone</option>
    <option value="Singapore">Singapore</option>
    <option value="Sint Maarten">Sint Maarten</option>
    <option value="Slovakia">Slovakia</option>
    <option value="Slovenia">Slovenia</option>
    <option value="Solomon Islands">Solomon Islands</option>
    <option value="Somalia">Somalia</option>
    <option value="South Africa">South Africa</option>
    <option value="South Georgia and the South Sandwich Islands">South Georgia and the South Sandwich Islands</option>
    <option value="South Sudan">South Sudan</option>
    <option value="Spain">Spain</option>
    <option value="Sri Lanka">Sri Lanka</option>
    <option value="Sudan">Sudan</option>
    <option value="Suriname">Suriname</option>
    <option value="Svalbard and Jan Mayen">Svalbard and Jan Mayen</option>
    <option value="Swaziland">Swaziland</option>
    <option value="Sweden">Sweden</option>
    <option value="Switzerland">Switzerland</option>
    <option value="Syrian Arab Republic">Syrian Arab Republic</option>
    <option value="Taiwan, Province of China">Taiwan, Province of China</option>
    <option value="Tajikistan">Tajikistan</option>
    <option value="Tanzania, United Republic of">Tanzania, United Republic of</option>
    <option value="Thailand">Thailand</option>
    <option value="Timor-Leste">Timor-Leste</option>
    <option value="Togo">Togo</option>
    <option value="Tokelau">Tokelau</option>
    <option value="Tonga">Tonga</option>
    <option value="Trinidad and Tobago">Trinidad and Tobago</option>
    <option value="Tunisia">Tunisia</option>
    <option value="Turkey">Turkey</option>
    <option value="Turkmenistan">Turkmenistan</option>
    <option value="Turks and Caicos Islands">Turks and Caicos Islands</option>
    <option value="Tuvalu">Tuvalu</option>
    <option value="Uganda">Uganda</option>
    <option value="Ukraine">Ukraine</option>
    <option value="United Arab Emirates">United Arab Emirates</option>
    <option value="United Kingdom">United Kingdom</option>
    <option value="United States">United States</option>
    <option value="United States Minor Outlying Islands">United States Minor Outlying Islands</option>
    <option value="Uruguay">Uruguay</option>
    <option value="Uzbekistan">Uzbekistan</option>
    <option value="Vanuatu">Vanuatu</option>
    <option value="Venezuela">Venezuela</option>
    <option value="Viet Nam">Viet Nam</option>
    <option value="Virgin Islands, British">Virgin Islands, British</option>
    <option value="Virgin Islands, U.s.">Virgin Islands, U.s.</option>
    <option value="Wallis and Futuna">Wallis and Futuna</option>
    <option value="Western Sahara">Western Sahara</option>
    <option value="Yemen">Yemen</option>
    <option value="Zambia">Zambia</option>
    <option value="Zimbabwe">Zimbabwe</option>
                      </select>
                      <label for="field_7">Country</label>
                    </div>
                    <input id="country-destination" name="field_7" type="hidden">
                    <input id="tz-country" name="field_8" type="hidden">
                    
                    <input
                      name="field_6"
                      type="hidden"
                      value="Machine Learning"
                    >
                    
                    <div class="emailoctopus-form-row-consent">
                      <input
                        type="checkbox"
                        id="consent"
                        name="consent"
                      >
                      <label for="consent">
                        I consent to the following terms:
                      </label>
                      <a href="https://www.conf42.com/terms-and-conditions.pdf" target="_blank">
                        Terms and Conditions
                      </a>
                      &amp;
                      <a href="./code-of-conduct" target="_blank">
                        Code of Conduct
                      </a>
                    </div>
                    <div
                      aria-hidden="true"
                      class="emailoctopus-form-row-hp"
                    >
                      <input
                        type="text"
                        name="hpc4b27b6e-eb38-11e9-be00-06b4694bee2a"
                        tabindex="-1"
                        autocomplete="nope"
                      >
                    </div>
                    <div class="mt-6 emailoctopus-form-row-subscribe">
                      <input
                        type="hidden"
                        name="successRedirectUrl"
                      >
                      <button class="btn w-100 btn-success lift" type="submit" onclick="gtag_report_conversion(); rdt('track', 'SignUp');">
                        Subscribe
                      </button>
                    </div>
                  </form>
  
                </div>
  
              </div>
  
            </div>
  
          </div> <!-- / .row -->
        </div> <!-- / .container -->
      </section>

      <!-- <script src="https://emailoctopus.com/bundles/emailoctopuslist/js/1.6/form-recaptcha.js"></script> -->
      <script src="https://emailoctopus.com/bundles/emailoctopuslist/js/1.6/form-embed.js"></script>

    <!-- SHAPE -->
    <div class="position-relative">
      <div class="shape shape-bottom shape-fluid-x svg-shim text-dark">
        <svg viewBox="0 0 2880 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 48h2880V0h-720C1442.5 52 720 0 720 0H0v48z" fill="currentColor"/></svg>      </div>
    </div>

    <!-- FOOTER -->
    <footer class="py-8 py-md-11 bg-dark">
      <div class="container">
        <div class="row">

          <div class="col-12 col-md-4 col-lg-3">
            <!-- Brand -->
            <img src="./assets/conf42/conf42_logo_white_small.png" alt="..." class="footer-brand img-fluid mb-2">
    
            <!-- Text -->
            <p class="text-gray-700 mb-2">
              Online tech events
            </p>
    
            <!-- Social -->
            <ul class="list-unstyled list-inline list-social mb-5">
              <li class="list-inline-item list-social-item me-3">
                <a href="https://www.linkedin.com/company/49110720/" class="text-decoration-none">
                  <img src="./assets/img/icons/social/linkedin.svg" class="list-social-icon" alt="...">
                </a>
              </li>
              <li class="list-inline-item list-social-item me-3">
                <a href="https://twitter.com/conf42com" class="text-decoration-none">
                  <img src="./assets/img/icons/social/twitter.svg" class="list-social-icon" alt="...">
                </a>
              </li>
            </ul>

            <!-- QR Code -->
            <img src="./assets/conf42/CONF42.QR.png" style="width: 100px;" class="mb-5 img-fluid" />
          </div>


          <div class="col-12 col-md-4 col-lg-3">
          
            <!-- Heading -->
            <h6 class="fw-bold text-uppercase text-gray-700">
              Events 2025
            </h6>
            <!-- List -->
            <ul class="list-unstyled text-muted mb-6 mb-md-8 mb-lg-0">
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/devops2025">
                  DevOps 2025
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/ce2025">
                  Chaos Engineering 2025
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/python2025">
                  Python 2025
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/cloud2025">
                  Cloud Native 2025
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/llms2025">
                  Large Language Models (LLMs) 2025
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/golang2025">
                  Golang 2025
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/sre2025">
                  Site Reliability Engineering (SRE) 2025
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/ml2025">
                  Machine Learning 2025
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/obs2025">
                  Observability 2025
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/quantum2025">
                  Quantum Computing 2025
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/rustlang2025">
                  Rustlang 2025
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/platform2025">
                  Platform Engineering 2025
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/mlops2025">
                  MLOps 2025
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/im2025">
                  Incident Management 2025
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/kubenative2025">
                  Kube Native 2025
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/js2024">
                  JavaScript 2025
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/prompt2025">
                  Prompt Engineering 2025
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/robotics2025">
                  Robotics 2025
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/devsecops2025">
                  DevSecOps 2025
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/iot2025">
                  Internet of Things (IoT) 2025
                </a>
              </li>
            
            </ul>
          
            <!-- Heading -->
            <h6 class="fw-bold text-uppercase text-gray-700">
              Events 2024
            </h6>
            <!-- List -->
            <ul class="list-unstyled text-muted mb-6 mb-md-8 mb-lg-0">
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/devops2024">
                  DevOps 2024
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/ce2024">
                  Chaos Engineering 2024
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/python2024">
                  Python 2024
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/cloud2024">
                  Cloud Native 2024
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/llms2024">
                  Large Language Models (LLMs) 2024
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/golang2024">
                  Golang 2024
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/sre2024">
                  Site Reliability Engineering (SRE) 2024
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/ml2024">
                  Machine Learning 2024
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/obs2024">
                  Observability 2024
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/quantum2024">
                  Quantum Computing 2024
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/rustlang2024">
                  Rustlang 2024
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/platform2024">
                  Platform Engineering 2024
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/kubenative2024">
                  Kube Native 2024
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/im2024">
                  Incident Management 2024
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/js2024">
                  JavaScript 2024
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/prompt2024">
                  Prompt Engineering 2024
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://sreday.com/2024-amsterdam/">
                  SREday Amsterdam 2024
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/devsecops2024">
                  DevSecOps 2024
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/iot2024">
                  Internet of Things (IoT) 2024
                </a>
              </li>
            
            </ul>
          
            <!-- Heading -->
            <h6 class="fw-bold text-uppercase text-gray-700">
              Events 2023
            </h6>
            <!-- List -->
            <ul class="list-unstyled text-muted mb-6 mb-md-8 mb-lg-0">
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/devops2023">
                  DevOps 2023
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/ce2023">
                  Chaos Engineering 2023
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/python2023">
                  Python 2023
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/cloud2023">
                  Cloud Native 2023
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/golang2023">
                  Golang 2023
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/sre2023">
                  Site Reliability Engineering 2023
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/ml2023">
                  Machine Learning 2023
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/obs2023">
                  Observability 2023
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/quantum2023">
                  Quantum Computing 2023
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/rustlang2023">
                  Rustlang 2023
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/platform2023">
                  Platform Engineering 2023
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/kubenative2023">
                  Kube Native 2023
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/im2023">
                  Incident Management 2023
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/js2023">
                  JavaScript 2023
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/devsecops2023">
                  DevSecOps 2023
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/iot2023">
                  Internet of Things (IoT) 2023
                </a>
              </li>
            
            </ul>
          
            <!-- Heading -->
            <h6 class="fw-bold text-uppercase text-gray-700">
              Events 2022
            </h6>
            <!-- List -->
            <ul class="list-unstyled text-muted mb-6 mb-md-8 mb-lg-0">
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/python2022">
                  Python 2022
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/mobile2022">
                  Mobile 2022
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/ce2022">
                  Chaos Engineering 2022
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/golang2022">
                  Golang 2022
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/cloud2022">
                  Cloud Native 2022
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/ml2022">
                  Machine Learning 2022
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/sre2022">
                  Site Reliability Engineering 2022
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/quantum2022">
                  Quantum Computing 2022
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/rustlang2022">
                  Rustlang 2022
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/im2022">
                  Incident Management 2022
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/kubenative2022">
                  Kube Native 2022
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/js2022">
                  JavaScript 2022
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/devsecops2022">
                  DevSecOps 2022
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/web2022">
                  Web 3.0 2022
                </a>
              </li>
            
            </ul>
          
            <!-- Heading -->
            <h6 class="fw-bold text-uppercase text-gray-700">
              Events 2021
            </h6>
            <!-- List -->
            <ul class="list-unstyled text-muted mb-6 mb-md-8 mb-lg-0">
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/ce2021">
                  Chaos Engineering 2021
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/enterprise2021">
                  Enterprise Software 2021
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/cloud2021">
                  Cloud Native 2021
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/python2021">
                  Python 2021
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/golang2021">
                  Golang 2021
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/ml2021">
                  Machine Learning 2021
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/sre2021">
                  Site Reliability Engineering 2021
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/js2021">
                  JavaScript 2021
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/devsecops2021">
                  DevSecOps 2021
                </a>
              </li>
            
            </ul>
          
            <!-- Heading -->
            <h6 class="fw-bold text-uppercase text-gray-700">
              Events 2020
            </h6>
            <!-- List -->
            <ul class="list-unstyled text-muted mb-6 mb-md-8 mb-lg-0">
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/ce2020">
                  Chaos Engineering 2020
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/oss2020">
                  Open Source Showcase 2020
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/sre2020">
                  Site Reliability Engineering 2020
                </a>
              </li>
            
              <li class="mb-3">
                <a class="text-reset" href="https://www.conf42.com/js2020">
                  JavaScript 2020
                </a>
              </li>
            
            </ul>
          
          </div>

          
          <div class="col-12 col-md-4 offset-md-4 col-lg-3 offset-lg-0">

            <!-- Heading -->
            <h6 class="fw-bold text-uppercase text-gray-700">
              Community
            </h6>
            <!-- List -->
            <ul class="list-unstyled text-muted mb-0">
              <li class="mb-3">
                <a href="./support" class="text-reset">
                  Support us
                </a>
              </li>
              <li class="mb-3">
                <a href="./speakers" class="text-reset">
                  Speakers
                </a>
              </li>
              <li class="mb-3">
                <a href="./hall-of-fame" class="text-reset">
                  Hall of fame
                </a>
              </li>
              <li class="mb-3">
                <a href="https://discord.gg/DnyHgrC7jC" class="text-reset" target="_blank">
                  Discord
                </a>
              </li>
              <li class="mb-3">
                <a href="./about" class="text-reset">
                  About the team
                </a>
              </li>
            </ul>

            <!-- Heading -->
            <h6 class="fw-bold text-uppercase text-gray-700">
              Sponsors
            </h6>
            <!-- List -->
            <ul class="list-unstyled text-muted mb-0">
              <li class="mb-3">
                <a href="./sponsor" class="text-reset" target="_blank">
                  Sponsorship
                </a>
              </li>
              <li class="mb-3">
                <a href="mailto:mark@conf42.com?subject=We would like to sponsor" class="text-reset" target="_blank">
                  Request the Prospectus
                </a>
              </li>
              <li class="mb-3">
                <a href="https://drive.google.com/drive/folders/1tT2lspLQgj3sdfxG9FwDVkBUt-TYSPGe?usp=sharing" class="text-reset" target="_blank">
                  Media kit
                </a>
              </li>
            </ul>
    
          </div>


          <div class="col-12 col-md-4 col-lg-3">
    
            <!-- Heading -->
            <h6 class="fw-bold text-uppercase text-gray-700">
              Legal
            </h6>
    
            <!-- List -->
            <ul class="list-unstyled text-muted mb-0">
              <li class="mb-3">
                <a href="./code-of-conduct" class="text-reset">
                  Code of Conduct
                </a>
              </li>
              <li class="mb-3">
                <a href="https://www.conf42.com/terms-and-conditions.pdf" class="text-reset" target="_blank">
                  Terms and Conditions
                </a>
              </li>
              <li class="mb-3">
                <a href="https://www.conf42.com/privacy-policy.pdf" class="text-reset" target="_blank">
                  Privacy policy
                </a>
              </li>
            </ul>
          </div>


        </div> <!-- / .row -->
      </div> <!-- / .container -->
    </footer>

    <!-- JAVASCRIPT -->
    <!-- Map JS -->
    <script src='https://api.mapbox.com/mapbox-gl-js/v0.53.0/mapbox-gl.js'></script>
    
    <!-- Vendor JS -->
    <script src="./assets/js/vendor.bundle.js"></script>
    
    <!-- Theme JS -->
    <script src="./assets/js/theme.bundle.js"></script>

    <!-- Various JS -->
    <script src="./assets/js/various.js"></script>

    <script src='https://cdn.jsdelivr.net/npm/@widgetbot/crate@3' async defer>
      new Crate({
          notifications: true,
          indicator: true,
          server: '814240231606714368', // Conf42.com
          channel: '814240231788249115' // #community
      })
    </script>
  </body>
</html>