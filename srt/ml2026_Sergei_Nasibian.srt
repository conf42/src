1
00:00:00,500 --> 00:00:01,460
Speaker 27: Hello everyone.

2
00:00:01,460 --> 00:00:05,410
Today we will be talking about
system level experimentation.

3
00:00:06,280 --> 00:00:13,300
I will be mainly discussing pricing
in food tech, but basically we will be

4
00:00:13,940 --> 00:00:20,360
looking at some general ideas that can
be applied in many different areas of

5
00:00:20,360 --> 00:00:22,564
food tech or in many different other.

6
00:00:23,514 --> 00:00:25,224
Business applications as well.

7
00:00:25,724 --> 00:00:33,284
So let's start first of all let's discuss
what is the task that we're trying to

8
00:00:33,284 --> 00:00:43,089
solve and what is the actually goal
that is tried to achieve by pricing.

9
00:00:43,449 --> 00:00:47,789
In food tech and what
does pricing mean at all?

10
00:00:48,269 --> 00:00:51,069
So here we are talking
about delivery pricing.

11
00:00:51,759 --> 00:00:57,439
That's the amount that users pay for
their orders to be delivered from

12
00:00:57,439 --> 00:00:59,889
restaurant by couriers on some platform.

13
00:00:59,889 --> 00:01:02,734
You probably know some platform,
you probably used some of them.

14
00:01:03,234 --> 00:01:09,709
And, what are the goals that are
usually aimed at by different

15
00:01:09,719 --> 00:01:13,999
pricing methodologies by
different optimization algorithms.

16
00:01:14,779 --> 00:01:17,149
There are two, two types of goals.

17
00:01:17,149 --> 00:01:22,079
They can be broadly split into
two different groups, like

18
00:01:22,079 --> 00:01:24,089
short term and long term end.

19
00:01:24,674 --> 00:01:30,014
Short term goals usually involve
total revenue optimization, which is

20
00:01:30,014 --> 00:01:32,574
more or less local problem to solve.

21
00:01:33,144 --> 00:01:40,744
While long term goals usually involve
such things as users', lifetime value

22
00:01:40,804 --> 00:01:44,354
optimization and these are a bit complex.

23
00:01:45,269 --> 00:01:51,479
In terms of modeling and in terms of
the way how this thing that is called

24
00:01:51,509 --> 00:01:54,569
LTV or lifetime value can be estimated.

25
00:01:54,619 --> 00:01:59,339
Thus it is a bit more
complex to optimized as well.

26
00:01:59,389 --> 00:02:00,739
And it's a bit different area.

27
00:02:01,239 --> 00:02:05,959
Usually it involves some more
like strategic decisions or

28
00:02:05,959 --> 00:02:07,489
business development teams.

29
00:02:07,849 --> 00:02:15,169
So today we'll be talking about mainly
the problem of short term revenue

30
00:02:15,169 --> 00:02:21,179
optimization and what are the trade offs
that we have, so basically they are.

31
00:02:22,104 --> 00:02:28,414
Again, if we consider only short
term revenue, they are quite trivial.

32
00:02:28,414 --> 00:02:35,004
So if you increase delivery fee
too much, so if you charge too

33
00:02:35,004 --> 00:02:40,864
much from users for delivery then
you have revenue growth per order.

34
00:02:41,254 --> 00:02:43,494
But the number of orders declines.

35
00:02:43,994 --> 00:02:46,494
Because because yeah it's obvious.

36
00:02:46,794 --> 00:02:51,564
So if you, if your delivery fee decreases,
you have the opposite effect, which

37
00:02:51,564 --> 00:02:56,594
means that basically if you imagine
that your delivery fee is too low or

38
00:02:56,594 --> 00:02:59,884
too high, then you have non-optimal.

39
00:03:00,719 --> 00:03:06,759
Settings that lead to negative
impact on your revenues, meaning that

40
00:03:06,759 --> 00:03:12,619
somewhere in between there is sweet
spot where your revenue is optimal.

41
00:03:13,499 --> 00:03:18,259
Meaning that it's the maximum that
it can be for the given environment.

42
00:03:18,759 --> 00:03:22,939
This is the trade off that
we will be mainly discussing.

43
00:03:23,629 --> 00:03:32,159
And one of the core concepts that
usually are looked at in that context

44
00:03:32,219 --> 00:03:38,479
is elasticity, demand elasticity
which describes how much your.

45
00:03:39,019 --> 00:03:45,659
Number of orders or con conversion from
from a user opening a session, a new

46
00:03:45,659 --> 00:03:53,109
session into a user making an order
changes if you change your delivery fee.

47
00:03:53,609 --> 00:04:00,839
So that relationship is as I already
mentioned, obviously, monotonically

48
00:04:00,839 --> 00:04:07,019
decreasing, which which means that
the higher delivery fee you have the

49
00:04:07,049 --> 00:04:11,729
lower is the number of orders that
are going to be made on your platform.

50
00:04:12,229 --> 00:04:18,804
But locally, if you consider only small
changes, it can be usually approximated

51
00:04:18,804 --> 00:04:21,999
quite well with, some linear function.

52
00:04:22,499 --> 00:04:28,030
And yeah, obviously for large for
large changes in delivery fee, that

53
00:04:28,030 --> 00:04:29,799
probably doesn't work very well.

54
00:04:30,349 --> 00:04:35,729
And you will have probably some
non-linear, some convex dependency.

55
00:04:35,729 --> 00:04:40,309
But for very small changes,
you can basically have.

56
00:04:40,809 --> 00:04:44,409
Assume that what you are, what
you really need is just a single

57
00:04:44,409 --> 00:04:50,569
number that describes the first
derivative of that dependency of your

58
00:04:50,619 --> 00:04:54,499
demand on the average delivery fee.

59
00:04:55,309 --> 00:04:57,830
So how can that be estimated?

60
00:04:57,830 --> 00:05:01,229
There are two main ways that
we will be discussing now.

61
00:05:02,010 --> 00:05:03,819
One is AB testing.

62
00:05:03,819 --> 00:05:05,679
The other is switchback testing.

63
00:05:06,179 --> 00:05:13,640
And there are some other ways some
parametric ways to, to estimate that, the

64
00:05:13,640 --> 00:05:19,750
dependency, using some assumptions about
the model that describes your demand.

65
00:05:20,710 --> 00:05:23,320
But today we will be just discussing.

66
00:05:23,950 --> 00:05:26,680
Experiments way of doing this.

67
00:05:27,180 --> 00:05:31,140
So what are the tests that
that I just mentioned, and

68
00:05:31,140 --> 00:05:32,460
what is the main difference?

69
00:05:32,879 --> 00:05:35,120
What is ab versus switchback?

70
00:05:35,130 --> 00:05:40,470
AB is a very simple setup based
on simple user randomization.

71
00:05:41,470 --> 00:05:42,730
You basically.

72
00:05:43,250 --> 00:05:47,000
Split all users that you have
into two groups for one group.

73
00:05:47,000 --> 00:05:50,715
You say that you don't change
anything for other group.

74
00:05:50,715 --> 00:05:55,295
You increase your average
delivery fee in some way.

75
00:05:55,385 --> 00:06:00,665
Actually, that's very important
question how you change your delivery

76
00:06:00,665 --> 00:06:03,565
fee because that also obviously.

77
00:06:04,150 --> 00:06:09,300
Affects the orders and
user behavior in general.

78
00:06:09,780 --> 00:06:15,640
But for now, let's assume that you have
some change of delivery fee in average.

79
00:06:15,850 --> 00:06:20,310
And for simplicity, you just
increase all order all orders

80
00:06:20,410 --> 00:06:23,905
delivery price by the same amount,
which is equal to that average.

81
00:06:24,405 --> 00:06:32,535
What is the main disadvantage of AB
testing in that setup is that users

82
00:06:32,565 --> 00:06:35,365
are in reality, not independent.

83
00:06:35,845 --> 00:06:42,725
So AB tests, pricing, AB tests
can work well if if users are,

84
00:06:42,780 --> 00:06:47,040
independent from each other, meaning
that decisions of one users do not

85
00:06:47,040 --> 00:06:49,410
affect the system for the other users.

86
00:06:49,830 --> 00:06:55,170
But this is not the case because the
food tech is actually a quite complex

87
00:06:55,170 --> 00:07:00,865
three side marketplace, which has also
restaurants which also has couriers.

88
00:07:01,365 --> 00:07:05,965
And quite often the main
bottleneck is the supply side.

89
00:07:06,485 --> 00:07:09,115
Not not the demand for
the growth of business.

90
00:07:09,165 --> 00:07:14,945
And if you increase for some group
of users price, then obviously that

91
00:07:14,945 --> 00:07:18,844
leads to less orders from that group.

92
00:07:18,995 --> 00:07:24,285
Meaning that you have additional courier
capacity, excess courier capacity.

93
00:07:24,880 --> 00:07:31,490
That is freed because of that
change for half of your users, which

94
00:07:31,490 --> 00:07:37,520
means that it's actually easier
to find the co for other users.

95
00:07:38,000 --> 00:07:43,310
And that means that you
actually unintentionally

96
00:07:43,310 --> 00:07:45,690
improve experience for them.

97
00:07:45,690 --> 00:07:50,905
You unintentionally, actually depends
on your pricing algorithm, but maybe

98
00:07:50,905 --> 00:07:56,595
you even additionally decrease the
price for them based on the fact that

99
00:07:56,605 --> 00:08:01,795
you take into account, for example,
how far the nearest courier is from the

100
00:08:02,005 --> 00:08:06,285
restaurant from which a user is trying
to order which is not what we want.

101
00:08:06,285 --> 00:08:10,955
We want a fair experiment, which
doesn't, take into account any additional

102
00:08:10,955 --> 00:08:17,755
effects that really estimates the
impact only of the price change and

103
00:08:17,755 --> 00:08:20,475
not anything else that comes together.

104
00:08:21,435 --> 00:08:26,915
And for that case on the right
hand side of that slide in foot

105
00:08:27,005 --> 00:08:29,135
Tech switchback experiments are.

106
00:08:29,820 --> 00:08:31,200
Quite quite common.

107
00:08:32,130 --> 00:08:34,760
So what is a switchback experiment?

108
00:08:35,460 --> 00:08:41,010
Instead of splitting all users
into two groups you basically split

109
00:08:41,010 --> 00:08:44,280
your timeline of the experiment.

110
00:08:45,210 --> 00:08:52,170
You use two pricing algorithms alternately
and within each period of time.

111
00:08:52,670 --> 00:08:57,600
You price all orders
using the same algorithms.

112
00:08:57,600 --> 00:09:03,760
So either you increase price for all
orders or you don't don't do anything.

113
00:09:03,860 --> 00:09:09,830
So in this example, I basically try
to highlight how that can look like.

114
00:09:09,880 --> 00:09:12,820
You can split you, let's
say that your experiment.

115
00:09:13,320 --> 00:09:20,720
Lasts for two days and you split your
48 hours of the experiment into 12

116
00:09:20,750 --> 00:09:24,560
blocks each one four hours length.

117
00:09:25,060 --> 00:09:30,860
And within each of them you basically
have either one or another setting.

118
00:09:31,360 --> 00:09:35,070
What is the main question here
is obviously how to choose

119
00:09:35,130 --> 00:09:37,510
a window size appropriately.

120
00:09:37,570 --> 00:09:44,605
And here is the trade off between either
two noisy results or the opposite.

121
00:09:45,205 --> 00:09:45,985
Some.

122
00:09:46,525 --> 00:09:53,945
Effects that are obtained only because
of some like local seasonality within

123
00:09:53,945 --> 00:09:57,155
that overall experiment time span.

124
00:09:57,965 --> 00:10:07,235
So if that window size is too large
then you basically may end up with the.

125
00:10:07,945 --> 00:10:11,125
Unreliable results that are
not related to your change.

126
00:10:11,155 --> 00:10:17,025
If it is too small, then basically you
just will have too unstable and results

127
00:10:17,025 --> 00:10:21,645
that are not related again, to your change
because your system didn't really react.

128
00:10:22,145 --> 00:10:24,630
So how to solve actually
the first problem.

129
00:10:25,130 --> 00:10:26,390
Sometimes what is done is.

130
00:10:27,350 --> 00:10:33,380
To avoid that like local seasonality
within within a day, which is like

131
00:10:33,380 --> 00:10:40,030
for example due to lunchtime or
something else you can flip the mode

132
00:10:40,680 --> 00:10:47,020
for example during night when you have
an overall very low number of orders.

133
00:10:47,520 --> 00:10:54,740
You can basically in that way switch
the order in which algorithms are

134
00:10:54,920 --> 00:10:57,200
applied between one day and another.

135
00:10:57,700 --> 00:11:01,300
And it is usually recommended to
conduct switch back, ex switch back

136
00:11:01,300 --> 00:11:07,900
experiments for at least two weeks
so that each day can happen under.

137
00:11:08,695 --> 00:11:13,245
Each day of week, can happen
under both modes with like

138
00:11:13,245 --> 00:11:15,715
flipping somewhere in between.

139
00:11:16,215 --> 00:11:23,975
How to evaluate results of a test, of an
AB test that is a like simple statistical

140
00:11:23,975 --> 00:11:26,165
problem that ha has been solved.

141
00:11:26,925 --> 00:11:31,595
A lot of times with many different
classical, statistical tests.

142
00:11:32,135 --> 00:11:38,125
So you basically assume that under the new
hypothesis that there is no difference.

143
00:11:38,125 --> 00:11:43,435
Then you build some statistic, then
you say, okay, is my new, if my new

144
00:11:43,825 --> 00:11:48,775
hypothesis is true, then my statistics
should have some given distribution.

145
00:11:48,775 --> 00:11:49,985
And if the.

146
00:11:50,690 --> 00:11:59,230
Sample value that is computed based on my
actual experiment results is too large.

147
00:11:59,890 --> 00:12:07,050
Then probably my new hypothesis is not
true, meaning that I have some non-trivial

148
00:12:07,050 --> 00:12:10,000
impact from the change that I did.

149
00:12:10,500 --> 00:12:13,250
And some some examples are on the site.

150
00:12:13,250 --> 00:12:18,690
So some examples are to sample t-test
improve a little improvement over

151
00:12:18,690 --> 00:12:26,660
it that allows to avoid assumption
about variance equality between two

152
00:12:26,660 --> 00:12:29,000
different groups is a Welch test.

153
00:12:29,915 --> 00:12:35,045
Also there is one weakness test,
permutation test, but they all

154
00:12:35,045 --> 00:12:38,165
are doing approximately the same
thing that I just described.

155
00:12:38,665 --> 00:12:43,385
And each one of them can be
applied to many different

156
00:12:43,925 --> 00:12:45,585
characteristics of orders.

157
00:12:46,365 --> 00:12:48,200
For example you can.

158
00:12:48,700 --> 00:12:53,620
Test how the average order
size changes, how the revenues

159
00:12:53,620 --> 00:12:55,630
or profits per order change.

160
00:12:56,130 --> 00:13:02,890
You can test how the conversion
of users into order changes the

161
00:13:02,890 --> 00:13:07,890
probability of a session to end up with
an order and and many other things.

162
00:13:08,340 --> 00:13:10,950
And overall that will allow you to.

163
00:13:11,450 --> 00:13:17,090
Have an understanding of how
the total revenue will change

164
00:13:17,150 --> 00:13:19,010
if you roll out your change.

165
00:13:19,010 --> 00:13:24,550
You roll out your price increase
or decrease or any other maybe

166
00:13:24,550 --> 00:13:29,490
less trivial change of the pricing
algorithm for the whole user base.

167
00:13:29,990 --> 00:13:38,080
So with switchback tests, it's a bit
more complex and results evaluation is

168
00:13:38,120 --> 00:13:43,860
a problem that is known as the change
point problem in time series analysis.

169
00:13:44,360 --> 00:13:47,900
So basically you need to.

170
00:13:48,400 --> 00:13:55,960
Find to identify the times when the
distribution of of the orders or sessions

171
00:13:56,020 --> 00:14:03,620
or any other objects that you link to
the final order that is being made.

172
00:14:04,220 --> 00:14:08,580
Change in time and to to make a step back.

173
00:14:09,030 --> 00:14:16,260
So in, in general switchback testing
allows you to pick up more than just the

174
00:14:16,260 --> 00:14:20,170
change in averages compared to AB tests.

175
00:14:20,800 --> 00:14:26,760
It allows you to, discover changes
in variance and changes in frequency

176
00:14:26,760 --> 00:14:29,130
of the stochastic process as well.

177
00:14:29,800 --> 00:14:35,530
Which is a better description of
the behavior that you may found

178
00:14:35,530 --> 00:14:38,360
also, you may find also important.

179
00:14:38,930 --> 00:14:44,200
And in that concrete case I have here a
small comment that even though we know

180
00:14:44,420 --> 00:14:46,400
when the change is assumed to happen.

181
00:14:46,900 --> 00:14:51,040
Because we know what are the windows
that we use in the switchback experiment.

182
00:14:51,910 --> 00:14:56,250
First of all we don't know whether
that experiment is affecting the

183
00:14:56,250 --> 00:14:58,530
metrics that, that we're interested in.

184
00:14:59,170 --> 00:15:03,100
We don't know the size of the jump
it, if it will be statistically

185
00:15:03,100 --> 00:15:08,020
significant, and we will discuss
how to estimate the threshold.

186
00:15:08,830 --> 00:15:12,790
Which to consider to be
like the lower bound of a

187
00:15:12,790 --> 00:15:14,590
statistically significant change.

188
00:15:15,090 --> 00:15:19,125
And yeah, that's that's
basically the common framework

189
00:15:19,125 --> 00:15:22,045
of of the change point problem.

190
00:15:22,545 --> 00:15:27,075
So how to solve it switch
back, tests usually.

191
00:15:27,075 --> 00:15:31,100
And the, the common approach to solving
them the change point problem in

192
00:15:31,100 --> 00:15:35,340
switchback tests is based basically
on maintaining some window of

193
00:15:35,370 --> 00:15:38,955
observations to compute some average.

194
00:15:39,455 --> 00:15:42,120
And this average can be
either computed as a simple.

195
00:15:42,870 --> 00:15:47,430
Moving average, meaning that
it's like just the simple regular

196
00:15:47,430 --> 00:15:51,270
arithmetic average of the observations
within the sliding window.

197
00:15:52,050 --> 00:15:55,670
Or you can also incorporate some
model like exponentially weighted

198
00:15:56,030 --> 00:16:02,080
moving average or garch model to
also con compute that mean value.

199
00:16:02,580 --> 00:16:05,060
And yeah, that's that's the approach.

200
00:16:05,150 --> 00:16:10,160
So basically the main question, as I
already mentioned, is how to choose

201
00:16:10,160 --> 00:16:18,350
that threshold for the decision about a
change point being discovered to be made.

202
00:16:18,770 --> 00:16:23,100
And that threshold can be computed
with the following algorithm.

203
00:16:23,670 --> 00:16:28,810
So you just choose some, recent
period of stable regime, meaning

204
00:16:28,810 --> 00:16:32,080
that this is a period when you
did not make any interventions.

205
00:16:32,080 --> 00:16:34,430
You did not change pricing.

206
00:16:34,760 --> 00:16:36,200
You split it into windows.

207
00:16:36,200 --> 00:16:40,040
It is recommended to split it
into windows of the same size.

208
00:16:40,860 --> 00:16:43,150
You compute average per each window.

209
00:16:43,660 --> 00:16:46,990
Also it is recommended to compute
it in the same way as you are going.

210
00:16:47,490 --> 00:16:52,080
To compute it within the sliding
window that you are going to maintain.

211
00:16:52,580 --> 00:16:56,770
And then you just compute pairwise
absolute differences between the

212
00:16:57,270 --> 00:17:03,540
windows of that stable regime period
to basically have an estimation

213
00:17:03,540 --> 00:17:09,200
of empirical distribution of those
differences if there are no interventions.

214
00:17:09,700 --> 00:17:14,600
Then the approach is to choose
a quantile of that empirical

215
00:17:14,600 --> 00:17:17,530
distribution as a threshold.

216
00:17:17,980 --> 00:17:24,090
Usually it's like either a 0.95
quantile so that it's relatively

217
00:17:24,120 --> 00:17:27,150
high to avoid some false alerts.

218
00:17:27,650 --> 00:17:34,250
And the after you chose that threshold,
basically the change points that you

219
00:17:34,250 --> 00:17:39,945
will discover based on your time series
of the incoming orders, for example.

220
00:17:40,445 --> 00:17:45,755
Can be validated by against the
experiment periods, meaning that

221
00:17:45,755 --> 00:17:51,515
you can just check whether the
regime changes that you find much.

222
00:17:51,605 --> 00:17:58,055
The moments when the experiment
was flipping the pricing

223
00:17:58,055 --> 00:17:59,135
algorithm that is used.

224
00:17:59,635 --> 00:18:04,705
And the impact estimation, if you use
that algorithm, is also quite simple

225
00:18:04,705 --> 00:18:09,835
and it's just the difference that
turned out to exceed that threshold.

226
00:18:10,335 --> 00:18:16,025
And at the same time what is important
is that you can maintain like a

227
00:18:16,025 --> 00:18:20,435
monitoring system over multiple
different characteristics of orders.

228
00:18:20,810 --> 00:18:27,640
Which can also track absence of
any negative impacts produced

229
00:18:27,640 --> 00:18:33,060
by your intervention produced
by your like experiment.

230
00:18:33,560 --> 00:18:34,520
That's that's it.

231
00:18:34,640 --> 00:18:37,070
That's basically everything
I wanted to tell.

232
00:18:37,570 --> 00:18:39,370
Just to, to sum it up.

233
00:18:39,640 --> 00:18:46,370
AB experiments do not work well in complex
systems because of interdependencies.

234
00:18:47,100 --> 00:18:50,640
A better way to conduct
them is switchback testing.

235
00:18:51,140 --> 00:18:57,840
And one of the, common views on
results estimation after you conducted

236
00:18:57,840 --> 00:19:05,990
a test is a view from the change
point statistical time series problem

237
00:19:06,080 --> 00:19:14,290
perspective, which basically allows you
to estimate the impact to validate your.

238
00:19:14,650 --> 00:19:21,080
Experiment to estimate any
unexpected negative impacts as well.

239
00:19:21,580 --> 00:19:22,515
And that's it.

240
00:19:22,515 --> 00:19:23,885
Thanks thanks everyone.

241
00:19:24,385 --> 00:19:24,505
I.

